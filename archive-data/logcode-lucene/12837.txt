GitDiffStart: f3536126babdb0b500a27ca95eb39184dae6de67 | Sun Apr 15 02:07:08 2012 +0000
diff --git a/lucene/contrib/contrib-build.xml b/lucene/contrib/contrib-build.xml
deleted file mode 100644
index 3ec494b..0000000
--- a/lucene/contrib/contrib-build.xml
+++ /dev/null
@@ -1,269 +0,0 @@
-<?xml version="1.0"?>
-
-<!--
-    Licensed to the Apache Software Foundation (ASF) under one or more
-    contributor license agreements.  See the NOTICE file distributed with
-    this work for additional information regarding copyright ownership.
-    The ASF licenses this file to You under the Apache License, Version 2.0
-    the "License"); you may not use this file except in compliance with
-    the License.  You may obtain a copy of the License at
- 
-        http://www.apache.org/licenses/LICENSE-2.0
- 
-    Unless required by applicable law or agreed to in writing, software
-    distributed under the License is distributed on an "AS IS" BASIS,
-    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-    See the License for the specific language governing permissions and
-    limitations under the License.
- -->
-
-<project name="contrib-build" xmlns:artifact="antlib:org.apache.maven.artifact.ant">
-  <echo>Building ${ant.project.name}...</echo>
-
-  <!-- TODO: adjust build.dir/dist.dir appropriately when a contrib project is run individually -->
-  <property name="build.dir" location="../../build/contrib/${ant.project.name}"/>
-  <property name="dist.dir" location="../../dist/contrib/${ant.project.name}"/>
-  <property name="maven.dist.dir" location="../../dist/maven"/>
-
-  <import file="../common-build.xml"/>
-
-  <available property="contrib.has.tests" type="dir" file="src/test" />
-  
-  <!-- if you extend the classpath refid in one contrib's build.xml (add JARs), use this as basis: -->
-  <path id="base.classpath">
-   <pathelement location="${common.dir}/build/core/classes/java"/>
-   <pathelement path="${project.classpath}"/>
-  </path>
-  
-  <!-- default classpath refid, can be overridden by contrib's build.xml (use the above base.classpath as basis): -->
-  <path id="classpath" refid="base.classpath"/>
-  
-  <path id="test.base.classpath">
-    <pathelement location="${common.dir}/build/test-framework/classes/java"/>
-    <path refid="classpath"/>
-    <path refid="junit-path"/>
-    <pathelement location="${build.dir}/classes/java"/>
-  </path>
-
-  <path id="test.classpath" refid="test.base.classpath"/>
-
-  <path id="junit.classpath">
-    <path refid="test.classpath"/>
-    <pathelement location="${build.dir}/classes/test"/>
-    <pathelement path="${java.class.path}"/>
-  </path>
-
-  <target name="init" depends="common.init,compile-lucene-core"/>
-  <target name="compile-test" depends="init" if="contrib.has.tests">
-    <antcall target="common.compile-test" inheritRefs="true" />
-  </target>
-  <target name="test" depends="init" if="contrib.has.tests">
-    <antcall target="common.test" inheritRefs="true" />
-  </target>
-  <target name="build-artifacts-and-tests" depends="jar, compile-test" />
-	
-  <target name="javadocs" depends="compile-core">
-   	<sequential>
-       <mkdir dir="${javadoc.dir}/contrib-${name}"/>
-       <invoke-javadoc
-         destdir="${javadoc.dir}/contrib-${name}"
-       	title="${Name} ${version} contrib-${name} API">
-         <sources>
-           <link href=""/>
-           <packageset dir="${src.dir}"/>
-        </sources>
-      </invoke-javadoc>
-      <jarify basedir="${javadoc.dir}/contrib-${name}" destfile="${build.dir}/${final.name}-javadoc.jar"/>
-    </sequential>
-  </target>	
-
-  <target name="javadocs-index.html" description="Generate line for index.html of JavaDocs">
-    <echo file="${javadoc.dir}/index.html" append="true">
-<![CDATA[
-  <li><a href="contrib-${name}/index.html">${name}</a></li>
-]]></echo>
-  </target>
-  
-  <macrodef name="contrib-uptodate">
-    <attribute name="name"/>
-    <attribute name="property"/>
-    <attribute name="jarfile"/>
-    <attribute name="contrib-src-name" default="@{name}"/>
-    <sequential>
-      <uptodate property="@{property}" targetfile="@{jarfile}">
-        <srcfiles dir="${common.dir}/contrib/@{contrib-src-name}/src/java" includes="**/*.java"/>
-      </uptodate>
-    </sequential>
-  </macrodef>
-
-  <property name="facet.jar" value="${common.dir}/../modules/facet/build/lucene-facet-${version}.jar"/>
-  <target name="check-facet-uptodate" unless="facet.uptodate">
-    <module-uptodate name="facet" jarfile="${facet.jar}" property="facet.uptodate"/>
-  </target>
-  <target name="jar-facet" unless="facet.uptodate" depends="check-facet-uptodate">
-    <ant dir="${common.dir}/../modules/facet" target="jar-core" inheritall="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="facet.uptodate" value="true"/>
-  </target>
-
-  <property name="analyzers-icu.jar" value="${common.dir}/../modules/analysis/build/icu/lucene-analyzers-icu-${version}.jar"/>
-  <target name="check-analyzers-icu-uptodate" unless="analyzers-icu.uptodate">
-    <module-uptodate name="analysis/icu" jarfile="${analyzers-icu.jar}" property="analyzers-icu.uptodate"/>
-  </target>
-  <target name="jar-analyzers-icu" unless="analyzers-icu.uptodate" depends="check-analyzers-icu-uptodate">
-  	<ant dir="${common.dir}/../modules/analysis/icu" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="analyzers-icu.uptodate" value="true"/>
-  </target>
-
-  <property name="analyzers-phonetic.jar" value="${common.dir}/../modules/analysis/build/phonetic/lucene-analyzers-phonetic-${version}.jar"/>
-  <target name="check-analyzers-phonetic-uptodate" unless="analyzers-phonetic.uptodate">
-    <module-uptodate name="analysis/phonetic" jarfile="${analyzers-phonetic.jar}" property="analyzers-phonetic.uptodate"/>
-  </target>
-  <target name="jar-analyzers-phonetic" unless="analyzers-phonetic.uptodate" depends="check-analyzers-phonetic-uptodate">
-  	<ant dir="${common.dir}/../modules/analysis/phonetic" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-  </target>
-
-
-  <property name="analyzers-smartcn.jar" value="${common.dir}/../modules/analysis/build/smartcn/lucene-analyzers-smartcn-${version}.jar"/>
-  <target name="check-analyzers-smartcn-uptodate" unless="analyzers-smartcn.uptodate">
-    <module-uptodate name="analysis/smartcn" jarfile="${analyzers-smartcn.jar}" property="analyzers-smartcn.uptodate"/>
-  </target>
-  <target name="jar-analyzers-smartcn" unless="analyzers-smartcn.uptodate" depends="check-analyzers-smartcn-uptodate">
-  	<ant dir="${common.dir}/../modules/analysis/smartcn" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="analyzers-smartcn.uptodate" value="true"/>
-  </target>
-
-  <property name="analyzers-stempel.jar" value="${common.dir}/../modules/analysis/build/stempel/lucene-analyzers-stempel-${version}.jar"/>
-  <target name="check-analyzers-stempel-uptodate" unless="analyzers-stempel.uptodate">
-    <module-uptodate name="analysis/stempel" jarfile="${analyzers-stempel.jar}" property="analyzers-stempel.uptodate"/>
-  </target>
-  <target name="jar-analyzers-stempel" unless="analyzers-stempel.uptodate" depends="check-analyzers-stempel-uptodate">
-  	<ant dir="${common.dir}/../modules/analysis/stempel" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="analyzers-stempel.uptodate" value="true"/>
-  </target>
-
-  <property name="analyzers-kuromoji.jar" value="${common.dir}/../modules/analysis/build/kuromoji/lucene-analyzers-kuromoji-${version}.jar"/>
-  <target name="check-analyzers-kuromoji-uptodate" unless="analyzers-kuromoji.uptodate">
-    <module-uptodate name="analysis/kuromoji" jarfile="${analyzers-kuromoji.jar}" property="analyzers-kuromoji.uptodate"/>
-  </target>
-  <target name="jar-analyzers-kuromoji" unless="analyzers-kuromoji.uptodate" depends="check-analyzers-kuromoji-uptodate">
-  	<ant dir="${common.dir}/../modules/analysis/kuromoji" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="analyzers-kuromoji.uptodate" value="true"/>
-  </target>
-
-  <property name="analyzers-uima.jar" value="${common.dir}/../modules/analysis/build/uima/lucene-analyzers-uima-${version}.jar"/>
-  <target name="check-analyzers-uima-uptodate" unless="analyzers-uima.uptodate">
-    <module-uptodate name="analysis/uima" jarfile="${analyzers-uima.jar}" property="analyzers-uima.uptodate"/>
-  </target>
-  <target name="jar-analyzers-uima" unless="analyzers-uima.uptodate" depends="check-analyzers-uima-uptodate">
-    <ant dir="${common.dir}/../modules/analysis/uima" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="analyzers-uima.uptodate" value="true"/>
-  </target>
-
-  <property name="analyzers-morfologik.jar" value="${common.dir}/../modules/analysis/build/morfologik/lucene-analyzers-morfologik-${version}.jar"/>
-  <fileset id="analyzers-morfologik.fileset" dir="${common.dir}/../modules/analysis">
-    <include name="build/morfologik/lucene-analyzers-morfologik-${version}.jar" />
-    <include name="morfologik/lib/morfologik-fsa-1.5.2.jar" />
-    <include name="morfologik/lib/morfologik-polish-1.5.2.jar" />
-    <include name="morfologik/lib/morfologik-stemming-1.5.2.jar" />
-  </fileset>
-  <target name="check-analyzers-morfologik-uptodate" unless="analyzers-morfologik.uptodate">
-    <module-uptodate name="analysis/morfologik" jarfile="${analyzers-morfologik.jar}" property="analyzers-morfologik.uptodate"/>
-  </target>
-  <target name="jar-analyzers-morfologik" unless="analyzers-morfologik.uptodate" depends="check-analyzers-morfologik-uptodate">
-    <ant dir="${common.dir}/../modules/analysis/morfologik" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="analyzers-morfologik.uptodate" value="true"/>
-  </target>
-
-  <property name="grouping.jar" value="${common.dir}/../modules/grouping/build/lucene-grouping-${version}.jar"/>
-  <target name="check-grouping-uptodate" unless="grouping.uptodate">
-    <module-uptodate name="grouping" jarfile="${grouping.jar}" property="grouping.uptodate"/>
-  </target>
-  <target name="jar-grouping" unless="grouping.uptodate" depends="check-grouping-uptodate">
-  	<ant dir="${common.dir}/../modules/grouping" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="grouping.uptodate" value="true"/>
-  </target>
-
-  <property name="highlighter.jar" value="${common.dir}/build/contrib/highlighter/lucene-highlighter-${version}.jar"/>
-  <target name="check-highlighter-uptodate" unless="highlighter.uptodate">
-    <contrib-uptodate name="highlighter" jarfile="${highlighter.jar}" property="highlighter.uptodate"/>
-  </target>
-  <target name="jar-highlighter" unless="highlighter.uptodate" depends="check-highlighter-uptodate">
-    <ant dir="${common.dir}/contrib/highlighter" target="jar-core" inheritall="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="highlighter.uptodate" value="true"/>
-  </target>
-
-  <property name="memory.jar" value="${common.dir}/build/contrib/memory/lucene-memory-${version}.jar"/>
-  <target name="check-memory-uptodate" unless="memory.uptodate">
-    <contrib-uptodate name="memory" jarfile="${memory.jar}" property="memory.uptodate"/>
-  </target>
-  <target name="jar-memory" unless="memory.uptodate" depends="check-memory-uptodate">
-    <ant dir="${common.dir}/contrib/memory" target="jar-core" inheritall="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="memory.uptodate" value="true"/>
-  </target>
-
-  <property name="misc.jar" value="${common.dir}/build/contrib/misc/lucene-misc-${version}.jar"/>
-  <target name="check-misc-uptodate" unless="misc.uptodate">
-    <contrib-uptodate name="misc" jarfile="${misc.jar}" property="misc.uptodate"/>
-  </target>
-  <target name="jar-misc" unless="misc.uptodate" depends="check-misc-uptodate">
-  	<ant dir="${common.dir}/contrib/misc" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="misc.uptodate" value="true"/>
-  </target>
-
-  <property name="sandbox.jar" value="${common.dir}/build/contrib/sandbox/lucene-sandbox-${version}.jar"/>
-  <target name="check-sandbox-uptodate" unless="sandbox.uptodate">
-    <contrib-uptodate name="sandbox" jarfile="${sandbox.jar}" property="sandbox.uptodate"/>
-  </target>
-  <target name="jar-sandbox" unless="sandbox.uptodate" depends="check-sandbox-uptodate">
-  	<ant dir="${common.dir}/contrib/sandbox" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="sandbox.uptodate" value="true"/>
-  </target>
-
-  <property name="spatial.jar" value="${common.dir}/../modules/spatial/build/lucene-spatial-${version}.jar"/>
-  <target name="check-spatial-uptodate" unless="spatial.uptodate">
-    <module-uptodate name="spatial" jarfile="${spatial.jar}" property="spatial.uptodate"/>
-  </target>
-  <target name="jar-spatial" unless="spatial.uptodate" depends="check-spatial-uptodate">
-  	<ant dir="${common.dir}/../modules/spatial" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="spatial.uptodate" value="true"/>
-  </target>
-
-  <property name="suggest.jar" value="${common.dir}/../modules/suggest/build/lucene-suggest-${version}.jar"/>
-  <target name="check-suggest-uptodate" unless="suggest.uptodate">
-    <module-uptodate name="suggest" jarfile="${suggest.jar}" property="suggest.uptodate"/>
-  </target>
-  <target name="jar-suggest" unless="suggest.uptodate" depends="check-suggest-uptodate">
-  	<ant dir="${common.dir}/../modules/suggest" target="jar-core" inheritAll="false">
-      <propertyset refid="uptodate.and.compiled.properties"/>
-    </ant>
-    <property name="suggest.uptodate" value="true"/>
-  </target>
-</project>
diff --git a/lucene/contrib/demo/build.xml b/lucene/contrib/demo/build.xml
index f3625f2..cee730c 100644
--- a/lucene/contrib/demo/build.xml
+++ b/lucene/contrib/demo/build.xml
@@ -25,7 +25,7 @@
 
   <property name="demo.name" value="lucene-demos-${version}"/>
 
-  <import file="../contrib-build.xml"/>
+  <import file="../../module-build.xml"/>
 
   <target name="init" depends="contrib-build.init,jar-lucene-core"/>
   
diff --git a/lucene/contrib/highlighter/build.xml b/lucene/contrib/highlighter/build.xml
index 935d207..012d835 100644
--- a/lucene/contrib/highlighter/build.xml
+++ b/lucene/contrib/highlighter/build.xml
@@ -23,7 +23,7 @@
     Hits highlighter
   </description>
 
-  <import file="../contrib-build.xml"/>
+  <import file="../../module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${memory.jar}"/>
diff --git a/lucene/contrib/memory/build.xml b/lucene/contrib/memory/build.xml
index 3990aeb..e88e89d 100644
--- a/lucene/contrib/memory/build.xml
+++ b/lucene/contrib/memory/build.xml
@@ -23,7 +23,7 @@
     High-performance single-document index to compare against Query
   </description>
 
-  <import file="../contrib-build.xml"/>
+  <import file="../../module-build.xml"/>
 
   <path id="test.classpath">
     <pathelement path="${queryparser.jar}"/>
diff --git a/lucene/contrib/misc/build.xml b/lucene/contrib/misc/build.xml
index b2eaf71..46bb8c4 100644
--- a/lucene/contrib/misc/build.xml
+++ b/lucene/contrib/misc/build.xml
@@ -25,7 +25,7 @@
     Miscellaneous Lucene extensions
   </description>
 
-  <import file="../contrib-build.xml"/>
+  <import file="../../module-build.xml"/>
 
   <target name="install-cpptasks" unless="cpptasks.uptodate" depends="ivy-availability-check,ivy-fail">
     <property name="cpptasks.uptodate" value="true"/>
diff --git a/lucene/contrib/sandbox/build.xml b/lucene/contrib/sandbox/build.xml
index e9225c2..30e7ae1 100644
--- a/lucene/contrib/sandbox/build.xml
+++ b/lucene/contrib/sandbox/build.xml
@@ -21,7 +21,7 @@
     Sandbox for odd contrib code
   </description>
 
-  <import file="../contrib-build.xml"/>
+  <import file="../../module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="lib/jakarta-regexp-1.4.jar"/>
diff --git a/lucene/module-build.xml b/lucene/module-build.xml
new file mode 100644
index 0000000..302b678
--- /dev/null
+++ b/lucene/module-build.xml
@@ -0,0 +1,269 @@
+<?xml version="1.0"?>
+
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+ 
+        http://www.apache.org/licenses/LICENSE-2.0
+ 
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+ -->
+
+<project name="contrib-build" xmlns:artifact="antlib:org.apache.maven.artifact.ant">
+  <echo>Building ${ant.project.name}...</echo>
+
+  <!-- TODO: adjust build.dir/dist.dir appropriately when a contrib project is run individually -->
+  <property name="build.dir" location="../../build/contrib/${ant.project.name}"/>
+  <property name="dist.dir" location="../../dist/contrib/${ant.project.name}"/>
+  <property name="maven.dist.dir" location="../../dist/maven"/>
+
+  <import file="common-build.xml"/>
+
+  <available property="contrib.has.tests" type="dir" file="src/test" />
+  
+  <!-- if you extend the classpath refid in one contrib's build.xml (add JARs), use this as basis: -->
+  <path id="base.classpath">
+   <pathelement location="${common.dir}/build/core/classes/java"/>
+   <pathelement path="${project.classpath}"/>
+  </path>
+  
+  <!-- default classpath refid, can be overridden by contrib's build.xml (use the above base.classpath as basis): -->
+  <path id="classpath" refid="base.classpath"/>
+  
+  <path id="test.base.classpath">
+    <pathelement location="${common.dir}/build/test-framework/classes/java"/>
+    <path refid="classpath"/>
+    <path refid="junit-path"/>
+    <pathelement location="${build.dir}/classes/java"/>
+  </path>
+
+  <path id="test.classpath" refid="test.base.classpath"/>
+
+  <path id="junit.classpath">
+    <path refid="test.classpath"/>
+    <pathelement location="${build.dir}/classes/test"/>
+    <pathelement path="${java.class.path}"/>
+  </path>
+
+  <target name="init" depends="common.init,compile-lucene-core"/>
+  <target name="compile-test" depends="init" if="contrib.has.tests">
+    <antcall target="common.compile-test" inheritRefs="true" />
+  </target>
+  <target name="test" depends="init" if="contrib.has.tests">
+    <antcall target="common.test" inheritRefs="true" />
+  </target>
+  <target name="build-artifacts-and-tests" depends="jar, compile-test" />
+	
+  <target name="javadocs" depends="compile-core">
+   	<sequential>
+       <mkdir dir="${javadoc.dir}/contrib-${name}"/>
+       <invoke-javadoc
+         destdir="${javadoc.dir}/contrib-${name}"
+       	title="${Name} ${version} contrib-${name} API">
+         <sources>
+           <link href=""/>
+           <packageset dir="${src.dir}"/>
+        </sources>
+      </invoke-javadoc>
+      <jarify basedir="${javadoc.dir}/contrib-${name}" destfile="${build.dir}/${final.name}-javadoc.jar"/>
+    </sequential>
+  </target>	
+
+  <target name="javadocs-index.html" description="Generate line for index.html of JavaDocs">
+    <echo file="${javadoc.dir}/index.html" append="true">
+<![CDATA[
+  <li><a href="contrib-${name}/index.html">${name}</a></li>
+]]></echo>
+  </target>
+  
+  <macrodef name="contrib-uptodate">
+    <attribute name="name"/>
+    <attribute name="property"/>
+    <attribute name="jarfile"/>
+    <attribute name="contrib-src-name" default="@{name}"/>
+    <sequential>
+      <uptodate property="@{property}" targetfile="@{jarfile}">
+        <srcfiles dir="${common.dir}/contrib/@{contrib-src-name}/src/java" includes="**/*.java"/>
+      </uptodate>
+    </sequential>
+  </macrodef>
+
+  <property name="facet.jar" value="${common.dir}/../modules/facet/build/lucene-facet-${version}.jar"/>
+  <target name="check-facet-uptodate" unless="facet.uptodate">
+    <module-uptodate name="facet" jarfile="${facet.jar}" property="facet.uptodate"/>
+  </target>
+  <target name="jar-facet" unless="facet.uptodate" depends="check-facet-uptodate">
+    <ant dir="${common.dir}/../modules/facet" target="jar-core" inheritall="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="facet.uptodate" value="true"/>
+  </target>
+
+  <property name="analyzers-icu.jar" value="${common.dir}/../modules/analysis/build/icu/lucene-analyzers-icu-${version}.jar"/>
+  <target name="check-analyzers-icu-uptodate" unless="analyzers-icu.uptodate">
+    <module-uptodate name="analysis/icu" jarfile="${analyzers-icu.jar}" property="analyzers-icu.uptodate"/>
+  </target>
+  <target name="jar-analyzers-icu" unless="analyzers-icu.uptodate" depends="check-analyzers-icu-uptodate">
+  	<ant dir="${common.dir}/../modules/analysis/icu" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="analyzers-icu.uptodate" value="true"/>
+  </target>
+
+  <property name="analyzers-phonetic.jar" value="${common.dir}/../modules/analysis/build/phonetic/lucene-analyzers-phonetic-${version}.jar"/>
+  <target name="check-analyzers-phonetic-uptodate" unless="analyzers-phonetic.uptodate">
+    <module-uptodate name="analysis/phonetic" jarfile="${analyzers-phonetic.jar}" property="analyzers-phonetic.uptodate"/>
+  </target>
+  <target name="jar-analyzers-phonetic" unless="analyzers-phonetic.uptodate" depends="check-analyzers-phonetic-uptodate">
+  	<ant dir="${common.dir}/../modules/analysis/phonetic" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+  </target>
+
+
+  <property name="analyzers-smartcn.jar" value="${common.dir}/../modules/analysis/build/smartcn/lucene-analyzers-smartcn-${version}.jar"/>
+  <target name="check-analyzers-smartcn-uptodate" unless="analyzers-smartcn.uptodate">
+    <module-uptodate name="analysis/smartcn" jarfile="${analyzers-smartcn.jar}" property="analyzers-smartcn.uptodate"/>
+  </target>
+  <target name="jar-analyzers-smartcn" unless="analyzers-smartcn.uptodate" depends="check-analyzers-smartcn-uptodate">
+  	<ant dir="${common.dir}/../modules/analysis/smartcn" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="analyzers-smartcn.uptodate" value="true"/>
+  </target>
+
+  <property name="analyzers-stempel.jar" value="${common.dir}/../modules/analysis/build/stempel/lucene-analyzers-stempel-${version}.jar"/>
+  <target name="check-analyzers-stempel-uptodate" unless="analyzers-stempel.uptodate">
+    <module-uptodate name="analysis/stempel" jarfile="${analyzers-stempel.jar}" property="analyzers-stempel.uptodate"/>
+  </target>
+  <target name="jar-analyzers-stempel" unless="analyzers-stempel.uptodate" depends="check-analyzers-stempel-uptodate">
+  	<ant dir="${common.dir}/../modules/analysis/stempel" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="analyzers-stempel.uptodate" value="true"/>
+  </target>
+
+  <property name="analyzers-kuromoji.jar" value="${common.dir}/../modules/analysis/build/kuromoji/lucene-analyzers-kuromoji-${version}.jar"/>
+  <target name="check-analyzers-kuromoji-uptodate" unless="analyzers-kuromoji.uptodate">
+    <module-uptodate name="analysis/kuromoji" jarfile="${analyzers-kuromoji.jar}" property="analyzers-kuromoji.uptodate"/>
+  </target>
+  <target name="jar-analyzers-kuromoji" unless="analyzers-kuromoji.uptodate" depends="check-analyzers-kuromoji-uptodate">
+  	<ant dir="${common.dir}/../modules/analysis/kuromoji" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="analyzers-kuromoji.uptodate" value="true"/>
+  </target>
+
+  <property name="analyzers-uima.jar" value="${common.dir}/../modules/analysis/build/uima/lucene-analyzers-uima-${version}.jar"/>
+  <target name="check-analyzers-uima-uptodate" unless="analyzers-uima.uptodate">
+    <module-uptodate name="analysis/uima" jarfile="${analyzers-uima.jar}" property="analyzers-uima.uptodate"/>
+  </target>
+  <target name="jar-analyzers-uima" unless="analyzers-uima.uptodate" depends="check-analyzers-uima-uptodate">
+    <ant dir="${common.dir}/../modules/analysis/uima" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="analyzers-uima.uptodate" value="true"/>
+  </target>
+
+  <property name="analyzers-morfologik.jar" value="${common.dir}/../modules/analysis/build/morfologik/lucene-analyzers-morfologik-${version}.jar"/>
+  <fileset id="analyzers-morfologik.fileset" dir="${common.dir}/../modules/analysis">
+    <include name="build/morfologik/lucene-analyzers-morfologik-${version}.jar" />
+    <include name="morfologik/lib/morfologik-fsa-1.5.2.jar" />
+    <include name="morfologik/lib/morfologik-polish-1.5.2.jar" />
+    <include name="morfologik/lib/morfologik-stemming-1.5.2.jar" />
+  </fileset>
+  <target name="check-analyzers-morfologik-uptodate" unless="analyzers-morfologik.uptodate">
+    <module-uptodate name="analysis/morfologik" jarfile="${analyzers-morfologik.jar}" property="analyzers-morfologik.uptodate"/>
+  </target>
+  <target name="jar-analyzers-morfologik" unless="analyzers-morfologik.uptodate" depends="check-analyzers-morfologik-uptodate">
+    <ant dir="${common.dir}/../modules/analysis/morfologik" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="analyzers-morfologik.uptodate" value="true"/>
+  </target>
+
+  <property name="grouping.jar" value="${common.dir}/../modules/grouping/build/lucene-grouping-${version}.jar"/>
+  <target name="check-grouping-uptodate" unless="grouping.uptodate">
+    <module-uptodate name="grouping" jarfile="${grouping.jar}" property="grouping.uptodate"/>
+  </target>
+  <target name="jar-grouping" unless="grouping.uptodate" depends="check-grouping-uptodate">
+  	<ant dir="${common.dir}/../modules/grouping" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="grouping.uptodate" value="true"/>
+  </target>
+
+  <property name="highlighter.jar" value="${common.dir}/build/contrib/highlighter/lucene-highlighter-${version}.jar"/>
+  <target name="check-highlighter-uptodate" unless="highlighter.uptodate">
+    <contrib-uptodate name="highlighter" jarfile="${highlighter.jar}" property="highlighter.uptodate"/>
+  </target>
+  <target name="jar-highlighter" unless="highlighter.uptodate" depends="check-highlighter-uptodate">
+    <ant dir="${common.dir}/contrib/highlighter" target="jar-core" inheritall="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="highlighter.uptodate" value="true"/>
+  </target>
+
+  <property name="memory.jar" value="${common.dir}/build/contrib/memory/lucene-memory-${version}.jar"/>
+  <target name="check-memory-uptodate" unless="memory.uptodate">
+    <contrib-uptodate name="memory" jarfile="${memory.jar}" property="memory.uptodate"/>
+  </target>
+  <target name="jar-memory" unless="memory.uptodate" depends="check-memory-uptodate">
+    <ant dir="${common.dir}/contrib/memory" target="jar-core" inheritall="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="memory.uptodate" value="true"/>
+  </target>
+
+  <property name="misc.jar" value="${common.dir}/build/contrib/misc/lucene-misc-${version}.jar"/>
+  <target name="check-misc-uptodate" unless="misc.uptodate">
+    <contrib-uptodate name="misc" jarfile="${misc.jar}" property="misc.uptodate"/>
+  </target>
+  <target name="jar-misc" unless="misc.uptodate" depends="check-misc-uptodate">
+  	<ant dir="${common.dir}/contrib/misc" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="misc.uptodate" value="true"/>
+  </target>
+
+  <property name="sandbox.jar" value="${common.dir}/build/contrib/sandbox/lucene-sandbox-${version}.jar"/>
+  <target name="check-sandbox-uptodate" unless="sandbox.uptodate">
+    <contrib-uptodate name="sandbox" jarfile="${sandbox.jar}" property="sandbox.uptodate"/>
+  </target>
+  <target name="jar-sandbox" unless="sandbox.uptodate" depends="check-sandbox-uptodate">
+  	<ant dir="${common.dir}/contrib/sandbox" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="sandbox.uptodate" value="true"/>
+  </target>
+
+  <property name="spatial.jar" value="${common.dir}/../modules/spatial/build/lucene-spatial-${version}.jar"/>
+  <target name="check-spatial-uptodate" unless="spatial.uptodate">
+    <module-uptodate name="spatial" jarfile="${spatial.jar}" property="spatial.uptodate"/>
+  </target>
+  <target name="jar-spatial" unless="spatial.uptodate" depends="check-spatial-uptodate">
+  	<ant dir="${common.dir}/../modules/spatial" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="spatial.uptodate" value="true"/>
+  </target>
+
+  <property name="suggest.jar" value="${common.dir}/../modules/suggest/build/lucene-suggest-${version}.jar"/>
+  <target name="check-suggest-uptodate" unless="suggest.uptodate">
+    <module-uptodate name="suggest" jarfile="${suggest.jar}" property="suggest.uptodate"/>
+  </target>
+  <target name="jar-suggest" unless="suggest.uptodate" depends="check-suggest-uptodate">
+  	<ant dir="${common.dir}/../modules/suggest" target="jar-core" inheritAll="false">
+      <propertyset refid="uptodate.and.compiled.properties"/>
+    </ant>
+    <property name="suggest.uptodate" value="true"/>
+  </target>
+</project>
diff --git a/modules/analysis/common/build.xml b/modules/analysis/common/build.xml
index 40c1365..52745a5 100644
--- a/modules/analysis/common/build.xml
+++ b/modules/analysis/common/build.xml
@@ -29,7 +29,7 @@
   <!-- some files for testing that do not have license headers -->
   <property name="rat.excludes" value="**/*.aff,**/*.dic,**/*.txt,**/charfilter/*.htm*,**/*LuceneResourcesWikiPage.html"/>
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 	
   <target name="compile-core" depends="jflex-notice, common.compile-core"/>
 
diff --git a/modules/analysis/icu/build.xml b/modules/analysis/icu/build.xml
index e8a1c60..3628055 100644
--- a/modules/analysis/icu/build.xml
+++ b/modules/analysis/icu/build.xml
@@ -27,7 +27,7 @@
   <property name="build.dir" location="../build/icu" />
   <property name="dist.dir" location="../dist/icu" />
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 
   <path id="icujar">
      <pathelement location="lib/icu4j-4.8.1.1.jar"/>
diff --git a/modules/analysis/kuromoji/build.xml b/modules/analysis/kuromoji/build.xml
index 0e04306..3d93f74 100644
--- a/modules/analysis/kuromoji/build.xml
+++ b/modules/analysis/kuromoji/build.xml
@@ -46,7 +46,7 @@
   <!-- currently whether rat detects this as binary or not
        is platform dependent?! -->
   <property name="rat.excludes" value="**/*.txt,**/bocchan.utf-8"/>
-  <import file="../../../lucene/contrib/contrib-build.xml"/> 
+  <import file="../../../lucene/module-build.xml"/> 
 
   <available type="dir" file="${build.dir}/${ipadic.version}" property="dict.available"/>
 
diff --git a/modules/analysis/morfologik/build.xml b/modules/analysis/morfologik/build.xml
index effe083..1a663aa 100644
--- a/modules/analysis/morfologik/build.xml
+++ b/modules/analysis/morfologik/build.xml
@@ -26,7 +26,7 @@
   <property name="build.dir" location="../build/morfologik" />
   <property name="dist.dir" location="../dist/morfologik" />
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${analyzers-common.jar}"/>
diff --git a/modules/analysis/phonetic/build.xml b/modules/analysis/phonetic/build.xml
index 9de4ac0..3646646 100644
--- a/modules/analysis/phonetic/build.xml
+++ b/modules/analysis/phonetic/build.xml
@@ -26,7 +26,7 @@
   <property name="build.dir" location="../build/phonetic" />
   <property name="dist.dir" location="../dist/phonetic" />
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${analyzers-common.jar}"/>
diff --git a/modules/analysis/smartcn/build.xml b/modules/analysis/smartcn/build.xml
index ab6af4a..003787d 100644
--- a/modules/analysis/smartcn/build.xml
+++ b/modules/analysis/smartcn/build.xml
@@ -26,7 +26,7 @@
   <property name="build.dir" location="../build/smartcn" />
   <property name="dist.dir" location="../dist/smartcn" />
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${analyzers-common.jar}"/>
diff --git a/modules/analysis/stempel/build.xml b/modules/analysis/stempel/build.xml
index 7c25bac..d0af91a 100644
--- a/modules/analysis/stempel/build.xml
+++ b/modules/analysis/stempel/build.xml
@@ -26,7 +26,7 @@
   <property name="build.dir" location="../build/stempel" />
   <property name="dist.dir" location="../dist/stempel" />
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${analyzers-common.jar}"/>
diff --git a/modules/analysis/uima/build.xml b/modules/analysis/uima/build.xml
index 424c0a1..0438d6a 100644
--- a/modules/analysis/uima/build.xml
+++ b/modules/analysis/uima/build.xml
@@ -34,7 +34,7 @@
     <pathelement path="lib/WhitespaceTokenizer-2.3.1.jar"/>
   </path>
 
-  <import file="../../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${analyzers-common.jar}"/>
diff --git a/modules/benchmark/build.xml b/modules/benchmark/build.xml
index 8baa7be..924dc6f 100644
--- a/modules/benchmark/build.xml
+++ b/modules/benchmark/build.xml
@@ -27,7 +27,7 @@
     <property name="dist.dir" location="dist/" />
     <property name="maven.dist.dir" location="../dist/maven" />
 
-    <import file="../../lucene/contrib/contrib-build.xml"/>
+    <import file="../../lucene/module-build.xml"/>
     <property name="working.dir" location="work"/>
 
     <!-- the tests have some parallel problems -->
diff --git a/modules/facet/build.xml b/modules/facet/build.xml
index 947ea74..43ef499 100644
--- a/modules/facet/build.xml
+++ b/modules/facet/build.xml
@@ -30,7 +30,7 @@
   <!-- prettify.css/js -->
   <property name="rat.excludes" value="**/prettify.css,**/prettify.js"/>
   
-  <import file="../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../lucene/module-build.xml"/>
 
   <property name="examples.dir" location="src/examples"/>
 
diff --git a/modules/grouping/build.xml b/modules/grouping/build.xml
index 68c6776..534a338 100644
--- a/modules/grouping/build.xml
+++ b/modules/grouping/build.xml
@@ -27,7 +27,7 @@
     <property name="dist.dir" location="dist/" />
     <property name="maven.dist.dir" location="../dist/maven" />
 
-    <import file="../../lucene/contrib/contrib-build.xml"/>
+    <import file="../../lucene/module-build.xml"/>
     <property name="working.dir" location="work"/>
 
     <path id="test.classpath">
diff --git a/modules/join/build.xml b/modules/join/build.xml
index 78f5b8c..c5b1fcd 100644
--- a/modules/join/build.xml
+++ b/modules/join/build.xml
@@ -8,7 +8,7 @@
   <property name="dist.dir" location="dist/" />
   <property name="maven.dist.dir" location="../dist/maven" />
 
-  <import file="../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${grouping.jar}"/>
diff --git a/modules/queries/build.xml b/modules/queries/build.xml
index 5dbf50e..8bf206f 100644
--- a/modules/queries/build.xml
+++ b/modules/queries/build.xml
@@ -24,5 +24,5 @@
   <property name="dist.dir" location="dist/"/>
   <property name="maven.dist.dir" location="../dist/maven"/>
 
-  <import file="../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../lucene/module-build.xml"/>
 </project>
\ No newline at end of file
diff --git a/modules/queryparser/build.xml b/modules/queryparser/build.xml
index 181edcb..0bf3ea6 100644
--- a/modules/queryparser/build.xml
+++ b/modules/queryparser/build.xml
@@ -24,7 +24,7 @@
   <property name="dist.dir" location="dist/"/>
   <property name="maven.dist.dir" location="../dist/maven"/>
 
-  <import file="../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../lucene/module-build.xml"/>
 
   <path id="classpath">
     <pathelement path="${queries.jar}"/>
diff --git a/modules/queryparser/xmldtddocbuild.xml b/modules/queryparser/xmldtddocbuild.xml
index 60bb3df..daf2080 100644
--- a/modules/queryparser/xmldtddocbuild.xml
+++ b/modules/queryparser/xmldtddocbuild.xml
@@ -19,7 +19,7 @@
 
 <project name="DTDDocAnt" default="main">
 
-  <import file="../contrib-build.xml"/>
+	<import file="../../lucene/module-build.xml"/>
 
     <description>
     This file generates DTDdocumentation
diff --git a/modules/spatial/build.xml b/modules/spatial/build.xml
index 4220e3a..41d1f64 100644
--- a/modules/spatial/build.xml
+++ b/modules/spatial/build.xml
@@ -8,7 +8,7 @@
   <property name="dist.dir" location="dist/" />
   <property name="maven.dist.dir" location="../dist/maven" />
 
-  <import file="../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../lucene/module-build.xml"/>
 
   <path id="spatialjar">
      <pathelement path="lib/spatial4j-0.2.jar"/>
diff --git a/modules/suggest/build.xml b/modules/suggest/build.xml
index dfde4d4..e08f03b 100755
--- a/modules/suggest/build.xml
+++ b/modules/suggest/build.xml
@@ -29,5 +29,5 @@
 
   <!-- just a list of words for testing suggesters -->
   <property name="rat.excludes" value="**/Top50KWiki.utf8"/>
-  <import file="../../lucene/contrib/contrib-build.xml"/>
+  <import file="../../lucene/module-build.xml"/>
 </project>
diff --git a/solr/common-build.xml b/solr/common-build.xml
index 7d08fb9..cc0faee 100644
--- a/solr/common-build.xml
+++ b/solr/common-build.xml
@@ -59,7 +59,7 @@
     </and>
   </condition>
 
-  <import file="${common-solr.dir}/../lucene/contrib/contrib-build.xml"/>
+  <import file="${common-solr.dir}/../lucene/module-build.xml"/>
 
   <path id="additional.dependencies">
   	<fileset dir="${common-solr.dir}/lib" excludes="${common.classpath.excludes}"/>

