GitDiffStart: f8da9b85cac9d378552f80a862dc7dfe14d7eda4 | Wed Dec 10 15:46:35 2014 +0000
diff --git a/solr/CHANGES.txt b/solr/CHANGES.txt
index 2a37630..c1b9e41 100644
--- a/solr/CHANGES.txt
+++ b/solr/CHANGES.txt
@@ -466,6 +466,9 @@ Other Changes
 * SOLR-6560: Purge termIndexInterval from example/test configs
   (Tom Burton-West, hossman)
 
+* SOLR-6773: Remove the multicore example as the DIH and cloud examples 
+  illustrate multicore behavior (hossman, Timothy Potter)
+
 ==================  4.10.3 ==================
 
 Bug Fixes
diff --git a/solr/core/src/test/org/apache/solr/cloud/TestMultiCoreConfBootstrap.java b/solr/core/src/test/org/apache/solr/cloud/TestMultiCoreConfBootstrap.java
deleted file mode 100644
index 438cc67..0000000
--- a/solr/core/src/test/org/apache/solr/cloud/TestMultiCoreConfBootstrap.java
+++ /dev/null
@@ -1,98 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.solr.cloud;
-
-import java.io.File;
-
-import org.apache.solr.SolrTestCaseJ4;
-import org.apache.solr.common.cloud.SolrZkClient;
-import org.apache.solr.core.CoreContainer;
-import org.apache.solr.util.ExternalPaths;
-import org.junit.After;
-import org.junit.Before;
-import org.junit.Test;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
-
-public class TestMultiCoreConfBootstrap extends SolrTestCaseJ4 {
-  protected static Logger log = LoggerFactory.getLogger(TestMultiCoreConfBootstrap.class);
-  protected CoreContainer cores = null;
-  private String home;
-  
-  protected File dataDir1;
-  protected File dataDir2;
-  protected ZkTestServer zkServer;
-  protected String zkDir;
-  
-  @Override
-  @Before
-  public void setUp() throws Exception {
-    super.setUp();
-    dataDir1 = createTempDir().toFile();
-    dataDir2  = createTempDir().toFile();
-
-    home = ExternalPaths.EXAMPLE_MULTICORE_HOME;
-    System.setProperty("solr.solr.home", home);
-    System.setProperty( "solr.core0.data.dir", dataDir1.getCanonicalPath() ); 
-    System.setProperty( "solr.core1.data.dir", dataDir2.getCanonicalPath() ); 
-    
-    zkDir = dataDir1.getAbsolutePath() + File.separator
-        + "zookeeper/server1/data";
-    zkServer = new ZkTestServer(zkDir);
-    zkServer.run();
-    
-    SolrZkClient zkClient = new SolrZkClient(zkServer.getZkHost(), AbstractZkTestCase.TIMEOUT);
-    zkClient.makePath("/solr", false, true);
-    zkClient.close();
-    
-    System.setProperty("zkHost", zkServer.getZkAddress());
-  }
-
-  @Override
-  @After
-  public void tearDown() throws Exception {
-    System.clearProperty("bootstrap_conf");
-    System.clearProperty("zkHost");
-    System.clearProperty("solr.solr.home");
-    
-    if (cores != null)
-      cores.shutdown();
-    
-    zkServer.shutdown();
-
-    zkServer = null;
-    zkDir = null;
-
-    super.tearDown();
-  }
-
-  @Test
-  public void testMultiCoreConfBootstrap() throws Exception {
-    System.setProperty("bootstrap_conf", "true");
-    cores = CoreContainer.createAndLoad(home, new File(home, "solr.xml"));
-    SolrZkClient zkclient = cores.getZkController().getZkClient();
-    // zkclient.printLayoutToStdOut();
-    
-    assertTrue(zkclient.exists("/configs/core1/solrconfig.xml", true));
-    assertTrue(zkclient.exists("/configs/core1/schema.xml", true));
-    assertTrue(zkclient.exists("/configs/core0/solrconfig.xml", true));
-    assertTrue(zkclient.exists("/configs/core1/schema.xml", true));
-    
-    zkclient.close();
-  }
-}
diff --git a/solr/core/src/test/org/apache/solr/cloud/ZkCLITest.java b/solr/core/src/test/org/apache/solr/cloud/ZkCLITest.java
index eda7161..0433110 100644
--- a/solr/core/src/test/org/apache/solr/cloud/ZkCLITest.java
+++ b/solr/core/src/test/org/apache/solr/cloud/ZkCLITest.java
@@ -109,23 +109,6 @@ public class ZkCLITest extends SolrTestCaseJ4 {
   }
   
   @Test
-  public void testBootstrap() throws Exception {
-    // test bootstrap_conf
-    String[] args = new String[] {"-zkhost", zkServer.getZkAddress(), "-cmd",
-        "bootstrap", "-solrhome", this.solrHome};
-    ZkCLI.main(args);
-    
-    assertTrue(zkClient.exists(ZkController.CONFIGS_ZKNODE + "/collection1", true));
-    
-    args = new String[] {"-zkhost", zkServer.getZkAddress(), "-cmd",
-        "bootstrap", "-solrhome", ExternalPaths.EXAMPLE_MULTICORE_HOME};
-    ZkCLI.main(args);
-    
-    assertTrue(zkClient.exists(ZkController.CONFIGS_ZKNODE + "/core0", true));
-    assertTrue(zkClient.exists(ZkController.CONFIGS_ZKNODE + "/core1", true));
-  }
-  
-  @Test
   public void testBootstrapWithChroot() throws Exception {
     String chroot = "/foo/bar";
     assertFalse(zkClient.exists(chroot, true));
diff --git a/solr/example/multicore/README.txt b/solr/example/multicore/README.txt
deleted file mode 100644
index eba1457..0000000
--- a/solr/example/multicore/README.txt
+++ /dev/null
@@ -1,7 +0,0 @@
-This is an alternative setup structure to support multiple cores.
-
-To run this configuration, start jetty in the example/ directory using:
-
-java -Dsolr.solr.home=multicore -jar start.jar
-
-For general examples on standard solr configuration, see the "solr" directory.
diff --git a/solr/example/multicore/core0/conf/schema.xml b/solr/example/multicore/core0/conf/schema.xml
deleted file mode 100644
index 1f2d33e..0000000
--- a/solr/example/multicore/core0/conf/schema.xml
+++ /dev/null
@@ -1,39 +0,0 @@
-<?xml version="1.0" ?>
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<schema name="example core zero" version="1.1">
-
-   <fieldtype name="string"  class="solr.StrField" sortMissingLast="true" omitNorms="true"/>
-   <fieldType name="long" class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
-  <!-- general -->
-  <field name="id"        type="string"   indexed="true"  stored="true"  multiValued="false" required="true"/>
-  <field name="type"      type="string"   indexed="true"  stored="true"  multiValued="false" /> 
-  <field name="name"      type="string"   indexed="true"  stored="true"  multiValued="false" /> 
-  <field name="core0"     type="string"   indexed="true"  stored="true"  multiValued="false" /> 
-  <field name="_version_" type="long"     indexed="true"  stored="true"/>
-
- <!-- field to use to determine and enforce document uniqueness. -->
- <uniqueKey>id</uniqueKey>
-
- <!-- field for the QueryParser to use when an explicit fieldname is absent -->
- <defaultSearchField>name</defaultSearchField>
-
- <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
- <solrQueryParser defaultOperator="OR"/>
-</schema>
-
diff --git a/solr/example/multicore/core0/conf/solrconfig.xml b/solr/example/multicore/core0/conf/solrconfig.xml
deleted file mode 100644
index 2608d02..0000000
--- a/solr/example/multicore/core0/conf/solrconfig.xml
+++ /dev/null
@@ -1,73 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<!--
- This is a stripped down config file used for a simple example...  
- It is *not* a good example to work from. 
--->
-<config>
-  <luceneMatchVersion>6.0.0</luceneMatchVersion>
-  <!--  The DirectoryFactory to use for indexes.
-        solr.StandardDirectoryFactory, the default, is filesystem based.
-        solr.RAMDirectoryFactory is memory based, not persistent, and doesn't work with replication. -->
-  <directoryFactory name="DirectoryFactory" class="${solr.directoryFactory:solr.StandardDirectoryFactory}"/>
-
-  <dataDir>${solr.core0.data.dir:}</dataDir>
-
-  <!-- To enable dynamic schema REST APIs, use the following for <schemaFactory>:
-  
-       <schemaFactory class="ManagedIndexSchemaFactory">
-         <bool name="mutable">true</bool>
-         <str name="managedSchemaResourceName">managed-schema</str>
-       </schemaFactory>
-       
-       When ManagedIndexSchemaFactory is specified, Solr will load the schema from
-       he resource named in 'managedSchemaResourceName', rather than from schema.xml.
-       Note that the managed schema resource CANNOT be named schema.xml.  If the managed
-       schema does not exist, Solr will create it after reading schema.xml, then rename
-       'schema.xml' to 'schema.xml.bak'. 
-       
-       Do NOT hand edit the managed schema - external modifications will be ignored and
-       overwritten as a result of schema modification REST API calls.
-
-       When ManagedIndexSchemaFactory is specified with mutable = true, schema
-       modification REST API calls will be allowed; otherwise, error responses will be
-       sent back for these requests. 
-  -->
-  <schemaFactory class="ClassicIndexSchemaFactory"/>
-
-  <updateHandler class="solr.DirectUpdateHandler2">
-    <updateLog>
-      <str name="dir">${solr.core0.data.dir:}</str>
-    </updateLog>
-  </updateHandler>
-
-  <requestDispatcher handleSelect="true" >
-    <requestParsers enableRemoteStreaming="false" multipartUploadLimitInKB="2048" formdataUploadLimitInKB="2048" />
-  </requestDispatcher>
-  
-  <requestHandler name="standard" class="solr.StandardRequestHandler" default="true" />
-  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />
-
-  <!-- config for the admin interface --> 
-  <admin>
-    <defaultQuery>solr</defaultQuery>
-  </admin>
-
-</config>
-
diff --git a/solr/example/multicore/core1/conf/schema.xml b/solr/example/multicore/core1/conf/schema.xml
deleted file mode 100644
index c958453..0000000
--- a/solr/example/multicore/core1/conf/schema.xml
+++ /dev/null
@@ -1,40 +0,0 @@
-<?xml version="1.0" ?>
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<schema name="example core one" version="1.1">
-
-   <fieldtype name="string"  class="solr.StrField" sortMissingLast="true" omitNorms="true"/>
-   <fieldType name="long" class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
-
-  <!-- general -->
-  <field name="id"        type="string"    indexed="true"  stored="true"  multiValued="false" required="true"/>
-  <field name="type"      type="string"    indexed="true"  stored="true"  multiValued="false" /> 
-  <field name="name"      type="string"    indexed="true"  stored="true"  multiValued="false" /> 
-  <field name="core1"     type="string"    indexed="true"  stored="true"  multiValued="false" />
-  <field name="_version_" type="long"      indexed="true"  stored="true"/>
-
- <!-- field to use to determine and enforce document uniqueness. -->
- <uniqueKey>id</uniqueKey>
-
- <!-- field for the QueryParser to use when an explicit fieldname is absent -->
- <defaultSearchField>name</defaultSearchField>
-
- <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
- <solrQueryParser defaultOperator="OR"/>
-</schema>
-
diff --git a/solr/example/multicore/core1/conf/solrconfig.xml b/solr/example/multicore/core1/conf/solrconfig.xml
deleted file mode 100644
index 40ea23b..0000000
--- a/solr/example/multicore/core1/conf/solrconfig.xml
+++ /dev/null
@@ -1,74 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<!--
- This is a stripped down config file used for a simple example...  
- It is *not* a good example to work from. 
--->
-<config>
-  <luceneMatchVersion>6.0.0</luceneMatchVersion>
-  <!--  The DirectoryFactory to use for indexes.
-        solr.StandardDirectoryFactory, the default, is filesystem based.
-        solr.RAMDirectoryFactory is memory based, not persistent, and doesn't work with replication. -->
-  <directoryFactory name="DirectoryFactory" class="${solr.directoryFactory:solr.StandardDirectoryFactory}"/>
-
-  <dataDir>${solr.core1.data.dir:}</dataDir>
-
-  <!-- To enable dynamic schema REST APIs, use the following for <schemaFactory>:
-  
-       <schemaFactory class="ManagedIndexSchemaFactory">
-         <bool name="mutable">true</bool>
-         <str name="managedSchemaResourceName">managed-schema</str>
-       </schemaFactory>
-       
-       When ManagedIndexSchemaFactory is specified, Solr will load the schema from
-       he resource named in 'managedSchemaResourceName', rather than from schema.xml.
-       Note that the managed schema resource CANNOT be named schema.xml.  If the managed
-       schema does not exist, Solr will create it after reading schema.xml, then rename
-       'schema.xml' to 'schema.xml.bak'. 
-       
-       Do NOT hand edit the managed schema - external modifications will be ignored and
-       overwritten as a result of schema modification REST API calls.
-
-       When ManagedIndexSchemaFactory is specified with mutable = true, schema
-       modification REST API calls will be allowed; otherwise, error responses will be
-       sent back for these requests. 
-  -->
-  <schemaFactory class="ClassicIndexSchemaFactory"/>
-
-  <updateHandler class="solr.DirectUpdateHandler2">
-    <updateLog>
-      <str name="dir">${solr.core1.data.dir:}</str>
-    </updateLog>
-  </updateHandler>
-
-  <requestDispatcher handleSelect="true" >
-    <requestParsers enableRemoteStreaming="false" multipartUploadLimitInKB="2048" formdataUploadLimitInKB="2048" />
-  </requestDispatcher>
-  
-  <requestHandler name="standard" class="solr.StandardRequestHandler" default="true" />
-  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />
-
-
-  <!-- config for the admin interface --> 
-  <admin>
-    <defaultQuery>solr</defaultQuery>
-  </admin>
-
-</config>
-
diff --git a/solr/example/multicore/exampledocs/ipod_other.xml b/solr/example/multicore/exampledocs/ipod_other.xml
deleted file mode 100644
index 4bfa310..0000000
--- a/solr/example/multicore/exampledocs/ipod_other.xml
+++ /dev/null
@@ -1,34 +0,0 @@
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<add>
-
-<doc>
-  <field name="id">F8V7067-APL-KIT</field>
-  <field name="name">Belkin Mobile Power Cord for iPod w/ Dock</field>
-</doc>
-
-<doc>
-  <field name="id">IW-02</field>
-  <field name="name">iPod &amp; iPod Mini USB 2.0 Cable</field>
-</doc>
-
-
-</add>
-
-
-
diff --git a/solr/example/multicore/exampledocs/ipod_video.xml b/solr/example/multicore/exampledocs/ipod_video.xml
deleted file mode 100644
index 3547fd3..0000000
--- a/solr/example/multicore/exampledocs/ipod_video.xml
+++ /dev/null
@@ -1,22 +0,0 @@
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<add><doc>
-  <field name="id">MA147LL/A</field>
-  <field name="name">Apple 60 GB iPod with Video Playback Black</field>
-
-</doc></add>
diff --git a/solr/example/multicore/solr.xml b/solr/example/multicore/solr.xml
deleted file mode 100644
index 4e27135..0000000
--- a/solr/example/multicore/solr.xml
+++ /dev/null
@@ -1,40 +0,0 @@
-<?xml version="1.0" encoding="UTF-8" ?>
-<!--
- Licensed to the Apache Software Foundation (ASF) under one or more
- contributor license agreements.  See the NOTICE file distributed with
- this work for additional information regarding copyright ownership.
- The ASF licenses this file to You under the Apache License, Version 2.0
- (the "License"); you may not use this file except in compliance with
- the License.  You may obtain a copy of the License at
-
-     http://www.apache.org/licenses/LICENSE-2.0
-
- Unless required by applicable law or agreed to in writing, software
- distributed under the License is distributed on an "AS IS" BASIS,
- WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- See the License for the specific language governing permissions and
- limitations under the License.
--->
-
-<!--
- All (relative) paths are relative to the installation path
-  
-  persistent: Save changes made via the API to this file
-  sharedLib: path to a lib directory that will be shared across all cores
--->
-<solr persistent="false">
-
-  <!--
-  adminPath: RequestHandler path to manage cores.  
-    If 'null' (or absent), cores will not be manageable via request handler
-  -->
-  <cores adminPath="/admin/cores" host="${host:}" hostPort="${jetty.port:8983}" hostContext="${hostContext:solr}">
-    <core name="core0" instanceDir="core0" />
-    <core name="core1" instanceDir="core1" />
-    
-    <shardHandlerFactory name="shardHandlerFactory" class="HttpShardHandlerFactory">
-      <str name="urlScheme">${urlScheme:}</str>
-    </shardHandlerFactory>
-  </cores>
-        
-</solr>
diff --git a/solr/example/multicore/zoo.cfg b/solr/example/multicore/zoo.cfg
deleted file mode 100644
index aea4518..0000000
--- a/solr/example/multicore/zoo.cfg
+++ /dev/null
@@ -1,17 +0,0 @@
-# The number of milliseconds of each tick
-tickTime=2000
-# The number of ticks that the initial
-# synchronization phase can take
-initLimit=10
-# The number of ticks that can pass between
-# sending a request and getting an acknowledgement
-syncLimit=5
-
-# the directory where the snapshot is stored.
-# dataDir=/opt/zookeeper/data
-# NOTE: Solr defaults the dataDir to <solrHome>/zoo_data
-
-# the port at which the clients will connect
-# clientPort=2181
-# NOTE: Solr sets this based on zkRun / zkHost params
-
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/README.txt b/solr/solrj/src/test-files/solrj/solr/multicore/README.txt
new file mode 100644
index 0000000..eba1457
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/README.txt
@@ -0,0 +1,7 @@
+This is an alternative setup structure to support multiple cores.
+
+To run this configuration, start jetty in the example/ directory using:
+
+java -Dsolr.solr.home=multicore -jar start.jar
+
+For general examples on standard solr configuration, see the "solr" directory.
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/core0/conf/schema.xml b/solr/solrj/src/test-files/solrj/solr/multicore/core0/conf/schema.xml
new file mode 100644
index 0000000..1f2d33e
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/core0/conf/schema.xml
@@ -0,0 +1,39 @@
+<?xml version="1.0" ?>
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<schema name="example core zero" version="1.1">
+
+   <fieldtype name="string"  class="solr.StrField" sortMissingLast="true" omitNorms="true"/>
+   <fieldType name="long" class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
+  <!-- general -->
+  <field name="id"        type="string"   indexed="true"  stored="true"  multiValued="false" required="true"/>
+  <field name="type"      type="string"   indexed="true"  stored="true"  multiValued="false" /> 
+  <field name="name"      type="string"   indexed="true"  stored="true"  multiValued="false" /> 
+  <field name="core0"     type="string"   indexed="true"  stored="true"  multiValued="false" /> 
+  <field name="_version_" type="long"     indexed="true"  stored="true"/>
+
+ <!-- field to use to determine and enforce document uniqueness. -->
+ <uniqueKey>id</uniqueKey>
+
+ <!-- field for the QueryParser to use when an explicit fieldname is absent -->
+ <defaultSearchField>name</defaultSearchField>
+
+ <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
+ <solrQueryParser defaultOperator="OR"/>
+</schema>
+
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/core0/conf/solrconfig.xml b/solr/solrj/src/test-files/solrj/solr/multicore/core0/conf/solrconfig.xml
new file mode 100644
index 0000000..2608d02
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/core0/conf/solrconfig.xml
@@ -0,0 +1,73 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<!--
+ This is a stripped down config file used for a simple example...  
+ It is *not* a good example to work from. 
+-->
+<config>
+  <luceneMatchVersion>6.0.0</luceneMatchVersion>
+  <!--  The DirectoryFactory to use for indexes.
+        solr.StandardDirectoryFactory, the default, is filesystem based.
+        solr.RAMDirectoryFactory is memory based, not persistent, and doesn't work with replication. -->
+  <directoryFactory name="DirectoryFactory" class="${solr.directoryFactory:solr.StandardDirectoryFactory}"/>
+
+  <dataDir>${solr.core0.data.dir:}</dataDir>
+
+  <!-- To enable dynamic schema REST APIs, use the following for <schemaFactory>:
+  
+       <schemaFactory class="ManagedIndexSchemaFactory">
+         <bool name="mutable">true</bool>
+         <str name="managedSchemaResourceName">managed-schema</str>
+       </schemaFactory>
+       
+       When ManagedIndexSchemaFactory is specified, Solr will load the schema from
+       he resource named in 'managedSchemaResourceName', rather than from schema.xml.
+       Note that the managed schema resource CANNOT be named schema.xml.  If the managed
+       schema does not exist, Solr will create it after reading schema.xml, then rename
+       'schema.xml' to 'schema.xml.bak'. 
+       
+       Do NOT hand edit the managed schema - external modifications will be ignored and
+       overwritten as a result of schema modification REST API calls.
+
+       When ManagedIndexSchemaFactory is specified with mutable = true, schema
+       modification REST API calls will be allowed; otherwise, error responses will be
+       sent back for these requests. 
+  -->
+  <schemaFactory class="ClassicIndexSchemaFactory"/>
+
+  <updateHandler class="solr.DirectUpdateHandler2">
+    <updateLog>
+      <str name="dir">${solr.core0.data.dir:}</str>
+    </updateLog>
+  </updateHandler>
+
+  <requestDispatcher handleSelect="true" >
+    <requestParsers enableRemoteStreaming="false" multipartUploadLimitInKB="2048" formdataUploadLimitInKB="2048" />
+  </requestDispatcher>
+  
+  <requestHandler name="standard" class="solr.StandardRequestHandler" default="true" />
+  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />
+
+  <!-- config for the admin interface --> 
+  <admin>
+    <defaultQuery>solr</defaultQuery>
+  </admin>
+
+</config>
+
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/core1/conf/schema.xml b/solr/solrj/src/test-files/solrj/solr/multicore/core1/conf/schema.xml
new file mode 100644
index 0000000..c958453
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/core1/conf/schema.xml
@@ -0,0 +1,40 @@
+<?xml version="1.0" ?>
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<schema name="example core one" version="1.1">
+
+   <fieldtype name="string"  class="solr.StrField" sortMissingLast="true" omitNorms="true"/>
+   <fieldType name="long" class="solr.TrieLongField" precisionStep="0" positionIncrementGap="0"/>
+
+  <!-- general -->
+  <field name="id"        type="string"    indexed="true"  stored="true"  multiValued="false" required="true"/>
+  <field name="type"      type="string"    indexed="true"  stored="true"  multiValued="false" /> 
+  <field name="name"      type="string"    indexed="true"  stored="true"  multiValued="false" /> 
+  <field name="core1"     type="string"    indexed="true"  stored="true"  multiValued="false" />
+  <field name="_version_" type="long"      indexed="true"  stored="true"/>
+
+ <!-- field to use to determine and enforce document uniqueness. -->
+ <uniqueKey>id</uniqueKey>
+
+ <!-- field for the QueryParser to use when an explicit fieldname is absent -->
+ <defaultSearchField>name</defaultSearchField>
+
+ <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
+ <solrQueryParser defaultOperator="OR"/>
+</schema>
+
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/core1/conf/solrconfig.xml b/solr/solrj/src/test-files/solrj/solr/multicore/core1/conf/solrconfig.xml
new file mode 100644
index 0000000..40ea23b
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/core1/conf/solrconfig.xml
@@ -0,0 +1,74 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<!--
+ This is a stripped down config file used for a simple example...  
+ It is *not* a good example to work from. 
+-->
+<config>
+  <luceneMatchVersion>6.0.0</luceneMatchVersion>
+  <!--  The DirectoryFactory to use for indexes.
+        solr.StandardDirectoryFactory, the default, is filesystem based.
+        solr.RAMDirectoryFactory is memory based, not persistent, and doesn't work with replication. -->
+  <directoryFactory name="DirectoryFactory" class="${solr.directoryFactory:solr.StandardDirectoryFactory}"/>
+
+  <dataDir>${solr.core1.data.dir:}</dataDir>
+
+  <!-- To enable dynamic schema REST APIs, use the following for <schemaFactory>:
+  
+       <schemaFactory class="ManagedIndexSchemaFactory">
+         <bool name="mutable">true</bool>
+         <str name="managedSchemaResourceName">managed-schema</str>
+       </schemaFactory>
+       
+       When ManagedIndexSchemaFactory is specified, Solr will load the schema from
+       he resource named in 'managedSchemaResourceName', rather than from schema.xml.
+       Note that the managed schema resource CANNOT be named schema.xml.  If the managed
+       schema does not exist, Solr will create it after reading schema.xml, then rename
+       'schema.xml' to 'schema.xml.bak'. 
+       
+       Do NOT hand edit the managed schema - external modifications will be ignored and
+       overwritten as a result of schema modification REST API calls.
+
+       When ManagedIndexSchemaFactory is specified with mutable = true, schema
+       modification REST API calls will be allowed; otherwise, error responses will be
+       sent back for these requests. 
+  -->
+  <schemaFactory class="ClassicIndexSchemaFactory"/>
+
+  <updateHandler class="solr.DirectUpdateHandler2">
+    <updateLog>
+      <str name="dir">${solr.core1.data.dir:}</str>
+    </updateLog>
+  </updateHandler>
+
+  <requestDispatcher handleSelect="true" >
+    <requestParsers enableRemoteStreaming="false" multipartUploadLimitInKB="2048" formdataUploadLimitInKB="2048" />
+  </requestDispatcher>
+  
+  <requestHandler name="standard" class="solr.StandardRequestHandler" default="true" />
+  <requestHandler name="/analysis/field" startup="lazy" class="solr.FieldAnalysisRequestHandler" />
+
+
+  <!-- config for the admin interface --> 
+  <admin>
+    <defaultQuery>solr</defaultQuery>
+  </admin>
+
+</config>
+
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/exampledocs/ipod_other.xml b/solr/solrj/src/test-files/solrj/solr/multicore/exampledocs/ipod_other.xml
new file mode 100644
index 0000000..4bfa310
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/exampledocs/ipod_other.xml
@@ -0,0 +1,34 @@
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<add>
+
+<doc>
+  <field name="id">F8V7067-APL-KIT</field>
+  <field name="name">Belkin Mobile Power Cord for iPod w/ Dock</field>
+</doc>
+
+<doc>
+  <field name="id">IW-02</field>
+  <field name="name">iPod &amp; iPod Mini USB 2.0 Cable</field>
+</doc>
+
+
+</add>
+
+
+
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/exampledocs/ipod_video.xml b/solr/solrj/src/test-files/solrj/solr/multicore/exampledocs/ipod_video.xml
new file mode 100644
index 0000000..3547fd3
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/exampledocs/ipod_video.xml
@@ -0,0 +1,22 @@
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<add><doc>
+  <field name="id">MA147LL/A</field>
+  <field name="name">Apple 60 GB iPod with Video Playback Black</field>
+
+</doc></add>
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/solr.xml b/solr/solrj/src/test-files/solrj/solr/multicore/solr.xml
new file mode 100644
index 0000000..4e27135
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/solr.xml
@@ -0,0 +1,40 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+-->
+
+<!--
+ All (relative) paths are relative to the installation path
+  
+  persistent: Save changes made via the API to this file
+  sharedLib: path to a lib directory that will be shared across all cores
+-->
+<solr persistent="false">
+
+  <!--
+  adminPath: RequestHandler path to manage cores.  
+    If 'null' (or absent), cores will not be manageable via request handler
+  -->
+  <cores adminPath="/admin/cores" host="${host:}" hostPort="${jetty.port:8983}" hostContext="${hostContext:solr}">
+    <core name="core0" instanceDir="core0" />
+    <core name="core1" instanceDir="core1" />
+    
+    <shardHandlerFactory name="shardHandlerFactory" class="HttpShardHandlerFactory">
+      <str name="urlScheme">${urlScheme:}</str>
+    </shardHandlerFactory>
+  </cores>
+        
+</solr>
diff --git a/solr/solrj/src/test-files/solrj/solr/multicore/zoo.cfg b/solr/solrj/src/test-files/solrj/solr/multicore/zoo.cfg
new file mode 100644
index 0000000..aea4518
--- /dev/null
+++ b/solr/solrj/src/test-files/solrj/solr/multicore/zoo.cfg
@@ -0,0 +1,17 @@
+# The number of milliseconds of each tick
+tickTime=2000
+# The number of ticks that the initial
+# synchronization phase can take
+initLimit=10
+# The number of ticks that can pass between
+# sending a request and getting an acknowledgement
+syncLimit=5
+
+# the directory where the snapshot is stored.
+# dataDir=/opt/zookeeper/data
+# NOTE: Solr defaults the dataDir to <solrHome>/zoo_data
+
+# the port at which the clients will connect
+# clientPort=2181
+# NOTE: Solr sets this based on zkRun / zkHost params
+
diff --git a/solr/solrj/src/test/org/apache/solr/client/solrj/MergeIndexesExampleTestBase.java b/solr/solrj/src/test/org/apache/solr/client/solrj/MergeIndexesExampleTestBase.java
index d11e3bb..2b004a0 100644
--- a/solr/solrj/src/test/org/apache/solr/client/solrj/MergeIndexesExampleTestBase.java
+++ b/solr/solrj/src/test/org/apache/solr/client/solrj/MergeIndexesExampleTestBase.java
@@ -21,6 +21,7 @@ import java.io.File;
 import java.io.IOException;
 import java.util.Arrays;
 
+import org.apache.solr.SolrTestCaseJ4;
 import org.apache.solr.client.solrj.request.AbstractUpdateRequest;
 import org.apache.solr.client.solrj.request.CoreAdminRequest;
 import org.apache.solr.client.solrj.request.QueryRequest;
@@ -30,7 +31,6 @@ import org.apache.solr.common.params.CoreAdminParams;
 import org.apache.solr.common.params.SolrParams;
 import org.apache.solr.core.CoreContainer;
 import org.apache.solr.core.SolrCore;
-import org.apache.solr.util.ExternalPaths;
 import org.junit.BeforeClass;
 
 /**
@@ -48,7 +48,7 @@ public abstract class MergeIndexesExampleTestBase extends SolrExampleTestBase {
 
   @Override
   public String getSolrHome() {
-    return ExternalPaths.EXAMPLE_MULTICORE_HOME;
+    return SolrTestCaseJ4.getFile("solrj/solr/multicore").getAbsolutePath();
   }
 
   @BeforeClass
diff --git a/solr/solrj/src/test/org/apache/solr/client/solrj/MultiCoreExampleTestBase.java b/solr/solrj/src/test/org/apache/solr/client/solrj/MultiCoreExampleTestBase.java
deleted file mode 100644
index 0d7659f..0000000
--- a/solr/solrj/src/test/org/apache/solr/client/solrj/MultiCoreExampleTestBase.java
+++ /dev/null
@@ -1,260 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.solr.client.solrj;
-
-import java.io.File;
-import java.util.HashSet;
-import java.util.Set;
-
-import org.apache.lucene.util.LuceneTestCase;
-import org.apache.lucene.util.TestUtil;
-import org.apache.solr.client.solrj.request.AbstractUpdateRequest.ACTION;
-import org.apache.solr.client.solrj.request.CoreAdminRequest;
-import org.apache.solr.client.solrj.request.CoreAdminRequest.Unload;
-import org.apache.solr.client.solrj.request.QueryRequest;
-import org.apache.solr.client.solrj.request.UpdateRequest;
-import org.apache.solr.client.solrj.response.CoreAdminResponse;
-import org.apache.solr.common.SolrInputDocument;
-import org.apache.solr.common.util.NamedList;
-import org.apache.solr.core.CoreContainer;
-import org.apache.solr.util.ExternalPaths;
-import org.junit.Test;
-
-
-/**
- *
- * @since solr 1.3
- */
-public abstract class MultiCoreExampleTestBase extends SolrExampleTestBase 
-{
-  protected CoreContainer cores;
-
-  private File dataDir2;
-  private File dataDir1;
-  
-  private SolrServer solrCore0;
-  private SolrServer solrCore1;
-  private SolrServer solrAdmin;
-  
-  private final Set<SolrServer> clients = new HashSet<>();
-
-  @Override public String getSolrHome() { return ExternalPaths.EXAMPLE_MULTICORE_HOME; }
-
-  @Override public void setUp() throws Exception {
-    super.setUp();
-    dataDir1 = createTempDir().toFile();
-    dataDir2 = createTempDir().toFile();
-    
-    System.setProperty( "solr.core0.data.dir", this.dataDir1.getCanonicalPath() ); 
-    System.setProperty( "solr.core1.data.dir", this.dataDir2.getCanonicalPath() );
-  }
-  
-  @Override
-  public void tearDown() throws Exception {
-    super.tearDown();
-    
-    if(solrCore0 != null) solrCore0.shutdown();
-    if(solrCore1 != null) solrCore1.shutdown();
-    if(solrAdmin != null) solrAdmin.shutdown();
-    solrCore0 = solrCore1 = solrAdmin = null;
-    for (SolrServer client:clients) {
-      client.shutdown();
-    }
-    clients.clear();
-  }
-
-  @Override
-  protected final SolrServer getSolrServer()
-  {
-    throw new UnsupportedOperationException();
-  }
-  
-  @Override
-  protected final SolrServer createNewSolrServer()
-  {
-    throw new UnsupportedOperationException();
-  }
-  
-  protected SolrServer getSolrCore0()
-  {
-    if (solrCore0 == null) {
-      solrCore0 = createServer( "core0" );
-    }
-    return solrCore0;
-  }
-
-  protected SolrServer getSolrCore1()
-  {
-    if (solrCore1 == null) {
-      solrCore1 = createServer( "core1" );
-    }
-    return solrCore1;
-  }
-
-  protected SolrServer getSolrAdmin()
-  {
-    if (solrAdmin == null) {
-      solrAdmin = createServer( "" );
-    }
-    return solrAdmin;
-  } 
-  
-  protected SolrServer getSolrCore(String name)
-  {
-    SolrServer server = createServer(name);
-    clients.add(server);
-    return server;
-  }
-
-
-  protected abstract SolrServer createServer(String string);
-
-  @Test
-  public void testMultiCore() throws Exception
-  {
-    UpdateRequest up = new UpdateRequest();
-    up.setAction(ACTION.COMMIT, true, true);
-    up.deleteByQuery("*:*");
-    up.process(getSolrCore0());
-    up.process(getSolrCore1());
-    up.clear();
-    
-    // Add something to each core
-    SolrInputDocument doc = new SolrInputDocument();
-    doc.setField( "id", "AAA" );
-    doc.setField( "name", "AAA1" );
-    doc.setField( "type", "BBB1" );
-    doc.setField( "core0", "yup" );
-   
-    // Add to core0
-    up.add( doc );
-    up.process( getSolrCore0() );
-
-    // You can't add it to core1
-    try {
-      ignoreException("unknown field");
-      up.process( getSolrCore1() );
-      fail( "Can't add core0 field to core1!" );
-    }
-    catch( Exception ex ) {}
-    resetExceptionIgnores();
-
-    // Add to core1
-    doc.setField( "id", "BBB" );
-    doc.setField( "name", "BBB1" );
-    doc.setField( "type", "AAA1" );
-    doc.setField( "core1", "yup" );
-    doc.removeField( "core0" );
-    up.add( doc );
-    up.process( getSolrCore1() );
-
-    // You can't add it to core1
-    try {
-      ignoreException("unknown field");
-      up.process( getSolrCore0() );
-      fail( "Can't add core1 field to core0!" );
-    }
-    catch( Exception ex ) {}
-    resetExceptionIgnores();
-
-    // in core0
-    doc = new SolrInputDocument();
-    doc.setField( "id", "BBB1" );
-    doc.setField( "name", "AAA1" );
-    doc.setField( "type", "BBB" );
-    doc.setField( "core0", "AAA1" );
-
-    up.clear();
-    up.add( doc );
-    up.process( getSolrCore0() );
-
-    // now Make sure AAA is in 0 and BBB in 1
-    SolrQuery q = new SolrQuery();
-    QueryRequest r = new QueryRequest( q );
-    q.setQuery( "id:AAA" );
-    assertEquals( 1, r.process( getSolrCore0() ).getResults().size() );
-    assertEquals( 0, r.process( getSolrCore1() ).getResults().size() );
-    
-    // Now test Changing the default core
-    assertEquals( 1, getSolrCore0().query( new SolrQuery( "id:AAA" ) ).getResults().size() );
-    assertEquals( 0, getSolrCore0().query( new SolrQuery( "id:BBB" ) ).getResults().size() );
-
-    assertEquals( 0, getSolrCore1().query( new SolrQuery( "id:AAA" ) ).getResults().size() );
-    assertEquals( 1, getSolrCore1().query( new SolrQuery( "id:BBB" ) ).getResults().size() );
-
-    // cross-core join
-    assertEquals( 0, getSolrCore0().query( new SolrQuery( "{!join from=type to=name}*:*" ) ).getResults().size() );  // normal join
-    assertEquals( 2, getSolrCore0().query( new SolrQuery( "{!join from=type to=name fromIndex=core1}id:BBB" ) ).getResults().size() );
-    assertEquals( 1, getSolrCore1().query( new SolrQuery( "{!join from=type to=name fromIndex=core0}id:AAA" ) ).getResults().size() );
-
-    // test that no rewrite happens in core0 (if it does, it will rewrite to BBB1 and nothing will be found in core1)
-    assertEquals( 2, getSolrCore0().query( new SolrQuery( "{!join from=type to=name fromIndex=core1}id:BB~" ) ).getResults().size() );
-
-    // test that query is parsed in the fromCore
-    assertEquals( 2, getSolrCore0().query( new SolrQuery( "{!join from=type to=name fromIndex=core1}core1:yup" ) ).getResults().size() );
-
-    // Now test reloading it should have a newer open time
-    String name = "core0";
-    SolrServer coreadmin = getSolrAdmin();
-    CoreAdminResponse mcr = CoreAdminRequest.getStatus( name, coreadmin );
-    long before = mcr.getStartTime( name ).getTime();
-    CoreAdminRequest.reloadCore( name, coreadmin );
-    
-    // core should still have docs
-    assertEquals( 1, getSolrCore0().query( new SolrQuery( "id:AAA" ) ).getResults().size() );
-    
-    mcr = CoreAdminRequest.getStatus( name, coreadmin );
-    long after = mcr.getStartTime( name ).getTime();
-    assertTrue( "should have more recent time: "+after+","+before, after > before );
-
-    // test move
-    CoreAdminRequest.renameCore("core1","corea",coreadmin);
-    CoreAdminRequest.renameCore("corea","coreb",coreadmin);
-    CoreAdminRequest.renameCore("coreb","corec",coreadmin);
-    CoreAdminRequest.renameCore("corec","cored",coreadmin);
-    CoreAdminRequest.renameCore("cored","corefoo",coreadmin);
-    try { 
-      getSolrCore("core1").query( new SolrQuery( "id:BBB" ) );
-      fail( "core1 should be gone" );
-    }
-    catch( Exception ex ) {}
-    
-    assertEquals( 1, getSolrCore("corefoo").query( new SolrQuery( "id:BBB" ) ).getResults().size() );
-
-    NamedList<Object> response = getSolrCore("corefoo").query(new SolrQuery().setRequestHandler("/admin/system")).getResponse();
-    NamedList<Object> coreInfo = (NamedList<Object>) response.get("core");
-    String indexDir = (String) ((NamedList<Object>) coreInfo.get("directory")).get("index");
-    
-    response = getSolrCore("core0").query(new SolrQuery().setRequestHandler("/admin/system")).getResponse();
-    coreInfo = (NamedList<Object>) response.get("core");
-    String dataDir = (String) ((NamedList<Object>) coreInfo.get("directory")).get("data");
-    
-    // test delete index on core
-    CoreAdminRequest.unloadCore("corefoo", true, coreadmin);
-    File dir = new File(indexDir);
-    assertFalse("Index directory exists after core unload with deleteIndex=true", dir.exists());
-    
-    Unload req = new Unload(false);
-    req.setDeleteDataDir(true);
-    req.setCoreName("core0");
-    req.process(coreadmin);
-    
-    dir = new File(dataDir);
-    assertFalse("Data directory exists after core unload with deleteDataDir=true : " + dir, dir.exists());
-  }
-}
diff --git a/solr/solrj/src/test/org/apache/solr/client/solrj/embedded/MultiCoreEmbeddedTest.java b/solr/solrj/src/test/org/apache/solr/client/solrj/embedded/MultiCoreEmbeddedTest.java
deleted file mode 100644
index e57ab9a..0000000
--- a/solr/solrj/src/test/org/apache/solr/client/solrj/embedded/MultiCoreEmbeddedTest.java
+++ /dev/null
@@ -1,62 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.solr.client.solrj.embedded;
-
-import org.apache.solr.client.solrj.MultiCoreExampleTestBase;
-import org.apache.solr.client.solrj.SolrServer;
-import org.apache.solr.core.CoreContainer;
-import org.apache.solr.core.SolrCore;
-
-/**
- * This runs SolrServer test using 
- * 
- *
- * @since solr 1.3
- */
-public class MultiCoreEmbeddedTest extends MultiCoreExampleTestBase {
-
-  @Override public void setUp() throws Exception 
-  {
-    // TODO: fix this test to use MockDirectoryFactory
-    System.clearProperty("solr.directoryFactory");
-    super.setUp();
-    setupCoreContainer();
-    SolrCore.log.info("CORES=" + cores + " : " + cores.getCoreNames());
-  }
-  
-  protected void setupCoreContainer() {
-    cores = new CoreContainer();
-    cores.load();
-  }
-  
-  @Override
-  public void tearDown() throws Exception {
-    cores.shutdown();
-    super.tearDown();
-  }
-
-  @Override
-  protected SolrServer createServer(String string) {
-    return new EmbeddedSolrServer( cores, string );
-  } 
-  
-  protected SolrServer getSolrAdmin()
-  {
-    return getSolrCore0();
-  } 
-}
diff --git a/solr/solrj/src/test/org/apache/solr/client/solrj/embedded/MultiCoreExampleJettyTest.java b/solr/solrj/src/test/org/apache/solr/client/solrj/embedded/MultiCoreExampleJettyTest.java
deleted file mode 100644
index dca452c..0000000
--- a/solr/solrj/src/test/org/apache/solr/client/solrj/embedded/MultiCoreExampleJettyTest.java
+++ /dev/null
@@ -1,128 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements.  See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache License, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the License for the specific language governing permissions and
- * limitations under the License.
- */
-
-package org.apache.solr.client.solrj.embedded;
-
-import org.apache.solr.SolrTestCaseJ4;
-import org.apache.solr.client.solrj.MultiCoreExampleTestBase;
-import org.apache.solr.client.solrj.SolrQuery;
-import org.apache.solr.client.solrj.SolrServer;
-import org.apache.solr.client.solrj.impl.HttpSolrServer;
-import org.apache.solr.client.solrj.request.AbstractUpdateRequest.ACTION;
-import org.apache.solr.client.solrj.request.QueryRequest;
-import org.apache.solr.client.solrj.request.UpdateRequest;
-import org.apache.solr.common.SolrDocument;
-import org.apache.solr.common.SolrDocumentList;
-import org.apache.solr.common.SolrInputDocument;
-import org.apache.solr.common.params.ShardParams;
-import org.junit.Test;
-
-/**
- * TODO? perhaps use:
- *  http://docs.codehaus.org/display/JETTY/ServletTester
- * rather then open a real connection?
- * 
- *
- * @since solr 1.3
- */
-public class MultiCoreExampleJettyTest extends MultiCoreExampleTestBase {
-
-  JettySolrRunner jetty;
-  int port = 0;
-  static final String context = "/example";
-  
-  @Override public void setUp() throws Exception 
-  {    
-    // TODO: fix this test to use MockDirectoryFactory
-    System.clearProperty("solr.directoryFactory");
-    super.setUp();
-
-    jetty = new JettySolrRunner(getSolrHome(), context, 0, null, null, true, null, sslConfig);
-    jetty.start(false);
-    port = jetty.getLocalPort();
-
-  }
-
-  @Override public void tearDown() throws Exception 
-  {
-    super.tearDown();
-    jetty.stop();  // stop the server
-  }
-  
-  protected SolrServer createServer( String name )
-  {
-    try {
-      // setup the server...
-      String url = buildUrl(port, context) + "/" + name;
-      HttpSolrServer s = new HttpSolrServer( url );
-      s.setConnectionTimeout(SolrTestCaseJ4.DEFAULT_CONNECTION_TIMEOUT);
-      s.setDefaultMaxConnectionsPerHost(100);
-      s.setMaxTotalConnections(100);
-      return s;
-    }
-    catch( Exception ex ) {
-      throw new RuntimeException( ex );
-    }
-  }
-  
-  
-
-  @Test
-  public void testDistributed() throws Exception
-  {
-    UpdateRequest up = new UpdateRequest();
-    up.setAction(ACTION.COMMIT, true, true);
-    up.deleteByQuery("*:*");
-    up.process(getSolrCore0());
-    up.process(getSolrCore1());
-    up.clear();
-    
-    // Add something to each core
-    SolrInputDocument doc = new SolrInputDocument();
-    // Add to core0
-    doc.setField( "id", "core0" );
-    up.add( doc );
-    up.process( getSolrCore0() );
-    up.clear();
-
-    // Add to core1
-    doc.setField( "id", "core1" );
-    up.add( doc );
-    up.process( getSolrCore1() );
-    up.clear();
-    
-    SolrQuery q = new SolrQuery();
-    QueryRequest r = new QueryRequest( q );
-    q.setQuery( "*:*" );
-    assertEquals( 1, r.process( getSolrCore0() ).getResults().size() );
-    assertEquals( 1, r.process( getSolrCore1() ).getResults().size() );
-    
-    // Distributed
-    String baseURL = buildUrl(port, context) + "/";
-    q = new SolrQuery( "*:*" );
-    q.set( ShardParams.SHARDS, baseURL+"core0,"+baseURL+"core1" );
-    q.set( "fl", "id,s:[shard]" );
-    r = new QueryRequest( q );
-    SolrDocumentList docs = r.process( getSolrCore0() ).getResults();
-    assertEquals( 2, docs.size() );
-    for( SolrDocument d : docs ) {
-      String id = (String)d.get("id");
-      String shard = (String)d.get("s");
-      assertEquals(baseURL+id, shard); // The shard ends with the core name
-    }
-  }
-}
diff --git a/solr/test-framework/src/java/org/apache/solr/util/ExternalPaths.java b/solr/test-framework/src/java/org/apache/solr/util/ExternalPaths.java
index a457fdf..1f826c6 100644
--- a/solr/test-framework/src/java/org/apache/solr/util/ExternalPaths.java
+++ b/solr/test-framework/src/java/org/apache/solr/util/ExternalPaths.java
@@ -51,9 +51,6 @@ public class ExternalPaths {
   public static String TECHPRODUCTS_CONFIGSET =
       new File(SOURCE_HOME, "server/solr/configsets/sample_techproducts_configs/conf").getAbsolutePath();
 
-  /* @see #SOURCE_HOME */
-  public static String EXAMPLE_MULTICORE_HOME = new File(SOURCE_HOME, "example/multicore").getAbsolutePath();
-
   public static String SERVER_HOME = new File(SOURCE_HOME, "server/solr").getAbsolutePath();
 
   /**

