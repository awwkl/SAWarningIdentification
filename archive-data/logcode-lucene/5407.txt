GitDiffStart: 524b90ef274047ac9e558092dc39e71dceaba3de | Fri Sep 12 23:02:11 2014 +0000
diff --git a/.gitignore b/.gitignore
index 8a07256..03a42f4 100644
--- a/.gitignore
+++ b/.gitignore
@@ -10,7 +10,9 @@
 /velocity.log
 /build.properties
 /.idea
-**/*.iml
+lucene/**/*.iml
+solr/**/*.iml
+parent.iml
 **/*.ipr
 **/*.iws
 /.project
diff --git a/dev-tools/idea/.idea/modules.xml b/dev-tools/idea/.idea/modules.xml
index f966e7f..762e885 100644
--- a/dev-tools/idea/.idea/modules.xml
+++ b/dev-tools/idea/.idea/modules.xml
@@ -4,60 +4,58 @@
     <modules>
       <module filepath="$PROJECT_DIR$/parent.iml" />
 
-      <module filepath="$PROJECT_DIR$/lucene/core/src/java/lucene-core.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/core/src/resources/lucene-core-resources.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/core/src/test/lucene-core-tests.iml" />
+      <module group="Lucene/Core" filepath="$PROJECT_DIR$/lucene/core/src/lucene-core.iml" />
+      <module group="Lucene/Core" filepath="$PROJECT_DIR$/lucene/core/src/test/lucene-core-tests.iml" />
+      <module group="Lucene/Core" filepath="$PROJECT_DIR$/lucene/backward-codecs/backward-codecs.iml" />
+      <module group="Lucene/Core" filepath="$PROJECT_DIR$/lucene/codecs/src/codecs.iml" />
+      <module group="Lucene/Core" filepath="$PROJECT_DIR$/lucene/codecs/src/test/codecs-tests.iml" />
+      <module group="Lucene/Core" filepath="$PROJECT_DIR$/lucene/test-framework/lucene-test-framework.iml" />
 
-      <module filepath="$PROJECT_DIR$/lucene/analysis/common/analysis-common.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/icu/icu.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/kuromoji/kuromoji.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/morfologik/morfologik.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/phonetic/phonetic.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/smartcn/smartcn.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/stempel/stempel.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/analysis/uima/analysis-uima.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/benchmark/src/benchmark.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/benchmark/conf/benchmark-conf.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/classification/classification.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/codecs/src/java/codecs.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/codecs/src/test/codecs-tests.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/codecs/src/resources/codecs-resources.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/demo/demo.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/expressions/expressions.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/facet/facet.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/grouping/grouping.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/highlighter/highlighter.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/join/join.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/memory/memory.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/misc/misc.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/queries/queries.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/queryparser/queryparser.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/replicator/replicator.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/sandbox/sandbox.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/spatial/spatial.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/suggest/suggest.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/test-framework/lucene-test-framework.iml" />
-      <module filepath="$PROJECT_DIR$/lucene/tools/tools.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/common/analysis-common.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/icu/icu.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/kuromoji/kuromoji.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/morfologik/morfologik.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/phonetic/phonetic.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/smartcn/smartcn.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/stempel/stempel.iml" />
+      <module group="Lucene/Analysis" filepath="$PROJECT_DIR$/lucene/analysis/uima/analysis-uima.iml" />
 
-      <module filepath="$PROJECT_DIR$/solr/core/src/java/solr-core.iml" />
-      <module filepath="$PROJECT_DIR$/solr/core/src/test/solr-core-tests.iml" />
-      <module filepath="$PROJECT_DIR$/solr/core/src/test-files/solr-core-test-files.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/benchmark/src/benchmark.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/benchmark/conf/benchmark-conf.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/classification/classification.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/demo/demo.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/expressions/expressions.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/facet/facet.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/grouping/grouping.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/highlighter/highlighter.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/join/join.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/memory/memory.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/misc/misc.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/queries/queries.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/queryparser/queryparser.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/replicator/replicator.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/sandbox/sandbox.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/spatial/spatial.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/suggest/suggest.iml" />
+      <module group="Lucene/Other" filepath="$PROJECT_DIR$/lucene/tools/tools.iml" />
 
-      <module filepath="$PROJECT_DIR$/solr/contrib/analysis-extras/analysis-extras.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/clustering/clustering.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/dataimporthandler-extras/dataimporthandler-extras.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/dataimporthandler/dataimporthandler.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/extraction/extraction.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/langid/langid.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/morphlines-cell/morphlines-cell.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/morphlines-core/morphlines-core.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/map-reduce/map-reduce.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/uima/uima.iml" />
-      <module filepath="$PROJECT_DIR$/solr/contrib/velocity/velocity.iml" />
-      <module filepath="$PROJECT_DIR$/solr/solrj/src/java/solrj.iml" />
-      <module filepath="$PROJECT_DIR$/solr/solrj/src/test/solrj-tests.iml" />
-      <module filepath="$PROJECT_DIR$/solr/solrj/src/test-files/solrj-test-files.iml" />
-      <module filepath="$PROJECT_DIR$/solr/test-framework/solr-test-framework.iml" />
+      <module group="Solr" filepath="$PROJECT_DIR$/solr/core/src/java/solr-core.iml" />
+      <module group="Solr" filepath="$PROJECT_DIR$/solr/core/src/solr-core-tests.iml" />
+      <module group="Solr" filepath="$PROJECT_DIR$/solr/solrj/src/java/solrj.iml" />
+      <module group="Solr" filepath="$PROJECT_DIR$/solr/solrj/src/solrj-tests.iml" />
+      <module group="Solr" filepath="$PROJECT_DIR$/solr/test-framework/solr-test-framework.iml" />
+
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/analysis-extras/analysis-extras.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/clustering/clustering.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/dataimporthandler-extras/dataimporthandler-extras.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/dataimporthandler/dataimporthandler.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/extraction/extraction.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/langid/langid.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/map-reduce/map-reduce.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/morphlines-cell/morphlines-cell.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/morphlines-core/morphlines-core.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/uima/uima.iml" />
+      <module group="Solr/Contrib" filepath="$PROJECT_DIR$/solr/contrib/velocity/velocity.iml" />
     </modules>
   </component>
 </project>
diff --git a/dev-tools/idea/.idea/workspace.xml b/dev-tools/idea/.idea/workspace.xml
index b7e529d..4510770 100644
--- a/dev-tools/idea/.idea/workspace.xml
+++ b/dev-tools/idea/.idea/workspace.xml
@@ -6,271 +6,317 @@
     </configuration>
     <configuration default="false" name="Lucene core" type="JUnit" factoryName="JUnit">
       <module name="lucene-core-tests" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/core" />
       <option name="VM_PARAMETERS" value="-Xmx256m -ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-common" type="JUnit" factoryName="JUnit">
       <module name="analysis-common" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/common" />
       <option name="VM_PARAMETERS" value="-Xmx256m -ea  -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-icu" type="JUnit" factoryName="JUnit">
       <module name="icu" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/icu" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-kuromoji" type="JUnit" factoryName="JUnit">
       <module name="kuromoji" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/kuromoji" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-morfologik" type="JUnit" factoryName="JUnit">
       <module name="morfologik" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/morfologik" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-phonetic" type="JUnit" factoryName="JUnit">
       <module name="phonetic" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/phonetic" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-smartcn" type="JUnit" factoryName="JUnit">
       <module name="smartcn" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/smartcn" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-stempel" type="JUnit" factoryName="JUnit">
       <module name="stempel" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/stempel" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module analyzers-uima" type="JUnit" factoryName="JUnit">
       <module name="analysis-uima" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/analysis/uima" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
+    </configuration>
+    <configuration default="false" name="Module backward-codecs" type="JUnit" factoryName="JUnit">
+      <module name="backward-codecs" />
+      <option name="TEST_OBJECT" value="pattern" />
+      <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/backward-codecs" />
+      <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
+      <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module benchmark" type="JUnit" factoryName="JUnit">
       <module name="benchmark" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/benchmark" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module classification" type="JUnit" factoryName="JUnit">
       <module name="classification" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/classification" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module codecs" type="JUnit" factoryName="JUnit">
       <module name="codecs-tests" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/codecs" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module expressions" type="JUnit" factoryName="JUnit">
       <module name="expressions" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/expressions" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module facet" type="JUnit" factoryName="JUnit">
       <module name="facet" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/facet" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module grouping" type="JUnit" factoryName="JUnit">
       <module name="grouping" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/grouping" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module highlighter" type="JUnit" factoryName="JUnit">
       <module name="highlighter" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/highlighter" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module join" type="JUnit" factoryName="JUnit">
       <module name="join" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/join" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module memory" type="JUnit" factoryName="JUnit">
       <module name="memory" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/memory" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module misc" type="JUnit" factoryName="JUnit">
       <module name="misc" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/misc" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module queries" type="JUnit" factoryName="JUnit">
       <module name="queries" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/queries" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module queryparser" type="JUnit" factoryName="JUnit">
       <module name="queryparser" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/queries" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module replicator" type="JUnit" factoryName="JUnit">
       <module name="replicator" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/replicator" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module sandbox" type="JUnit" factoryName="JUnit">
       <module name="sandbox" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/sandbox" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module spatial" type="JUnit" factoryName="JUnit">
       <module name="spatial" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/spatial" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Module suggest" type="JUnit" factoryName="JUnit">
       <module name="suggest" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/lucene/suggest" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr core" type="JUnit" factoryName="JUnit">
       <module name="solr-core-tests" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/solr-core" />
-      <option name="VM_PARAMETERS" value="-ea -Dtests.luceneMatchVersion=@version.base@ -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
+      <option name="VM_PARAMETERS" value="-Xmx512m -XX:MaxPermSize=256m -ea -Dtests.luceneMatchVersion=@version.base@ -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solrj" type="JUnit" factoryName="JUnit">
       <module name="solrj-tests" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/solr-solrj" />
       <option name="VM_PARAMETERS" value="-ea -Dtests.luceneMatchVersion=@version.base@ -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr analysis-extras contrib" type="JUnit" factoryName="JUnit">
       <module name="analysis-extras" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-analysis-extras" />
       <option name="VM_PARAMETERS" value="-ea -Dtests.luceneMatchVersion=@version.base@ -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr clustering contrib" type="JUnit" factoryName="JUnit">
       <module name="clustering" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-clustering" />
       <option name="VM_PARAMETERS" value="-ea -Dtests.luceneMatchVersion=@version.base@ -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr dataimporthandler contrib" type="JUnit" factoryName="JUnit">
       <module name="dataimporthandler" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-dataimporthandler" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr dataimporthandler-extras contrib" type="JUnit" factoryName="JUnit">
       <module name="dataimporthandler-extras" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-dataimporthandler-extras" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr extraction contrib" type="JUnit" factoryName="JUnit">
       <module name="extraction" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-cell" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr langid contrib" type="JUnit" factoryName="JUnit">
       <module name="langid" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-langid" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
+    </configuration>
+    <configuration default="false" name="Solr map-reduce contrib" type="JUnit" factoryName="JUnit">
+      <module name="map-reduce" />
+      <option name="TEST_OBJECT" value="pattern" />
+      <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/map-reduce" />
+      <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
+      <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr morphlines-cell contrib" type="JUnit" factoryName="JUnit">
       <module name="morphlines-cell" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/morphlines-cell" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr morphlines-core contrib" type="JUnit" factoryName="JUnit">
       <module name="morphlines-core" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/morphlines-core" />
       <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
-    </configuration>
-    <configuration default="false" name="Solr mr (map-reduce) contrib" type="JUnit" factoryName="JUnit">
-      <module name="map-reduce" />
-      <option name="TEST_OBJECT" value="package" />
-      <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/map-reduce" />
-      <option name="VM_PARAMETERS" value="-ea -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
-      <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr uima contrib" type="JUnit" factoryName="JUnit">
       <module name="uima" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-uima" />
       <option name="VM_PARAMETERS" value="-ea -Dtests.luceneMatchVersion=@version.base@ -DtempDir=temp -Djetty.testMode=1 -Djetty.insecurerandom=1 -Dsolr.directoryFactory=org.apache.solr.core.MockDirectoryFactory" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
     <configuration default="false" name="Solr velocity contrib" type="JUnit" factoryName="JUnit">
       <module name="velocity" />
-      <option name="TEST_OBJECT" value="package" />
+      <option name="TEST_OBJECT" value="pattern" />
       <option name="WORKING_DIRECTORY" value="file://$PROJECT_DIR$/idea-build/solr/contrib/solr-velocity" />
       <option name="VM_PARAMETERS" value="-ea" />
       <option name="TEST_SEARCH_SCOPE"><value defaultName="singleModule" /></option>
+      <patterns><pattern testClass=".*\.Test[^.]*|.*\.[^.]*Test" /></patterns>
     </configuration>
-    <list size="38">
+    <list size="39">
       <item index="0" class="java.lang.String" itemvalue="JUnit.Lucene core" />
       <item index="1" class="java.lang.String" itemvalue="JUnit.Module analyzers-common" />
       <item index="2" class="java.lang.String" itemvalue="JUnit.Module analyzers-icu" />
@@ -280,35 +326,36 @@
       <item index="6" class="java.lang.String" itemvalue="JUnit.Module analyzers-smartcn" />
       <item index="7" class="java.lang.String" itemvalue="JUnit.Module analyzers-stempel" />
       <item index="8" class="java.lang.String" itemvalue="JUnit.Module analyzers-uima" />
-      <item index="9" class="java.lang.String" itemvalue="JUnit.Module benchmark" />
-      <item index="10" class="java.lang.String" itemvalue="JUnit.Module classification" />
-      <item index="11" class="java.lang.String" itemvalue="JUnit.Module codecs" />
-      <item index="12" class="java.lang.String" itemvalue="JUnit.Module expressions" />
-      <item index="13" class="java.lang.String" itemvalue="JUnit.Module facet" />
-      <item index="14" class="java.lang.String" itemvalue="JUnit.Module grouping" />
-      <item index="15" class="java.lang.String" itemvalue="JUnit.Module highlighter" />
-      <item index="16" class="java.lang.String" itemvalue="JUnit.Module join" />
-      <item index="17" class="java.lang.String" itemvalue="JUnit.Module memory" />
-      <item index="18" class="java.lang.String" itemvalue="JUnit.Module misc" />
-      <item index="19" class="java.lang.String" itemvalue="JUnit.Module queries" />
-      <item index="20" class="java.lang.String" itemvalue="JUnit.Module queryparser" />
-      <item index="21" class="java.lang.String" itemvalue="JUnit.Module replicator" />
-      <item index="22" class="java.lang.String" itemvalue="JUnit.Module sandbox" />
-      <item index="23" class="java.lang.String" itemvalue="JUnit.Module spatial" />
-      <item index="24" class="java.lang.String" itemvalue="JUnit.Module suggest" />
-      <item index="25" class="java.lang.String" itemvalue="JUnit.Solr core" />
-      <item index="26" class="java.lang.String" itemvalue="JUnit.Solr analysis-extras contrib" />
-      <item index="27" class="java.lang.String" itemvalue="JUnit.Solr clustering contrib" />
-      <item index="28" class="java.lang.String" itemvalue="JUnit.Solr dataimporthandler contrib" />
-      <item index="29" class="java.lang.String" itemvalue="JUnit.Solr dataimporthandler-extras contrib" />
-      <item index="30" class="java.lang.String" itemvalue="JUnit.Solr extraction contrib" />
-      <item index="31" class="java.lang.String" itemvalue="JUnit.Solr morphlines-cell contrib" />
-      <item index="32" class="java.lang.String" itemvalue="JUnit.Solr morphlines-core contrib" />
-      <item index="33" class="java.lang.String" itemvalue="JUnit.Solr mr (map-reduce) contrib" />
-      <item index="34" class="java.lang.String" itemvalue="JUnit.Solr langid contrib" />
-      <item index="35" class="java.lang.String" itemvalue="JUnit.Solr uima contrib" />
-      <item index="36" class="java.lang.String" itemvalue="JUnit.Solr velocity contrib" />
-      <item index="37" class="java.lang.String" itemvalue="JUnit.Solrj" />
+      <item index="9" class="java.lang.String" itemvalue="JUnit.Module backward-codecs" />
+      <item index="10" class="java.lang.String" itemvalue="JUnit.Module benchmark" />
+      <item index="11" class="java.lang.String" itemvalue="JUnit.Module classification" />
+      <item index="12" class="java.lang.String" itemvalue="JUnit.Module codecs" />
+      <item index="13" class="java.lang.String" itemvalue="JUnit.Module expressions" />
+      <item index="14" class="java.lang.String" itemvalue="JUnit.Module facet" />
+      <item index="15" class="java.lang.String" itemvalue="JUnit.Module grouping" />
+      <item index="16" class="java.lang.String" itemvalue="JUnit.Module highlighter" />
+      <item index="17" class="java.lang.String" itemvalue="JUnit.Module join" />
+      <item index="18" class="java.lang.String" itemvalue="JUnit.Module memory" />
+      <item index="19" class="java.lang.String" itemvalue="JUnit.Module misc" />
+      <item index="20" class="java.lang.String" itemvalue="JUnit.Module queries" />
+      <item index="21" class="java.lang.String" itemvalue="JUnit.Module queryparser" />
+      <item index="22" class="java.lang.String" itemvalue="JUnit.Module replicator" />
+      <item index="23" class="java.lang.String" itemvalue="JUnit.Module sandbox" />
+      <item index="24" class="java.lang.String" itemvalue="JUnit.Module spatial" />
+      <item index="25" class="java.lang.String" itemvalue="JUnit.Module suggest" />
+      <item index="26" class="java.lang.String" itemvalue="JUnit.Solr core" />
+      <item index="27" class="java.lang.String" itemvalue="JUnit.Solr analysis-extras contrib" />
+      <item index="28" class="java.lang.String" itemvalue="JUnit.Solr clustering contrib" />
+      <item index="29" class="java.lang.String" itemvalue="JUnit.Solr dataimporthandler contrib" />
+      <item index="30" class="java.lang.String" itemvalue="JUnit.Solr dataimporthandler-extras contrib" />
+      <item index="31" class="java.lang.String" itemvalue="JUnit.Solr extraction contrib" />
+      <item index="32" class="java.lang.String" itemvalue="JUnit.Solr map-reduce contrib" />
+      <item index="33" class="java.lang.String" itemvalue="JUnit.Solr morphlines-cell contrib" />
+      <item index="34" class="java.lang.String" itemvalue="JUnit.Solr morphlines-core contrib" />
+      <item index="35" class="java.lang.String" itemvalue="JUnit.Solr langid contrib" />
+      <item index="36" class="java.lang.String" itemvalue="JUnit.Solr uima contrib" />
+      <item index="37" class="java.lang.String" itemvalue="JUnit.Solr velocity contrib" />
+      <item index="38" class="java.lang.String" itemvalue="JUnit.Solrj" />
     </list>
   </component>
 </project>
diff --git a/dev-tools/idea/lucene/analysis/common/analysis-common.iml b/dev-tools/idea/lucene/analysis/common/analysis-common.iml
index f0ecc2e..a98ab53 100644
--- a/dev-tools/idea/lucene/analysis/common/analysis-common.iml
+++ b/dev-tools/idea/lucene/analysis/common/analysis-common.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/tools/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
diff --git a/dev-tools/idea/lucene/analysis/icu/icu.iml b/dev-tools/idea/lucene/analysis/icu/icu.iml
index fc3e6a0..d9235b6 100644
--- a/dev-tools/idea/lucene/analysis/icu/icu.iml
+++ b/dev-tools/idea/lucene/analysis/icu/icu.iml
@@ -8,8 +8,8 @@
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/tools/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/lucene/analysis/kuromoji/kuromoji.iml b/dev-tools/idea/lucene/analysis/kuromoji/kuromoji.iml
index b35b1b3..67489d8 100644
--- a/dev-tools/idea/lucene/analysis/kuromoji/kuromoji.iml
+++ b/dev-tools/idea/lucene/analysis/kuromoji/kuromoji.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
       <sourceFolder url="file://$MODULE_DIR$/src/tools/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/tools/test" isTestSource="true" />
diff --git a/dev-tools/idea/lucene/analysis/morfologik/morfologik.iml b/dev-tools/idea/lucene/analysis/morfologik/morfologik.iml
index eafb7f1..2896c8f 100644
--- a/dev-tools/idea/lucene/analysis/morfologik/morfologik.iml
+++ b/dev-tools/idea/lucene/analysis/morfologik/morfologik.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/lucene/analysis/phonetic/phonetic.iml b/dev-tools/idea/lucene/analysis/phonetic/phonetic.iml
index 88c904b..7133534 100644
--- a/dev-tools/idea/lucene/analysis/phonetic/phonetic.iml
+++ b/dev-tools/idea/lucene/analysis/phonetic/phonetic.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/lucene/analysis/smartcn/smartcn.iml b/dev-tools/idea/lucene/analysis/smartcn/smartcn.iml
index 209db00..bc63d96 100644
--- a/dev-tools/idea/lucene/analysis/smartcn/smartcn.iml
+++ b/dev-tools/idea/lucene/analysis/smartcn/smartcn.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/lucene/analysis/stempel/stempel.iml b/dev-tools/idea/lucene/analysis/stempel/stempel.iml
index b3e1668..ca0176e 100644
--- a/dev-tools/idea/lucene/analysis/stempel/stempel.iml
+++ b/dev-tools/idea/lucene/analysis/stempel/stempel.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/lucene/analysis/uima/analysis-uima.iml b/dev-tools/idea/lucene/analysis/uima/analysis-uima.iml
index efea33b..f80ea7b 100644
--- a/dev-tools/idea/lucene/analysis/uima/analysis-uima.iml
+++ b/dev-tools/idea/lucene/analysis/uima/analysis-uima.iml
@@ -6,9 +6,9 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/lucene/backward-codecs/backward-codecs.iml b/dev-tools/idea/lucene/backward-codecs/backward-codecs.iml
new file mode 100644
index 0000000..044f079
--- /dev/null
+++ b/dev-tools/idea/lucene/backward-codecs/backward-codecs.iml
@@ -0,0 +1,18 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="false">
+    <output url="file://$MODULE_DIR$/../../idea-build/lucene/backward-codecs/classes/java" />
+    <output-test url="file://$MODULE_DIR$/../../idea-build/lucene/backward-codecs/classes/test" />
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+    <orderEntry type="module" module-name="lucene-core" />
+    <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
+    <orderEntry type="module" scope="TEST" module-name="lucene-test-framework" />
+  </component>
+</module>
diff --git a/dev-tools/idea/lucene/codecs/src/codecs.iml b/dev-tools/idea/lucene/codecs/src/codecs.iml
new file mode 100644
index 0000000..76da54d
--- /dev/null
+++ b/dev-tools/idea/lucene/codecs/src/codecs.iml
@@ -0,0 +1,14 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="false">
+    <output url="file://$MODULE_DIR$/../../../idea-build/lucene/codecs/classes/java" />
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/java" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/resources" type="java-resource" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+    <orderEntry type="module" module-name="lucene-core" />
+  </component>
+</module>
diff --git a/dev-tools/idea/lucene/codecs/src/java/codecs.iml b/dev-tools/idea/lucene/codecs/src/java/codecs.iml
deleted file mode 100644
index ac8a2d7..0000000
--- a/dev-tools/idea/lucene/codecs/src/java/codecs.iml
+++ /dev/null
@@ -1,15 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/lucene/codecs/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/lucene/codecs/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="false" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-    <orderEntry type="module" module-name="codecs-resources" />
-    <orderEntry type="module" module-name="lucene-core" />
-  </component>
-</module>
diff --git a/dev-tools/idea/lucene/codecs/src/resources/codecs-resources.iml b/dev-tools/idea/lucene/codecs/src/resources/codecs-resources.iml
deleted file mode 100644
index 5fc6576..0000000
--- a/dev-tools/idea/lucene/codecs/src/resources/codecs-resources.iml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/lucene/codecs/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/lucene/codecs/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="false" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-  </component>
-</module>
diff --git a/dev-tools/idea/lucene/codecs/src/test/codecs-tests.iml b/dev-tools/idea/lucene/codecs/src/test/codecs-tests.iml
index ea7a02e..0b30e1b 100755
--- a/dev-tools/idea/lucene/codecs/src/test/codecs-tests.iml
+++ b/dev-tools/idea/lucene/codecs/src/test/codecs-tests.iml
@@ -1,7 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <module type="JAVA_MODULE" version="4">
   <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/lucene/codecs/classes/java" />
     <output-test url="file://$MODULE_DIR$/../../../../idea-build/lucene/codecs/classes/test" />
     <exclude-output />
     <content url="file://$MODULE_DIR$">
diff --git a/dev-tools/idea/lucene/core/src/java/lucene-core.iml b/dev-tools/idea/lucene/core/src/java/lucene-core.iml
deleted file mode 100644
index cd38d5b..0000000
--- a/dev-tools/idea/lucene/core/src/java/lucene-core.iml
+++ /dev/null
@@ -1,15 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/lucene/core/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/lucene/core/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="false" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-    <orderEntry type="module" module-name="lucene-core-resources" />
-  </component>
-</module>
-
diff --git a/dev-tools/idea/lucene/core/src/lucene-core.iml b/dev-tools/idea/lucene/core/src/lucene-core.iml
new file mode 100644
index 0000000..f57e2c3
--- /dev/null
+++ b/dev-tools/idea/lucene/core/src/lucene-core.iml
@@ -0,0 +1,14 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="false">
+    <output url="file://$MODULE_DIR$/../../../idea-build/lucene/core/classes/java" />
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/java" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/resources" type="java-resource" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+  </component>
+</module>
+
diff --git a/dev-tools/idea/lucene/core/src/resources/lucene-core-resources.iml b/dev-tools/idea/lucene/core/src/resources/lucene-core-resources.iml
deleted file mode 100644
index 7807b0c..0000000
--- a/dev-tools/idea/lucene/core/src/resources/lucene-core-resources.iml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/lucene/core/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/lucene/core/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="false" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-  </component>
-</module>
diff --git a/dev-tools/idea/lucene/core/src/test/lucene-core-tests.iml b/dev-tools/idea/lucene/core/src/test/lucene-core-tests.iml
index ce5e38d..d375b2c 100644
--- a/dev-tools/idea/lucene/core/src/test/lucene-core-tests.iml
+++ b/dev-tools/idea/lucene/core/src/test/lucene-core-tests.iml
@@ -1,7 +1,6 @@
 <?xml version="1.0" encoding="UTF-8"?>
 <module type="JAVA_MODULE" version="4">
   <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/lucene/core/classes/java" />
     <output-test url="file://$MODULE_DIR$/../../../../idea-build/lucene/core/classes/test" />
     <exclude-output />
     <content url="file://$MODULE_DIR$">
diff --git a/dev-tools/idea/lucene/demo/demo.iml b/dev-tools/idea/lucene/demo/demo.iml
index a200e9f..80997f4 100644
--- a/dev-tools/idea/lucene/demo/demo.iml
+++ b/dev-tools/idea/lucene/demo/demo.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/lucene/expressions/expressions.iml b/dev-tools/idea/lucene/expressions/expressions.iml
index 7d9e4f0..805db2d 100644
--- a/dev-tools/idea/lucene/expressions/expressions.iml
+++ b/dev-tools/idea/lucene/expressions/expressions.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/lucene/facet/facet.iml b/dev-tools/idea/lucene/facet/facet.iml
index 02cbf8f..91b8f91 100644
--- a/dev-tools/idea/lucene/facet/facet.iml
+++ b/dev-tools/idea/lucene/facet/facet.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
       <excludeFolder url="file://$MODULE_DIR$/work" />
     </content>
diff --git a/dev-tools/idea/lucene/queryparser/queryparser.iml b/dev-tools/idea/lucene/queryparser/queryparser.iml
index 9a6db5d..cd2915f 100644
--- a/dev-tools/idea/lucene/queryparser/queryparser.iml
+++ b/dev-tools/idea/lucene/queryparser/queryparser.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
       <excludeFolder url="file://$MODULE_DIR$/work" />
     </content>
diff --git a/dev-tools/idea/lucene/sandbox/sandbox.iml b/dev-tools/idea/lucene/sandbox/sandbox.iml
index df5aa56..05caa9f 100644
--- a/dev-tools/idea/lucene/sandbox/sandbox.iml
+++ b/dev-tools/idea/lucene/sandbox/sandbox.iml
@@ -6,6 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/lucene/spatial/spatial.iml b/dev-tools/idea/lucene/spatial/spatial.iml
index 2b96bba..27cfade 100644
--- a/dev-tools/idea/lucene/spatial/spatial.iml
+++ b/dev-tools/idea/lucene/spatial/spatial.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/lucene/test-framework/lucene-test-framework.iml b/dev-tools/idea/lucene/test-framework/lucene-test-framework.iml
index 6943ae3..f46df7d 100644
--- a/dev-tools/idea/lucene/test-framework/lucene-test-framework.iml
+++ b/dev-tools/idea/lucene/test-framework/lucene-test-framework.iml
@@ -5,7 +5,7 @@
     <output-test url="file://$MODULE_DIR$/../../idea-build/lucene/test-framework/classes/test" />
     <exclude-output />
     <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/solr/contrib/analysis-extras/analysis-extras.iml b/dev-tools/idea/solr/contrib/analysis-extras/analysis-extras.iml
index d46b346..e9387b2 100644
--- a/dev-tools/idea/solr/contrib/analysis-extras/analysis-extras.iml
+++ b/dev-tools/idea/solr/contrib/analysis-extras/analysis-extras.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/clustering/clustering.iml b/dev-tools/idea/solr/contrib/clustering/clustering.iml
index 0ba08f0..5fdee48 100644
--- a/dev-tools/idea/solr/contrib/clustering/clustering.iml
+++ b/dev-tools/idea/solr/contrib/clustering/clustering.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/solr/contrib/dataimporthandler-extras/dataimporthandler-extras.iml b/dev-tools/idea/solr/contrib/dataimporthandler-extras/dataimporthandler-extras.iml
index 010d291..c50d5a2 100644
--- a/dev-tools/idea/solr/contrib/dataimporthandler-extras/dataimporthandler-extras.iml
+++ b/dev-tools/idea/solr/contrib/dataimporthandler-extras/dataimporthandler-extras.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/dataimporthandler/dataimporthandler.iml b/dev-tools/idea/solr/contrib/dataimporthandler/dataimporthandler.iml
index a40d602..433f679 100644
--- a/dev-tools/idea/solr/contrib/dataimporthandler/dataimporthandler.iml
+++ b/dev-tools/idea/solr/contrib/dataimporthandler/dataimporthandler.iml
@@ -8,7 +8,7 @@
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/webapp" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/extraction/extraction.iml b/dev-tools/idea/solr/contrib/extraction/extraction.iml
index 2413752..69f6faf 100644
--- a/dev-tools/idea/solr/contrib/extraction/extraction.iml
+++ b/dev-tools/idea/solr/contrib/extraction/extraction.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/solr/contrib/langid/langid.iml b/dev-tools/idea/solr/contrib/langid/langid.iml
index 879ad34..8433865 100644
--- a/dev-tools/idea/solr/contrib/langid/langid.iml
+++ b/dev-tools/idea/solr/contrib/langid/langid.iml
@@ -6,9 +6,9 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/map-reduce/map-reduce.iml b/dev-tools/idea/solr/contrib/map-reduce/map-reduce.iml
index fd2c86d..bceecd5 100644
--- a/dev-tools/idea/solr/contrib/map-reduce/map-reduce.iml
+++ b/dev-tools/idea/solr/contrib/map-reduce/map-reduce.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
@@ -19,6 +19,7 @@
     <orderEntry type="library" name="Solr morphlines cell library" level="project" />
     <orderEntry type="library" scope="TEST" name="Solr morphlines core test library" level="project" />
     <orderEntry type="library" scope="TEST" name="Solr example library" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solr core test library" level="project" />
     <orderEntry type="module" scope="TEST" module-name="lucene-test-framework" />
     <orderEntry type="module" scope="TEST" module-name="solr-test-framework" />
     <orderEntry type="module-library" scope="TEST">
diff --git a/dev-tools/idea/solr/contrib/morphlines-cell/morphlines-cell.iml b/dev-tools/idea/solr/contrib/morphlines-cell/morphlines-cell.iml
index 9407805..c403daf 100644
--- a/dev-tools/idea/solr/contrib/morphlines-cell/morphlines-cell.iml
+++ b/dev-tools/idea/solr/contrib/morphlines-cell/morphlines-cell.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/morphlines-core/morphlines-core.iml b/dev-tools/idea/solr/contrib/morphlines-core/morphlines-core.iml
index f40e51b..15f26f2 100644
--- a/dev-tools/idea/solr/contrib/morphlines-core/morphlines-core.iml
+++ b/dev-tools/idea/solr/contrib/morphlines-core/morphlines-core.iml
@@ -7,7 +7,7 @@
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/uima/uima.iml b/dev-tools/idea/solr/contrib/uima/uima.iml
index be03e9f..ede9dbc 100644
--- a/dev-tools/idea/solr/contrib/uima/uima.iml
+++ b/dev-tools/idea/solr/contrib/uima/uima.iml
@@ -6,9 +6,9 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/resources" isTestSource="false" />
+      <sourceFolder url="file://$MODULE_DIR$/src/resources" type="java-resource" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />
diff --git a/dev-tools/idea/solr/contrib/velocity/velocity.iml b/dev-tools/idea/solr/contrib/velocity/velocity.iml
index 816601f..1df0255 100644
--- a/dev-tools/idea/solr/contrib/velocity/velocity.iml
+++ b/dev-tools/idea/solr/contrib/velocity/velocity.iml
@@ -6,7 +6,7 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/test" isTestSource="true" />
-      <sourceFolder url="file://$MODULE_DIR$/src/test-files" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/src/test-files" type="java-test-resource" />
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
     </content>
     <orderEntry type="inheritedJdk" />
diff --git a/dev-tools/idea/solr/core/src/java/solr-core.iml b/dev-tools/idea/solr/core/src/java/solr-core.iml
index 1bb7402..391cccc 100644
--- a/dev-tools/idea/solr/core/src/java/solr-core.iml
+++ b/dev-tools/idea/solr/core/src/java/solr-core.iml
@@ -2,7 +2,6 @@
 <module type="JAVA_MODULE" version="4">
   <component name="NewModuleRootManager" inherit-compiler-output="false">
     <output url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-core/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-core/classes/test" />
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$" isTestSource="false" />
diff --git a/dev-tools/idea/solr/core/src/solr-core-tests.iml b/dev-tools/idea/solr/core/src/solr-core-tests.iml
new file mode 100644
index 0000000..eb27c57
--- /dev/null
+++ b/dev-tools/idea/solr/core/src/solr-core-tests.iml
@@ -0,0 +1,35 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="false">
+    <output-test url="file://$MODULE_DIR$/../../../idea-build/solr/solr-core/classes/test" />
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/test" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/test-files" type="java-test-resource" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+    <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solr core library" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solr core test library" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solrj library" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solr example library" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solr test framework library" level="project" />
+    <orderEntry type="library" scope="TEST" name="ICU library" level="project" />
+    <orderEntry type="module" scope="TEST" module-name="lucene-test-framework" />
+    <orderEntry type="module" scope="TEST" module-name="solr-test-framework" />
+    <orderEntry type="module" scope="TEST" module-name="solr-core" />
+    <orderEntry type="module" scope="TEST" module-name="solrj" />
+    <orderEntry type="module" scope="TEST" module-name="lucene-core" />
+    <orderEntry type="module" scope="TEST" module-name="analysis-common" />
+    <orderEntry type="module" scope="TEST" module-name="queryparser" />
+    <orderEntry type="module" scope="TEST" module-name="queries" />
+    <orderEntry type="module" scope="TEST" module-name="suggest" />
+    <orderEntry type="module" scope="TEST" module-name="spatial" />
+    <orderEntry type="module" scope="TEST" module-name="misc" />
+    <orderEntry type="module" scope="TEST" module-name="join" />
+    <orderEntry type="module" scope="TEST" module-name="expressions" />
+    <orderEntry type="module" scope="TEST" module-name="icu" />
+    <orderEntry type="module" scope="TEST" module-name="analysis-extras" />
+  </component>
+</module>
diff --git a/dev-tools/idea/solr/core/src/test-files/solr-core-test-files.iml b/dev-tools/idea/solr/core/src/test-files/solr-core-test-files.iml
deleted file mode 100644
index 759642d..0000000
--- a/dev-tools/idea/solr/core/src/test-files/solr-core-test-files.iml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-core/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-core/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="true" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-  </component>
-</module>
diff --git a/dev-tools/idea/solr/core/src/test/solr-core-tests.iml b/dev-tools/idea/solr/core/src/test/solr-core-tests.iml
deleted file mode 100644
index e94749d..0000000
--- a/dev-tools/idea/solr/core/src/test/solr-core-tests.iml
+++ /dev/null
@@ -1,36 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-core/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-core/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="true" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-    <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solr core library" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solr core test library" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solrj library" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solr example library" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solr test framework library" level="project" />
-    <orderEntry type="library" scope="TEST" name="ICU library" level="project" />
-    <orderEntry type="module" scope="TEST" module-name="lucene-test-framework" />
-    <orderEntry type="module" scope="TEST" module-name="solr-test-framework" />
-    <orderEntry type="module" scope="TEST" module-name="solr-core-test-files" />
-    <orderEntry type="module" scope="TEST" module-name="solr-core" />
-    <orderEntry type="module" scope="TEST" module-name="solrj" />
-    <orderEntry type="module" scope="TEST" module-name="lucene-core" />
-    <orderEntry type="module" scope="TEST" module-name="analysis-common" />
-    <orderEntry type="module" scope="TEST" module-name="queryparser" />
-    <orderEntry type="module" scope="TEST" module-name="queries" />
-    <orderEntry type="module" scope="TEST" module-name="suggest" />
-    <orderEntry type="module" scope="TEST" module-name="spatial" />
-    <orderEntry type="module" scope="TEST" module-name="misc" />
-    <orderEntry type="module" scope="TEST" module-name="join" />
-    <orderEntry type="module" scope="TEST" module-name="expressions" />
-    <orderEntry type="module" scope="TEST" module-name="icu" />
-    <orderEntry type="module" scope="TEST" module-name="analysis-extras" />
-  </component>
-</module>
diff --git a/dev-tools/idea/solr/solrj/src/java/solrj.iml b/dev-tools/idea/solr/solrj/src/java/solrj.iml
index e5e2505..bf81913 100644
--- a/dev-tools/idea/solr/solrj/src/java/solrj.iml
+++ b/dev-tools/idea/solr/solrj/src/java/solrj.iml
@@ -2,7 +2,6 @@
 <module type="JAVA_MODULE" version="4">
   <component name="NewModuleRootManager" inherit-compiler-output="false">
     <output url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-solrj/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-solrj/classes/test" />
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$" isTestSource="false" />
diff --git a/dev-tools/idea/solr/solrj/src/solrj-tests.iml b/dev-tools/idea/solr/solrj/src/solrj-tests.iml
new file mode 100644
index 0000000..0bf07a8
--- /dev/null
+++ b/dev-tools/idea/solr/solrj/src/solrj-tests.iml
@@ -0,0 +1,33 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<module type="JAVA_MODULE" version="4">
+  <component name="NewModuleRootManager" inherit-compiler-output="false">
+    <output-test url="file://$MODULE_DIR$/../../../idea-build/solr/solr-solrj/classes/test" />
+    <exclude-output />
+    <content url="file://$MODULE_DIR$">
+      <sourceFolder url="file://$MODULE_DIR$/test" isTestSource="true" />
+      <sourceFolder url="file://$MODULE_DIR$/test-files" type="java-test-resource" />
+    </content>
+    <orderEntry type="inheritedJdk" />
+    <orderEntry type="sourceFolder" forTests="false" />
+    <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solr core library" level="project" />
+    <orderEntry type="library" scope="TEST" name="Solrj library" level="project" />
+    <orderEntry type="module-library" scope="TEST">
+      <library>
+        <CLASSES>
+          <root url="file://$MODULE_DIR$/../test-lib" />
+        </CLASSES>
+        <JAVADOC />
+        <SOURCES />
+        <jarDirectory url="file://$MODULE_DIR$/../test-lib" recursive="false" />
+      </library>
+    </orderEntry>
+    <orderEntry type="library" scope="TEST" name="Solr example library" level="project" />
+    <orderEntry type="module" scope="TEST" module-name="lucene-core" />
+    <orderEntry type="module" scope="TEST" module-name="lucene-test-framework" />
+    <orderEntry type="module" scope="TEST" module-name="solr-test-framework" />
+    <orderEntry type="module" scope="TEST" module-name="solrj" />
+    <orderEntry type="module" scope="TEST" module-name="solr-core" />
+    <orderEntry type="module" scope="TEST" module-name="analysis-common" />
+  </component>
+</module>
diff --git a/dev-tools/idea/solr/solrj/src/test-files/solrj-test-files.iml b/dev-tools/idea/solr/solrj/src/test-files/solrj-test-files.iml
deleted file mode 100644
index 8e16e6b..0000000
--- a/dev-tools/idea/solr/solrj/src/test-files/solrj-test-files.iml
+++ /dev/null
@@ -1,13 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-solrj/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-solrj/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="true" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-  </component>
-</module>
diff --git a/dev-tools/idea/solr/solrj/src/test/solrj-tests.iml b/dev-tools/idea/solr/solrj/src/test/solrj-tests.iml
deleted file mode 100644
index 1240014..0000000
--- a/dev-tools/idea/solr/solrj/src/test/solrj-tests.iml
+++ /dev/null
@@ -1,33 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<module type="JAVA_MODULE" version="4">
-  <component name="NewModuleRootManager" inherit-compiler-output="false">
-    <output url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-solrj/classes/java" />
-    <output-test url="file://$MODULE_DIR$/../../../../idea-build/solr/solr-solrj/classes/test" />
-    <exclude-output />
-    <content url="file://$MODULE_DIR$">
-      <sourceFolder url="file://$MODULE_DIR$" isTestSource="true" />
-    </content>
-    <orderEntry type="inheritedJdk" />
-    <orderEntry type="sourceFolder" forTests="false" />
-    <orderEntry type="library" scope="TEST" name="JUnit" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solr core library" level="project" />
-    <orderEntry type="library" scope="TEST" name="Solrj library" level="project" />
-    <orderEntry type="module-library" scope="TEST">
-      <library>
-        <CLASSES>
-          <root url="file://$MODULE_DIR$/test-lib" />
-        </CLASSES>
-        <JAVADOC />
-        <SOURCES />
-        <jarDirectory url="file://$MODULE_DIR$/test-lib" recursive="false" />
-      </library>
-    </orderEntry>
-    <orderEntry type="library" scope="TEST" name="Solr example library" level="project" />
-    <orderEntry type="module" scope="TEST" module-name="lucene-test-framework" />
-    <orderEntry type="module" scope="TEST" module-name="solr-test-framework" />
-    <orderEntry type="module" scope="TEST" module-name="solrj" />
-    <orderEntry type="module" scope="TEST" module-name="solrj-test-files" />
-    <orderEntry type="module" scope="TEST" module-name="solr-core" />
-    <orderEntry type="module" scope="TEST" module-name="analysis-common" />
-  </component>
-</module>
diff --git a/dev-tools/idea/solr/test-framework/solr-test-framework.iml b/dev-tools/idea/solr/test-framework/solr-test-framework.iml
index 3317e71..2a9c0c5 100644
--- a/dev-tools/idea/solr/test-framework/solr-test-framework.iml
+++ b/dev-tools/idea/solr/test-framework/solr-test-framework.iml
@@ -6,7 +6,6 @@
     <exclude-output />
     <content url="file://$MODULE_DIR$">
       <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
-      <sourceFolder url="file://$MODULE_DIR$/src/java" isTestSource="false" />
     </content>
     <orderEntry type="inheritedJdk" />
     <orderEntry type="sourceFolder" forTests="false" />

