GitDiffStart: 6c05d94c93c2f657637f4431fa8cc058a31fd7a2 | Mon Jan 24 01:58:00 2011 +0000
diff --git a/dev-tools/eclipse/dot.classpath b/dev-tools/eclipse/dot.classpath
index 244d5b4..b3b5c76 100644
--- a/dev-tools/eclipse/dot.classpath
+++ b/dev-tools/eclipse/dot.classpath
@@ -73,6 +73,10 @@
 	<classpathentry kind="src" path="solr/contrib/extraction/src/main/java"/>
 	<classpathentry kind="src" path="solr/contrib/extraction/src/test/java"/>
 	<classpathentry kind="src" path="solr/contrib/extraction/src/test/resources"/>
+	<classpathentry kind="src" path="solr/contrib/uima/src/main/java"/>
+	<classpathentry kind="src" path="solr/contrib/uima/src/main/resources"/>
+	<classpathentry kind="src" path="solr/contrib/uima/src/test/java"/>
+	<classpathentry kind="src" path="solr/contrib/uima/src/test/resources"/>
 	<classpathentry kind="lib" path="lucene/lib/ant-1.7.1.jar"/>
 	<classpathentry kind="lib" path="lucene/lib/ant-junit-1.7.1.jar"/>
 	<classpathentry kind="lib" path="lucene/lib/junit-4.7.jar"/>
@@ -151,6 +155,12 @@
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tika-core-0.8.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/tika-parsers-0.8.jar"/>
 	<classpathentry kind="lib" path="solr/contrib/extraction/lib/xmlbeans-2.3.0.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/uima/lib/commons-digester-2.0.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/uima/lib/uima-an-alchemy.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/uima/lib/uima-an-calais.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/uima/lib/uima-an-tagger.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/uima/lib/uima-an-wst.jar"/>
+	<classpathentry kind="lib" path="solr/contrib/uima/lib/uima-core.jar"/>
 	<classpathentry kind="con" path="org.eclipse.jdt.launching.JRE_CONTAINER"/>
 	<classpathentry kind="output" path="bin"/>
 </classpath>
diff --git a/solr/CHANGES.txt b/solr/CHANGES.txt
index 9b1e42a..4aa8fac 100644
--- a/solr/CHANGES.txt
+++ b/solr/CHANGES.txt
@@ -411,6 +411,9 @@ New Features
 * SOLR-2188: Added "maxTokenLength" argument to the factories for ClassicTokenizer,
   StandardTokenizer, and UAX29URLEmailTokenizer. (Steven Rowe)
 
+* SOLR-2129: Added a Solr module for dynamic metadata extraction/indexing with Apache UIMA.
+  See contrib/uima/README.txt for more information.  (Tommaso Teofili via rmuir)
+
 Optimizations
 ----------------------
 
diff --git a/solr/build.xml b/solr/build.xml
index 4b0f035..cf6c7f6 100644
--- a/solr/build.xml
+++ b/solr/build.xml
@@ -218,6 +218,7 @@
           <packageset dir="contrib/dataimporthandler/src/main/java" />
           <packageset dir="contrib/clustering/src/main/java" />
           <packageset dir="contrib/extraction/src/main/java" />
+          <packageset dir="contrib/uima/src/main/java" />
           <packageset dir="contrib/analysis-extras/src/java" />
           <group title="Core" packages="org.apache.*" />
           <group title="Common" packages="org.apache.solr.common.*" />
@@ -225,6 +226,7 @@
           <group title="contrib: DataImportHandler" packages="org.apache.solr.handler.dataimport*" />
           <group title="contrib: Clustering" packages="org.apache.solr.handler.clustering*" />
           <group title="contrib: Solr Cell" packages="org.apache.solr.handler.extraction*" />
+          <group title="contrib: Solr UIMA" packages="org.apache.solr.uima*" />
         </sources>
       </invoke-javadoc>
     </sequential>
@@ -514,6 +516,7 @@
       <fileset dir="contrib/dataimporthandler/src/main/java" />
       <fileset dir="contrib/clustering/src/main/java" />
       <fileset dir="contrib/extraction/src/main/java" />
+      <fileset dir="contrib/uima/src/main/java" />
       <fileset dir="contrib/analysis-extras/src/java" />
     </clover-setup>
   </target>
@@ -617,6 +620,10 @@
               basedir="contrib/clustering/src" />
     <solr-jar destfile="${dist}/apache-solr-analysis-extras-src-${version}.jar"
               basedir="contrib/analysis-extras/src" />
+    <solr-jar destfile="${dist}/apache-solr-uima-src-${version}.jar"
+              basedir="contrib/uima/src/main/java" >
+       <fileset dir="contrib/uima/src/main/resources" />
+    </solr-jar>
   </target>
 
   <target name="dist-javadoc" description="Creates the Solr javadoc distribution files"
@@ -635,6 +642,8 @@
               basedir="${build.javadoc}/contrib-solr-cell" />
     <solr-jar destfile="${dist}/apache-solr-analysis-extras-docs-${version}.jar"
               basedir="${build.javadoc}/contrib-solr-analysis-extras" />
+    <solr-jar destfile="${dist}/apache-solr-uima-docs-${version}.jar"
+              basedir="${build.javadoc}/contrib-solr-uima" />
   </target>
 
   <!-- Creates the solr jar. -->
@@ -731,7 +740,7 @@
       <tarfileset dir="."
         prefix="${fullnamever}"
         includes="LICENSE.txt NOTICE.txt *.txt *.xml lucene-libs/** lib/** src/** example/** client/** contrib/"
-        excludes="lib/README.committers.txt **/data/ **/logs/* **/classes/ **/*.sh **/bin/ src/scripts/ src/site/build/ **/target/ client/ruby/flare/ client/python contrib/**/build/ **/*.iml **/*.ipr **/*.iws contrib/clustering/example/lib/** contrib/clustering/lib/downloads/** contrib/analysis-extras/lib/**" />
+        excludes="lib/README.committers.txt **/data/ **/logs/* **/classes/ **/*.sh **/bin/ src/scripts/ src/site/build/ **/target/ client/ruby/flare/ client/python contrib/**/build/ **/*.iml **/*.ipr **/*.iws contrib/clustering/example/lib/** contrib/clustering/lib/downloads/** contrib/analysis-extras/lib/** contrib/uima/lib/**" />
       <tarfileset dir="."
         prefix="${fullnamever}"
         includes="src/test-files/solr/lib/classes/empty-file-main-lib.txt" />
@@ -903,6 +912,14 @@
         </artifact-attachments>
       </m2-deploy>
 
+      <m2-deploy pom.xml="contrib/extraction/solr-uima-pom.xml.template"
+                 jar.file="${dist}/apache-solr-uima-${version}.jar">
+        <artifact-attachments>
+          <attach file="${dist}/apache-solr-uima-src-${version}.jar" classifier="sources"/>
+          <attach file="${dist}/apache-solr-uima-docs-${version}.jar" classifier="javadoc"/>
+        </artifact-attachments>
+      </m2-deploy>
+
       <m2-deploy pom.xml="src/pom.xml"
                  jar.file="${dist}/apache-solr-core-${version}.jar">
         <artifact-attachments>
@@ -952,6 +969,8 @@
       <fileset dir="contrib/extraction/src/test/java"/>
       <fileset dir="contrib/analysis-extras/src/test"/>
       <fileset dir="contrib/analysis-extras/src/test"/>
+      <fileset dir="contrib/uima/src/main/java"/>
+      <fileset dir="contrib/uima/src/test/java"/>
     </rat:report>
   </target>
 
diff --git a/solr/contrib/uima/CHANGES.txt b/solr/contrib/uima/CHANGES.txt
new file mode 100644
index 0000000..c0ca1a0
--- /dev/null
+++ b/solr/contrib/uima/CHANGES.txt
@@ -0,0 +1,17 @@
+Apache Solr UIMA Metadata Extraction Library
+                            Release Notes
+
+This file describes changes to the Solr UIMA (contrib/uima) module. See SOLR-2129 for details.
+
+Introduction
+------------
+This module is intended to be used while indexing documents.
+Its purpose is to provide additional on the fly automatically generated fields to the Solr index.
+Such fields could be language, concepts, keywords, sentences, named entities, etc.
+
+ UIMA Dependency
+ ---------------
+uima-core, OpenCalaisAnnotator, WhitespaceTokenizer, HMMTagger, AlchemyAPIAnnotator
+Current Version:  2.3.1-SNAPSHOT rev. 999276
+
+$Id$
diff --git a/solr/contrib/uima/README.txt b/solr/contrib/uima/README.txt
new file mode 100644
index 0000000..b2b9729
--- /dev/null
+++ b/solr/contrib/uima/README.txt
@@ -0,0 +1,60 @@
+Getting Started
+---------------
+To start using Solr UIMA Metadata Extraction Library you should go through the following configuration steps:
+
+1. copy generated solr-uima jar and its libs (under contrib/uima/lib) inside a Solr libraries directory.
+
+2. modify your schema.xml adding the fields you want to be hold metadata specifying proper values for type, indexed, stored and multiValued options:
+
+3. for example you could specify the following
+  <field name="language" type="string" indexed="true" stored="true" required="false"/>
+  <field name="concept" type="string" indexed="true" stored="true" multiValued="true" required="false"/>
+  <field name="sentence" type="text" indexed="true" stored="true" multiValued="true" required="false" />
+
+4. modify your solrconfig.xml adding the following snippet:
+  <uimaConfig>
+    <runtimeParameters>
+      <keyword_apikey>VALID_ALCHEMYAPI_KEY</keyword_apikey>
+      <concept_apikey>VALID_ALCHEMYAPI_KEY</concept_apikey>
+      <lang_apikey>VALID_ALCHEMYAPI_KEY</lang_apikey>
+      <cat_apikey>VALID_ALCHEMYAPI_KEY</cat_apikey>
+      <entities_apikey>VALID_ALCHEMYAPI_KEY</entities_apikey>
+      <oc_licenseID>VALID_OPENCALAIS_KEY</oc_licenseID>
+    </runtimeParameters>
+    <analysisEngine>/org/apache/uima/desc/OverridingParamsExtServicesAE.xml</analysisEngine>
+    <analyzeFields merge="false">text</analyzeFields>
+    <fieldMapping>
+      <type name="org.apache.uima.alchemy.ts.concept.ConceptFS">
+       <map feature="text" field="concept"/>
+      </type>
+      <type name="org.apache.uima.alchemy.ts.language.LanguageFS">
+       <map feature="language" field="language"/>
+      </type>
+      <type name="org.apache.uima.SentenceAnnotation">
+        <map feature="coveredText" field="sentence"/>
+      </type>
+    </fieldMapping>
+  </uimaConfig>
+  
+5. the analysisEngine tag must contain an AE descriptor inside the specified path in the classpath
+
+6. the analyzeFields tag must contain the input fields that need to be analyzed by UIMA,
+   if merge=true then their content will be merged and analyzed only once
+
+7. field mapping describes which features of which types should go in a field
+
+8. define in your solrconfig.xml an UpdateRequestProcessorChain as following:
+  <updateRequestProcessorChain name="uima">
+    <processor class="org.apache.solr.uima.processor.UIMAProcessorFactory"/>
+    <processor class="solr.LogUpdateProcessorFactory" />
+    <processor class="solr.RunUpdateProcessorFactory" />
+  </updateRequestProcessorChain>
+
+9. in your solrconfig.xml replace the existing default (<requestHandler name="/update"...)  or create a new UpdateRequestHandler with the following:
+  <requestHandler name="/update" class="solr.XmlUpdateRequestHandler">
+    <lst name="defaults">
+      <str name="update.processor">uima</str>
+    </lst>
+  </requestHandler>
+
+Once you're done with the configuration you can index documents which will be automatically enriched with the specified fields
diff --git a/solr/contrib/uima/build.xml b/solr/contrib/uima/build.xml
new file mode 100644
index 0000000..34b190b
--- /dev/null
+++ b/solr/contrib/uima/build.xml
@@ -0,0 +1,189 @@
+<?xml version="1.0"?>
+
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+        http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+ -->
+
+<project name="solr-uima" default="build">
+
+  <property name="solr-path" value="../.." />
+
+  <import file="../../common-build.xml"/>
+  
+  <description>
+    Solr Integration with UIMA for extracting metadata from arbitrary (text) fields and enrich document with features extracted from UIMA types (language, sentences, concepts, named entities, etc.)
+  </description>
+
+  <path id="common.classpath">
+    <pathelement location="${solr-path}/build/solr" />
+    <pathelement location="${solr-path}/build/solrj" />
+    <fileset dir="lib" includes="*.jar"/>
+    <fileset dir="${solr-path}/lib" includes="*.jar"/>
+    <path refid="lucene.classpath"/>
+    <pathelement location="${basedir}/src/main/resources" />    
+  </path>
+
+  <path id="test.classpath">
+    <path refid="common.classpath" />
+    <pathelement path="${dest}/classes" />
+    <pathelement path="${dest}/test-classes" />
+    <pathelement location="${solr-path}/build/tests"/> <!-- include solr test code -->
+    <pathelement location="${solr-path}/../lucene/build/classes/test" />  <!-- include some lucene test code -->
+    <pathelement path="${java.class.path}"/>
+  </path>
+
+  <target name="clean">
+    <delete failonerror="false" dir="${dest}"/>
+  </target>
+
+  <target name="init">
+    <mkdir dir="${dest}/classes"/>
+    <mkdir dir="${build.javadoc}" />
+    <subant target="compileTests">
+      <fileset dir="${solr-path}" includes="build.xml"/>
+    </subant>
+    <subant target="make-manifest">
+      <fileset dir="${solr-path}" includes="build.xml"/>
+    </subant>
+  </target>
+
+  <target name="compile" depends="init">
+    <solr-javac destdir="${dest}/classes"
+    classpathref="common.classpath">
+      <src path="src/main/java" />
+    </solr-javac>
+  </target>
+
+  <target name="build" depends="compile">
+    <solr-jar destfile="${dest}/${fullnamever}.jar" basedir="${dest}/classes"
+              manifest="../../${dest}/META-INF/MANIFEST.MF">
+      <fileset dir="src/main/resources" />
+    </solr-jar>
+  </target>
+
+  <target name="compileTests" depends="compile">
+  	<solr-javac destdir="${dest}/test-classes"
+  	                classpathref="test.classpath">
+  	  <src path="src/test/java" />
+  	</solr-javac>
+        <copy todir="${dest}/test-classes">
+          <fileset dir="src/test/resources" excludes="**/*.java"/>
+        </copy>
+  </target>
+
+  <property name="tempDir" value="${junit.output.dir}/temp" />
+
+  <target name="test" depends="compileTests">
+  	<mkdir dir="${junit.output.dir}"/>
+    <!-- <mkdir dir="@{tempDir}/@{pattern}"/> 
+       This is very loud and obnoxious. abuse touch instead for a "quiet" mkdir
+    -->
+  	<touch file="${tempDir}/quiet.ant" verbose="false" mkdirs="true"/>
+
+    <condition property="runall">
+      <not>
+        <or>
+          <isset property="testcase"/>
+          <isset property="testpackage"/>
+          <isset property="testpackageroot"/>
+        </or>
+      </not>
+    </condition>    
+    
+  	<junit printsummary="no"
+           haltonfailure="no"
+           maxmemory="512M"
+           errorProperty="tests.failed"
+           failureProperty="tests.failed"
+           dir="${tempDir}"
+           tempdir="${tempDir}"
+           forkmode="perBatch"
+           >
+      <sysproperty key="java.util.logging.config.file" value="${common-solr.dir}/testlogging.properties"/>
+      <sysproperty key="tests.luceneMatchVersion" value="${tests.luceneMatchVersion}"/>
+      <sysproperty key="tests.codec" value="${tests.codec}"/>
+      <sysproperty key="tests.locale" value="${tests.locale}"/>
+      <sysproperty key="tests.timezone" value="${tests.timezone}"/>
+      <sysproperty key="tests.multiplier" value="${tests.multiplier}"/>
+      <sysproperty key="tests.iter" value="${tests.iter}"/>
+      <sysproperty key="tests.seed" value="${tests.seed}"/>
+      <sysproperty key="jetty.insecurerandom" value="1"/>
+      <sysproperty key="tempDir" file="${tempDir}"/>
+      <sysproperty key="testmethod" value="${testmethod}"/>
+      <jvmarg line="${args}"/>
+      <formatter classname="${junit.details.formatter}" usefile="false" if="junit.details"/>
+      <classpath refid="test.classpath"/>
+      <assertions>
+        <enable package="org.apache.lucene"/>
+        <enable package="org.apache.solr"/>
+      </assertions>
+      <formatter type="${junit.formatter}"/>
+      <batchtest fork="yes" todir="${junit.output.dir}" if="runall">
+        <fileset dir="src/test/java" includes="${junit.includes}"/>
+      </batchtest>
+      <batchtest fork="yes" todir="${junit.output.dir}" if="testcase">
+        <fileset dir="src/test/java" includes="**/${testcase}.java"/>
+      </batchtest>
+      <batchtest fork="yes" todir="${junit.output.dir}" if="testpackage">
+        <fileset dir="src/test/java" includes="**/${testpackage}/**/Test*.java,**/${testpackage}/**/*Test.java"/>
+      </batchtest>
+      <batchtest fork="yes" todir="${junit.output.dir}" if="testpackageroot">
+        <fileset dir="src/test/java" includes="**/${testpackageroot}/Test*.java,**/${testpackageroot}/*Test.java"/>
+      </batchtest>
+    </junit>
+
+    <fail if="tests.failed">Tests failed!</fail>
+  </target>
+
+  <target name="test-reports"
+          description="Generates HTML test reports.">
+    <mkdir dir="${junit.reports}"/>
+    <junitreport todir="${junit.output.dir}">
+      <fileset dir="${junit.output.dir}">
+        <include name="TEST-*.xml"/>
+      </fileset>
+      <report format="frames" todir="${junit.reports}"/>
+    </junitreport>
+  </target>
+
+  <target name="dist" depends="build">
+    <copy file="build/${fullnamever}.jar" todir="${solr-path}/dist"/>
+  </target>
+
+  <target name="example" depends="build">
+    <!-- :NOOP: this use to copy libs but now we can refer to them by path -->
+  </target>
+
+  <target name="javadoc">
+   	<sequential>
+      <mkdir dir="${build.javadoc}/contrib-${name}"/>
+
+      <path id="javadoc.classpath">
+        <path refid="common.classpath"/>
+      </path>
+
+      <invoke-javadoc
+        destdir="${build.javadoc}/contrib-${name}"
+      	title="${Name} ${version} contrib-${fullnamever} API">
+        <sources>
+          <packageset dir="src/main/java"/>
+        </sources>
+      </invoke-javadoc>
+    </sequential>
+  </target>
+
+
+</project>
diff --git a/solr/contrib/uima/lib/commons-digester-2.0.jar b/solr/contrib/uima/lib/commons-digester-2.0.jar
new file mode 100644
index 0000000..bd9b633
--- /dev/null
+++ b/solr/contrib/uima/lib/commons-digester-2.0.jar
@@ -0,0 +1,2 @@
+AnyObjectId[9c8bd13a2002a9ff5b35b873b9f111d5281ad201] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/lib/commons-lang-2.4.jar b/solr/contrib/uima/lib/commons-lang-2.4.jar
new file mode 100644
index 0000000..2ef0c62
--- /dev/null
+++ b/solr/contrib/uima/lib/commons-lang-2.4.jar
@@ -0,0 +1,2 @@
+AnyObjectId[532939ecab6b77ccb77af3635c55ff9752b70ab7] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/lib/uima-an-alchemy.jar b/solr/contrib/uima/lib/uima-an-alchemy.jar
new file mode 100644
index 0000000..5ef7754
--- /dev/null
+++ b/solr/contrib/uima/lib/uima-an-alchemy.jar
@@ -0,0 +1,2 @@
+AnyObjectId[33165678da937e03cb069449b40f1cf690beda0a] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/lib/uima-an-calais.jar b/solr/contrib/uima/lib/uima-an-calais.jar
new file mode 100644
index 0000000..bebd55a
--- /dev/null
+++ b/solr/contrib/uima/lib/uima-an-calais.jar
@@ -0,0 +1,2 @@
+AnyObjectId[5dfc32bce5e444a9bb3387d664485f7bfdc438ad] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/lib/uima-an-tagger.jar b/solr/contrib/uima/lib/uima-an-tagger.jar
new file mode 100644
index 0000000..6e879bd
--- /dev/null
+++ b/solr/contrib/uima/lib/uima-an-tagger.jar
@@ -0,0 +1,2 @@
+AnyObjectId[bf90c19d2c1f77e300b94363385841ec1225b4b9] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/lib/uima-an-wst.jar b/solr/contrib/uima/lib/uima-an-wst.jar
new file mode 100644
index 0000000..d0ce4c4
--- /dev/null
+++ b/solr/contrib/uima/lib/uima-an-wst.jar
@@ -0,0 +1,2 @@
+AnyObjectId[9518da64cdf5d378273ab40a06823a7768f18ece] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/lib/uima-core.jar b/solr/contrib/uima/lib/uima-core.jar
new file mode 100644
index 0000000..37d22bb
--- /dev/null
+++ b/solr/contrib/uima/lib/uima-core.jar
@@ -0,0 +1,2 @@
+AnyObjectId[72991424bdfe4776f66feab7ff4e8564f12d2659] was removed in git history.
+Apache SVN contains full history.
\ No newline at end of file
diff --git a/solr/contrib/uima/solr-uima-pom.xml.template b/solr/contrib/uima/solr-uima-pom.xml.template
new file mode 100644
index 0000000..cff8375
--- /dev/null
+++ b/solr/contrib/uima/solr-uima-pom.xml.template
@@ -0,0 +1,115 @@
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+  <!--
+    Licensed to the Apache Software Foundation (ASF) under one
+    or more contributor license agreements.  See the NOTICE file
+    distributed with this work for additional information
+    regarding copyright ownership.  The ASF licenses this file
+    to you under the Apache License, Version 2.0 (the
+    "License"); you may not use this file except in compliance
+    with the License.  You may obtain a copy of the License at
+
+    http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing,
+    software distributed under the License is distributed on an
+    "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+    KIND, either express or implied.  See the License for the
+    specific language governing permissions and limitations
+    under the License.
+  -->
+  <modelVersion>4.0.0</modelVersion>
+  <groupId>org.apache.solr</groupId>
+  <artifactId>solr-uima</artifactId>
+  <version>0.0.2-SNAPSHOT</version>
+  <name>Solr - UIMA integration</name>
+  <properties>
+    <uimaVersion>2.3.1-SNAPSHOT</uimaVersion>
+  </properties>
+  <dependencies>
+    <dependency>
+      <groupId>org.apache.solr</groupId>
+      <artifactId>solr-core</artifactId>
+      <version>1.4.1</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.uima</groupId>
+      <artifactId>uimaj-core</artifactId>
+      <version>${uimaVersion}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.uima</groupId>
+      <artifactId>alchemy-annotator</artifactId>
+      <version>${uimaVersion}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.uima</groupId>
+      <artifactId>OpenCalaisAnnotator</artifactId>
+      <version>${uimaVersion}</version>
+    </dependency>
+    <dependency>
+      <groupId>junit</groupId>
+      <artifactId>junit</artifactId>
+      <version>4.7</version>
+      <type>jar</type>
+      <scope>test</scope>
+    </dependency>
+    <dependency>
+      <groupId>org.slf4j</groupId>
+      <artifactId>slf4j-simple</artifactId>
+      <version>1.5.5</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.uima</groupId>
+      <artifactId>WhitespaceTokenizer</artifactId>
+      <version>${uimaVersion}</version>
+    </dependency>
+    <dependency>
+      <groupId>org.apache.uima</groupId>
+      <artifactId>Tagger</artifactId>
+      <version>${uimaVersion}</version>
+    </dependency>
+  </dependencies>
+  <build>
+    <pluginManagement>
+      <plugins>
+        <plugin>
+          <groupId>com.googlecode.maven-gcu-plugin</groupId>
+          <artifactId>maven-gcu-plugin</artifactId>
+          <version>1.0</version>
+        </plugin>
+      </plugins>
+    </pluginManagement>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-compiler-plugin</artifactId>
+        <version>2.3.1</version>
+        <configuration>
+          <source>1.5</source>
+          <target>1.5</target>
+        </configuration>
+      </plugin>
+      <plugin>
+        <groupId>com.googlecode.maven-gcu-plugin</groupId>
+        <artifactId>maven-gcu-plugin</artifactId>
+        <version>1.0</version>
+        <configuration>
+          <serverId>googlecode</serverId>
+          <failsOnError>true</failsOnError>
+          <projectName>${project.artifactId}</projectName>
+          <uploads>
+            <upload>
+              <file>${project.build.directory}/${project.artifactId}-${project.version}.${project.packaging}</file>
+              <summary>${project.name} sources bundle ${project.version}</summary>
+              <labels>
+                <label>Featured</label>
+                <label>Type-Archive</label>
+              </labels>
+            </upload>
+          </uploads>
+        </configuration>
+      </plugin>
+    </plugins>
+  </build>
+</project>
\ No newline at end of file
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/SolrUIMAConfiguration.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/SolrUIMAConfiguration.java
new file mode 100644
index 0000000..2ba2d7f
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/SolrUIMAConfiguration.java
@@ -0,0 +1,69 @@
+package org.apache.solr.uima.processor;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.Map;
+
+/**
+ * Configuration holding all the configurable parameters for calling UIMA inside Solr
+ * 
+ * @version $Id$
+ */
+public class SolrUIMAConfiguration {
+
+  private String[] fieldsToAnalyze;
+
+  private boolean fieldsMerging;
+
+  private Map<String, Map<String, String>> typesFeaturesFieldsMapping;
+
+  private String aePath;
+
+  private Map<String, String> runtimeParameters;
+
+  public SolrUIMAConfiguration(String aePath, String[] fieldsToAnalyze, boolean fieldsMerging,
+          Map<String, Map<String, String>> typesFeaturesFieldsMapping,
+          Map<String, String> runtimeParameters) {
+    this.aePath = aePath;
+    this.fieldsToAnalyze = fieldsToAnalyze;
+    this.fieldsMerging = fieldsMerging;
+    this.runtimeParameters = runtimeParameters;
+    this.typesFeaturesFieldsMapping = typesFeaturesFieldsMapping;
+  }
+
+  public String[] getFieldsToAnalyze() {
+    return fieldsToAnalyze;
+  }
+
+  public boolean isFieldsMerging() {
+    return fieldsMerging;
+  }
+
+  public Map<String, Map<String, String>> getTypesFeaturesFieldsMapping() {
+    return typesFeaturesFieldsMapping;
+  }
+
+  public String getAePath() {
+    return aePath;
+  }
+
+  public Map<String, String> getRuntimeParameters() {
+    return runtimeParameters;
+  }
+
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/SolrUIMAConfigurationReader.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/SolrUIMAConfigurationReader.java
new file mode 100644
index 0000000..4ffeb83
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/SolrUIMAConfigurationReader.java
@@ -0,0 +1,125 @@
+package org.apache.solr.uima.processor;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.HashMap;
+import java.util.Map;
+
+import org.apache.solr.core.SolrConfig;
+import org.w3c.dom.Node;
+import org.w3c.dom.NodeList;
+
+/**
+ * Read configuration for Solr-UIMA integration
+ * 
+ * @version $Id$
+ * 
+ */
+public class SolrUIMAConfigurationReader {
+
+  private static final String AE_RUNTIME_PARAMETERS_NODE_PATH = "/config/uimaConfig/runtimeParameters";
+
+  private static final String FIELD_MAPPING_NODE_PATH = "/config/uimaConfig/fieldMapping";
+
+  private static final String ANALYZE_FIELDS_NODE_PATH = "/config/uimaConfig/analyzeFields";
+
+  private static final String ANALYSIS_ENGINE_NODE_PATH = "/config/uimaConfig/analysisEngine";
+
+  private SolrConfig solrConfig;
+
+  public SolrUIMAConfigurationReader(SolrConfig solrConfig) {
+    this.solrConfig = solrConfig;
+  }
+
+  public SolrUIMAConfiguration readSolrUIMAConfiguration() {
+    return new SolrUIMAConfiguration(readAEPath(), readFieldsToAnalyze(), readFieldsMerging(),
+            readTypesFeaturesFieldsMapping(), readAEOverridingParameters());
+  }
+
+  private String readAEPath() {
+    return solrConfig.getNode(ANALYSIS_ENGINE_NODE_PATH, true).getTextContent();
+  }
+
+  private String[] readFieldsToAnalyze() {
+    Node analyzeFieldsNode = solrConfig.getNode(ANALYZE_FIELDS_NODE_PATH, true);
+    return analyzeFieldsNode.getTextContent().split(",");
+  }
+
+  private boolean readFieldsMerging() {
+    Node analyzeFieldsNode = solrConfig.getNode(ANALYZE_FIELDS_NODE_PATH, true);
+    Node mergeNode = analyzeFieldsNode.getAttributes().getNamedItem("merge");
+    return Boolean.valueOf(mergeNode.getNodeValue());
+  }
+
+  private Map<String, Map<String, String>> readTypesFeaturesFieldsMapping() {
+    Map<String, Map<String, String>> map = new HashMap<String, Map<String, String>>();
+
+    Node fieldMappingNode = solrConfig.getNode(FIELD_MAPPING_NODE_PATH, true);
+    /* iterate over UIMA types */
+    if (fieldMappingNode.hasChildNodes()) {
+      NodeList typeNodes = fieldMappingNode.getChildNodes();
+      for (int i = 0; i < typeNodes.getLength(); i++) {
+        /* <type> node */
+        Node typeNode = typeNodes.item(i);
+        if (typeNode.getNodeType() != Node.TEXT_NODE) {
+          Node typeNameAttribute = typeNode.getAttributes().getNamedItem("name");
+          /* get a UIMA typename */
+          String typeName = typeNameAttribute.getNodeValue();
+          /* create entry for UIMA type */
+          map.put(typeName, new HashMap<String, String>());
+          if (typeNode.hasChildNodes()) {
+            /* iterate over features */
+            NodeList featuresNodeList = typeNode.getChildNodes();
+            for (int j = 0; j < featuresNodeList.getLength(); j++) {
+              Node mappingNode = featuresNodeList.item(j);
+              if (mappingNode.getNodeType() != Node.TEXT_NODE) {
+                /* get field name */
+                Node fieldNameNode = mappingNode.getAttributes().getNamedItem("field");
+                String mappedFieldName = fieldNameNode.getNodeValue();
+                /* get feature name */
+                Node featureNameNode = mappingNode.getAttributes().getNamedItem("feature");
+                String featureName = featureNameNode.getNodeValue();
+                /* map the feature to the field for the specified type */
+                map.get(typeName).put(featureName, mappedFieldName);
+              }
+            }
+          }
+        }
+      }
+    }
+    return map;
+  }
+
+  private Map<String, String> readAEOverridingParameters() {
+    Map<String, String> runtimeParameters = new HashMap<String, String>();
+    Node uimaConfigNode = solrConfig.getNode(AE_RUNTIME_PARAMETERS_NODE_PATH, true);
+
+    if (uimaConfigNode.hasChildNodes()) {
+      NodeList overridingNodes = uimaConfigNode.getChildNodes();
+      for (int i = 0; i < overridingNodes.getLength(); i++) {
+        Node overridingNode = overridingNodes.item(i);
+        if (overridingNode.getNodeType() != Node.TEXT_NODE) {
+          runtimeParameters.put(overridingNode.getNodeName(), overridingNode.getTextContent());
+        }
+      }
+    }
+
+    return runtimeParameters;
+  }
+
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAToSolrMapper.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAToSolrMapper.java
new file mode 100644
index 0000000..29e7b5c
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAToSolrMapper.java
@@ -0,0 +1,83 @@
+package org.apache.solr.uima.processor;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.Map;
+
+import org.apache.solr.common.SolrInputDocument;
+import org.apache.uima.cas.FSIterator;
+import org.apache.uima.cas.FeatureStructure;
+import org.apache.uima.cas.Type;
+import org.apache.uima.jcas.JCas;
+import org.apache.uima.jcas.tcas.Annotation;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
+/**
+ * Map UIMA types and features over fields of a Solr document
+ * 
+ * @version $Id$
+ */
+public class UIMAToSolrMapper {
+
+  private final Logger log = LoggerFactory.getLogger(UIMAToSolrMapper.class);
+
+  private SolrInputDocument document;
+
+  private JCas cas;
+
+  public UIMAToSolrMapper(SolrInputDocument document, JCas cas) {
+    this.document = document;
+    this.cas = cas;
+  }
+
+  /**
+   * map features of a certain UIMA type to corresponding Solr fields based on the mapping
+   * 
+   * @param typeName
+   *          name of UIMA type to map
+   * @param featureFieldsmapping
+   */
+  public void map(String typeName, Map<String, String> featureFieldsmapping) {
+    try {
+      FeatureStructure fsMock = (FeatureStructure) Class.forName(typeName).getConstructor(
+              JCas.class).newInstance(cas);
+      Type type = fsMock.getType();
+      for (FSIterator<FeatureStructure> iterator = cas.getFSIndexRepository().getAllIndexedFS(type); iterator
+              .hasNext();) {
+        FeatureStructure fs = iterator.next();
+        for (String featureName : featureFieldsmapping.keySet()) {
+          String fieldName = featureFieldsmapping.get(featureName);
+          log.info(new StringBuffer("mapping ").append(typeName).append("@").append(featureName)
+                  .append(" to ").append(fieldName).toString());
+          String featureValue = null;
+          if (fs instanceof Annotation && "coveredText".equals(featureName)) {
+            featureValue = ((Annotation) fs).getCoveredText();
+          } else {
+            featureValue = fs.getFeatureValueAsString(type.getFeatureByBaseName(featureName));
+          }
+          log.info(new StringBuffer("writing ").append(featureValue).append(" in ").append(
+                  fieldName).toString());
+          document.addField(fieldName, featureValue, 1.0f);
+        }
+      }
+    } catch (Exception e) {
+      log.error(e.getLocalizedMessage());
+    }
+  }
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessor.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessor.java
new file mode 100644
index 0000000..f042f2a
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessor.java
@@ -0,0 +1,126 @@
+package org.apache.solr.uima.processor;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.io.IOException;
+import java.util.Map;
+
+import org.apache.solr.common.SolrInputDocument;
+import org.apache.solr.core.SolrCore;
+import org.apache.solr.uima.processor.ae.AEProvider;
+import org.apache.solr.uima.processor.ae.AEProviderFactory;
+import org.apache.solr.update.AddUpdateCommand;
+import org.apache.solr.update.processor.UpdateRequestProcessor;
+import org.apache.uima.UIMAException;
+import org.apache.uima.analysis_engine.AnalysisEngine;
+import org.apache.uima.analysis_engine.AnalysisEngineProcessException;
+import org.apache.uima.jcas.JCas;
+import org.apache.uima.resource.ResourceInitializationException;
+
+/**
+ * Update document(s) to be indexed with UIMA extracted information
+ * 
+ * @version $Id$
+ */
+public class UIMAUpdateRequestProcessor extends UpdateRequestProcessor {
+
+  private SolrUIMAConfiguration solrUIMAConfiguration;
+
+  private AEProvider aeProvider;
+
+  public UIMAUpdateRequestProcessor(UpdateRequestProcessor next, SolrCore solrCore) {
+    super(next);
+    initialize(solrCore);
+  }
+
+  private void initialize(SolrCore solrCore) {
+    SolrUIMAConfigurationReader uimaConfigurationReader = new SolrUIMAConfigurationReader(solrCore
+            .getSolrConfig());
+    solrUIMAConfiguration = uimaConfigurationReader.readSolrUIMAConfiguration();
+    aeProvider = AEProviderFactory.getInstance().getAEProvider(solrCore.getName(),
+            solrUIMAConfiguration.getAePath(), solrUIMAConfiguration.getRuntimeParameters());
+  }
+
+  public void processAdd(AddUpdateCommand cmd) throws IOException {
+    try {
+      /* get Solr document */
+      SolrInputDocument solrInputDocument = cmd.getSolrInputDocument();
+
+      /* get the fields to analyze */
+      for (String text : getTextsToAnalyze(solrInputDocument)) {
+        if (text != null && !"".equals(text)) {
+          /* process the text value */
+          JCas jcas = processText(text);
+
+          UIMAToSolrMapper uimaToSolrMapper = new UIMAToSolrMapper(solrInputDocument, jcas);
+          /* get field mapping from config */
+          Map<String, Map<String, String>> typesAndFeaturesFieldsMap = solrUIMAConfiguration
+                  .getTypesFeaturesFieldsMapping();
+          /* map type features on fields */
+          for (String typeFQN : typesAndFeaturesFieldsMap.keySet()) {
+            uimaToSolrMapper.map(typeFQN, typesAndFeaturesFieldsMap.get(typeFQN));
+          }
+        }
+      }
+    } catch (UIMAException e) {
+      throw new RuntimeException(e);
+    }
+    super.processAdd(cmd);
+  }
+
+  /*
+   * get the texts to analyze from the corresponding fields
+   */
+  private String[] getTextsToAnalyze(SolrInputDocument solrInputDocument) {
+    String[] fieldsToAnalyze = solrUIMAConfiguration.getFieldsToAnalyze();
+    boolean merge = solrUIMAConfiguration.isFieldsMerging();
+    String[] textVals = null;
+    if (merge) {
+      StringBuilder unifiedText = new StringBuilder("");
+      for (int i = 0; i < fieldsToAnalyze.length; i++) {
+        unifiedText.append(String.valueOf(solrInputDocument.getFieldValue(fieldsToAnalyze[i])));
+      }
+      textVals = new String[1];
+      textVals[0] = unifiedText.toString();
+    } else {
+      textVals = new String[fieldsToAnalyze.length];
+      for (int i = 0; i < fieldsToAnalyze.length; i++) {
+        textVals[i] = String.valueOf(solrInputDocument.getFieldValue(fieldsToAnalyze[i]));
+      }
+    }
+    return textVals;
+  }
+
+  /* process a field value executing UIMA the CAS containing it as document text */
+  private JCas processText(String textFieldValue) throws ResourceInitializationException,
+          AnalysisEngineProcessException {
+    log.info(new StringBuffer("Analazying text").toString());
+    /* get the UIMA analysis engine */
+    AnalysisEngine ae = aeProvider.getAE();
+
+    /* create a JCas which contain the text to analyze */
+    JCas jcas = ae.newJCas();
+    jcas.setDocumentText(textFieldValue);
+
+    /* perform analysis on text field */
+    ae.process(jcas);
+    log.info(new StringBuilder("Text processing completed").toString());
+    return jcas;
+  }
+
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessorFactory.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessorFactory.java
new file mode 100644
index 0000000..5078f9d
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessorFactory.java
@@ -0,0 +1,37 @@
+package org.apache.solr.uima.processor;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import org.apache.solr.request.SolrQueryRequest;
+import org.apache.solr.response.SolrQueryResponse;
+import org.apache.solr.update.processor.UpdateRequestProcessor;
+import org.apache.solr.update.processor.UpdateRequestProcessorFactory;
+
+/**
+ * Factory for {@link UIMAUpdateRequestProcessor}
+ * 
+ * @version $Id$
+ */
+public class UIMAUpdateRequestProcessorFactory extends UpdateRequestProcessorFactory {
+
+  public UpdateRequestProcessor getInstance(SolrQueryRequest req, SolrQueryResponse rsp,
+          UpdateRequestProcessor next) {
+    return new UIMAUpdateRequestProcessor(next, req.getCore());
+  }
+
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/AEProvider.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/AEProvider.java
new file mode 100644
index 0000000..89c981a
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/AEProvider.java
@@ -0,0 +1,32 @@
+package org.apache.solr.uima.processor.ae;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import org.apache.uima.analysis_engine.AnalysisEngine;
+import org.apache.uima.resource.ResourceInitializationException;
+
+/**
+ * provide an Apache UIMA {@link AnalysisEngine}
+ * 
+ * @version $Id$
+ */
+public interface AEProvider {
+
+  public AnalysisEngine getAE() throws ResourceInitializationException;
+
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/AEProviderFactory.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/AEProviderFactory.java
new file mode 100644
index 0000000..2104e75
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/AEProviderFactory.java
@@ -0,0 +1,53 @@
+package org.apache.solr.uima.processor.ae;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.util.HashMap;
+import java.util.Map;
+
+/**
+ * Singleton factory class responsible of {@link AEProvider}s' creation
+ * 
+ * @version $Id$
+ */
+public class AEProviderFactory {
+
+  private static AEProviderFactory instance;
+
+  private Map<String, AEProvider> providerCache = new HashMap<String, AEProvider>();
+
+  private AEProviderFactory() {
+    // Singleton
+  }
+
+  public static AEProviderFactory getInstance() {
+    if (instance == null) {
+      instance = new AEProviderFactory();
+    }
+    return instance;
+  }
+
+  public synchronized AEProvider getAEProvider(String core, String aePath,
+          Map<String, String> runtimeParameters) {
+    String key = new StringBuilder(core).append(aePath).toString();
+    if (providerCache.get(key) == null) {
+      providerCache.put(key, new OverridingParamsAEProvider(aePath, runtimeParameters));
+    }
+    return providerCache.get(key);
+  }
+}
diff --git a/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/OverridingParamsAEProvider.java b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/OverridingParamsAEProvider.java
new file mode 100644
index 0000000..d4d7491
--- /dev/null
+++ b/solr/contrib/uima/src/main/java/org/apache/solr/uima/processor/ae/OverridingParamsAEProvider.java
@@ -0,0 +1,89 @@
+package org.apache.solr.uima.processor.ae;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.net.URL;
+import java.util.Map;
+
+import org.apache.uima.UIMAFramework;
+import org.apache.uima.analysis_engine.AnalysisEngine;
+import org.apache.uima.analysis_engine.AnalysisEngineDescription;
+import org.apache.uima.resource.ResourceInitializationException;
+import org.apache.uima.util.XMLInputSource;
+import org.slf4j.Logger;
+import org.slf4j.LoggerFactory;
+
+/**
+ * {@link AEProvider} implementation that creates an Aggregate AE from the given path, also
+ * injecting runtime parameters defined in the solrconfig.xml Solr configuration file and assigning
+ * them as overriding parameters in the aggregate AE
+ * 
+ * @version $Id$
+ */
+public class OverridingParamsAEProvider implements AEProvider {
+
+  private static Logger log = LoggerFactory.getLogger(OverridingParamsAEProvider.class);
+
+  private String aeFilePath;
+
+  private AnalysisEngine cachedAE;
+
+  private Map<String, String> runtimeParameters;
+
+  public OverridingParamsAEProvider(String aeFilePath, Map<String, String> runtimeParameters) {
+    this.aeFilePath = aeFilePath;
+    this.runtimeParameters = runtimeParameters;
+  }
+
+  public synchronized AnalysisEngine getAE() throws ResourceInitializationException {
+    try {
+      if (cachedAE == null) {
+        // get Resource Specifier from XML file
+        URL url = this.getClass().getResource(aeFilePath);
+        XMLInputSource in = new XMLInputSource(url);
+
+        // get AE description
+        AnalysisEngineDescription desc = UIMAFramework.getXMLParser()
+                .parseAnalysisEngineDescription(in);
+
+        /* iterate over each AE (to set runtime parameters) */
+        for (String attributeName : runtimeParameters.keySet()) {
+          desc.getAnalysisEngineMetaData().getConfigurationParameterSettings().setParameterValue(
+                  attributeName, runtimeParameters.get(attributeName));
+          log.info(new StringBuilder("setting ").append(attributeName).append(" : ").append(
+                  runtimeParameters.get(attributeName)).toString());
+        }
+        // create AE here
+        cachedAE = UIMAFramework.produceAnalysisEngine(desc);
+        if (log.isDebugEnabled())
+          log.debug(new StringBuilder("AE ").append(cachedAE.getAnalysisEngineMetaData().getName())
+                  .append(" created from descriptor ").append(aeFilePath).toString());
+      } else {
+        cachedAE.reconfigure();
+        if (log.isDebugEnabled())
+          log.debug(new StringBuilder("AE ").append(cachedAE.getAnalysisEngineMetaData().getName())
+                  .append(" at path ").append(aeFilePath).append(" reconfigured ").toString());
+      }
+    } catch (Exception e) {
+      cachedAE = null;
+      throw new ResourceInitializationException(e);
+    }
+    return cachedAE;
+  }
+
+}
\ No newline at end of file
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/AggregateSentenceAE.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/AggregateSentenceAE.xml
new file mode 100644
index 0000000..75ae50e
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/AggregateSentenceAE.xml
@@ -0,0 +1,41 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>false</primitive>
+  <delegateAnalysisEngineSpecifiers>
+    <delegateAnalysisEngine key="HmmTagger">
+      <import name="HmmTagger"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="WhitespaceTokenizer">
+      <import name="WhitespaceTokenizer"/>
+    </delegateAnalysisEngine>
+  </delegateAnalysisEngineSpecifiers>
+  <analysisEngineMetaData>
+    <name>AggregateSentenceAE</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters/>
+    <configurationParameterSettings/>
+    <flowConstraints>
+      <fixedFlow>
+        <node>WhitespaceTokenizer</node>
+        <node>HmmTagger</node>
+      </fixedFlow>
+    </flowConstraints>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/ExtServicesAE.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/ExtServicesAE.xml
new file mode 100644
index 0000000..ef5268f
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/ExtServicesAE.xml
@@ -0,0 +1,57 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>false</primitive>
+  <delegateAnalysisEngineSpecifiers>
+    <delegateAnalysisEngine key="TextConceptTaggingAEDescriptor">
+      <import name="TextConceptTaggingAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextKeywordExtractionAEDescriptor">
+      <import name="TextKeywordExtractionAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="OpenCalaisAnnotator">
+      <import name="OpenCalaisAnnotator"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextCategorizationAEDescriptor">
+      <import name="TextCategorizationAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextLanguageDetectionAEDescriptor">
+      <import name="TextLanguageDetectionAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextRankedEntityExtractionAEDescriptor">
+      <import name="TextRankedEntityExtractionAEDescriptor"/>
+    </delegateAnalysisEngine>
+  </delegateAnalysisEngineSpecifiers>
+  <analysisEngineMetaData>
+    <name>ExtServicesAE</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters/>
+    <configurationParameterSettings/>
+    <flowConstraints>
+      <fixedFlow>
+        <node>OpenCalaisAnnotator</node>
+        <node>TextKeywordExtractionAEDescriptor</node>
+        <node>TextLanguageDetectionAEDescriptor</node>
+        <node>TextCategorizationAEDescriptor</node>
+        <node>TextConceptTaggingAEDescriptor</node>
+        <node>TextRankedEntityExtractionAEDescriptor</node>
+      </fixedFlow>
+    </flowConstraints>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/HmmTagger.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/HmmTagger.xml
new file mode 100644
index 0000000..8fe4216
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/HmmTagger.xml
@@ -0,0 +1,121 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+	Licensed to the Apache Software Foundation (ASF) under one
+	or more contributor license agreements.  See the NOTICE file
+	distributed with this work for additional information
+	regarding copyright ownership.  The ASF licenses this file
+	to you under the Apache License, Version 2.0 (the
+	"License"); you may not use this file except in compliance
+	with the License.  You may obtain a copy of the License at
+	
+	http://www.apache.org/licenses/LICENSE-2.0
+	
+	Unless required by applicable law or agreed to in writing,
+	software distributed under the License is distributed on an
+	"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+	KIND, either express or implied.  See the License for the
+	specific language governing permissions and limitations
+	under the License.    
+-->
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.examples.tagger.HMMTagger</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>Hidden Markov Model - Part of Speech Tagger</name>
+    <description>A configuration of the HmmTaggerAnnotator that looks for
+			parts of speech of identified tokens within existing
+			Sentence and Token annotations. See also
+			WhitespaceTokenizer.xml.</description>
+    <version>1.0</version>
+    <vendor>The Apache Software Foundation</vendor>
+    <configurationParameters>
+      <configurationParameter>
+        <name>NGRAM_SIZE</name>
+        <type>Integer</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>NGRAM_SIZE</name>
+        <value>
+          <integer>3</integer>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.TokenAnnotation</name>
+          <description>Single token annotation</description>
+          <supertypeName>uima.tcas.Annotation</supertypeName>
+          <features>
+            <featureDescription>
+              <name>posTag</name>
+              <description>contains part-of-speech of a
+								corresponding token</description>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+          </features>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.SentenceAnnotation</name>
+          <description>sentence annotation</description>
+          <supertypeName>uima.tcas.Annotation</supertypeName>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <typePriorities/>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs>
+          <type>org.apache.uima.TokenAnnotation</type>
+          <type allAnnotatorFeatures="true">org.apache.uima.SentenceAnnotation</type>
+          <feature>org.apache.uima.TokenAnnotation:end</feature>
+          <feature>org.apache.uima.TokenAnnotation:begin</feature>
+        </inputs>
+        <outputs>
+          <type>org.apache.uima.TokenAnnotation</type>
+          <feature>org.apache.uima.TokenAnnotation:posTag</feature>
+          <feature>org.apache.uima.TokenAnnotation:end</feature>
+          <feature>org.apache.uima.TokenAnnotation:begin</feature>
+        </outputs>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <externalResourceDependencies>
+    <externalResourceDependency>
+      <key>Model</key>
+      <description>HMM Tagger model file</description>
+      <interfaceName>org.apache.uima.examples.tagger.IModelResource</interfaceName>
+      <optional>false</optional>
+    </externalResourceDependency>
+  </externalResourceDependencies>
+  <resourceManagerConfiguration>
+    <externalResources>
+      <externalResource>
+        <name>ModelFile</name>
+        <description>HMM Tagger model file</description>
+        <fileResourceSpecifier>
+          <fileUrl>file:english/BrownModel.dat</fileUrl>
+        </fileResourceSpecifier>
+        <implementationName>org.apache.uima.examples.tagger.ModelResource</implementationName>
+      </externalResource>
+    </externalResources>
+    <externalResourceBindings>
+      <externalResourceBinding>
+        <key>Model</key>
+        <resourceName>ModelFile</resourceName>
+      </externalResourceBinding>
+    </externalResourceBindings>
+  </resourceManagerConfiguration>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/OpenCalaisAnnotator.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/OpenCalaisAnnotator.xml
new file mode 100644
index 0000000..e7b0c07
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/OpenCalaisAnnotator.xml
@@ -0,0 +1,194 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.annotator.calais.OpenCalaisAnnotator</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>OpenCalaisAnnotator</name>
+    <description/>
+    <configurationParameters>
+      <configurationParameter>
+        <name>allowDistribution</name>
+        <description/>
+        <type>Boolean</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>allowSearch</name>
+        <description/>
+        <type>Boolean</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>submitter</name>
+        <description/>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>licenseID</name>
+        <description/>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>allowDistribution</name>
+        <value>
+          <boolean>false</boolean>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>allowSearch</name>
+        <value>
+          <boolean>false</boolean>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>submitter</name>
+        <value>
+          <string/>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>licenseID</name>
+        <value>
+          <string>OC_LICENSE_ID</string>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.calais.Person</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Anniversary</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.City</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Company</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Continent</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Country</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Currency</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.EmailAddress</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Facility</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.FaxNumber</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Holiday</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.IndustryTerm</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.NaturalDisaster</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.NaturalFeature</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Organization</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.PhoneNumber</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.ProviceOrState</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Region</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.Technology</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.URL</name>
+          <description/>
+          <supertypeName>org.apache.uima.calais.BaseType</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.calais.BaseType</name>
+          <description/>
+          <supertypeName>uima.tcas.Annotation</supertypeName>
+          <features>
+            <featureDescription>
+              <name>calaisType</name>
+              <description>OpenCalais type</description>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+          </features>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/OverridingParamsExtServicesAE.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/OverridingParamsExtServicesAE.xml
new file mode 100644
index 0000000..81bd402
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/OverridingParamsExtServicesAE.xml
@@ -0,0 +1,147 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>false</primitive>
+  <delegateAnalysisEngineSpecifiers>
+    <delegateAnalysisEngine key="TextKeywordExtractionAEDescriptor">
+      <import name="TextKeywordExtractionAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextConceptTaggingAEDescriptor">
+      <import name="TextConceptTaggingAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="OpenCalaisAnnotator">
+      <import name="OpenCalaisAnnotator"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextLanguageDetectionAEDescriptor">
+      <import name="TextLanguageDetectionAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextCategorizationAEDescriptor">
+      <import name="TextCategorizationAEDescriptor"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="AggregateSentenceAE">
+      <import location="AggregateSentenceAE.xml"/>
+    </delegateAnalysisEngine>
+    <delegateAnalysisEngine key="TextRankedEntityExtractionAEDescriptor">
+      <import name="TextRankedEntityExtractionAEDescriptor"/>
+    </delegateAnalysisEngine>
+  </delegateAnalysisEngineSpecifiers>
+  <analysisEngineMetaData>
+    <name>ExtServicesAE</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters searchStrategy="language_fallback">
+      <configurationParameter>
+        <name>oc_licenseID</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+        <overrides>
+          <parameter>OpenCalaisAnnotator/licenseID</parameter>
+        </overrides>
+      </configurationParameter>
+      <configurationParameter>
+        <name>keyword_apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+        <overrides>
+          <parameter>TextKeywordExtractionAEDescriptor/apikey</parameter>
+        </overrides>
+      </configurationParameter>
+      <configurationParameter>
+        <name>concept_apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+        <overrides>
+          <parameter>TextConceptTaggingAEDescriptor/apikey</parameter>
+        </overrides>
+      </configurationParameter>
+      <configurationParameter>
+        <name>lang_apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+        <overrides>
+          <parameter>TextLanguageDetectionAEDescriptor/apikey</parameter>
+        </overrides>
+      </configurationParameter>
+      <configurationParameter>
+        <name>cat_apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+        <overrides>
+          <parameter>TextCategorizationAEDescriptor/apikey</parameter>
+        </overrides>
+      </configurationParameter>
+      <configurationParameter>
+        <name>entities_apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+        <overrides>
+          <parameter>TextRankedEntityExtractionAEDescriptor/apikey</parameter>
+        </overrides>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>oc_licenseID</name>
+        <value>
+          <string>licenseid</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>keyword_apikey</name>
+        <value>
+          <string>apikey</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>concept_apikey</name>
+        <value>
+          <string>apikey</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>lang_apikey</name>
+        <value>
+          <string>apikey</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>cat_apikey</name>
+        <value>
+          <string>apikey</string>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <flowConstraints>
+      <fixedFlow>
+        <node>AggregateSentenceAE</node>
+        <node>OpenCalaisAnnotator</node>
+        <node>TextKeywordExtractionAEDescriptor</node>
+        <node>TextLanguageDetectionAEDescriptor</node>
+        <node>TextCategorizationAEDescriptor</node>
+        <node>TextConceptTaggingAEDescriptor</node>
+        <node>TextRankedEntityExtractionAEDescriptor</node>
+      </fixedFlow>
+    </flowConstraints>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextCategorizationAEDescriptor.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextCategorizationAEDescriptor.xml
new file mode 100644
index 0000000..16aff2b
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextCategorizationAEDescriptor.xml
@@ -0,0 +1,102 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+
+    	Licensed to the Apache Software Foundation (ASF) under one
+    	or more contributor license agreements.  See the NOTICE file
+    	distributed with this work for additional information
+    	regarding copyright ownership.  The ASF licenses this file
+    	to you under the Apache License, Version 2.0 (the
+    	"License"); you may not use this file except in compliance
+    	with the License.  You may obtain a copy of the License at
+
+    	http://www.apache.org/licenses/LICENSE-2.0
+
+    	Unless required by applicable law or agreed to in writing,
+    	software distributed under the License is distributed on an
+    	"AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+    	KIND, either express or implied.  See the License for the
+    	specific language governing permissions and limitations
+    	under the License.
+
+-->
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.alchemy.annotator.TextCategorizationAnnotator</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>TextCategorizationAEDescriptor</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters>
+      <configurationParameter>
+        <name>apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>outputMode</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>baseUrl</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>outputMode</name>
+        <value>
+          <string>xml</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>apikey</name>
+        <value>
+          <string>AA_API_KEY</string>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.categorization.Category</name>
+          <description/>
+          <supertypeName>uima.cas.TOP</supertypeName>
+          <features>
+            <featureDescription>
+              <name>score</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>text</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+          </features>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <typePriorities/>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextConceptTaggingAEDescriptor.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextConceptTaggingAEDescriptor.xml
new file mode 100644
index 0000000..ee9166c
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextConceptTaggingAEDescriptor.xml
@@ -0,0 +1,196 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+   Licensed to the Apache Software Foundation (ASF) under one
+   or more contributor license agreements.  See the NOTICE file
+   distributed with this work for additional information
+   regarding copyright ownership.  The ASF licenses this file
+   to you under the Apache License, Version 2.0 (the
+   "License"); you may not use this file except in compliance
+   with the License.  You may obtain a copy of the License at
+
+     http://www.apache.org/licenses/LICENSE-2.0
+
+   Unless required by applicable law or agreed to in writing,
+   software distributed under the License is distributed on an
+   "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+   KIND, either express or implied.  See the License for the
+   specific language governing permissions and limitations
+   under the License.    
+-->
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.alchemy.annotator.TextConceptTaggingAnnotator</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>TextConceptTaggingAEDescriptor</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters>
+      <configurationParameter>
+        <name>apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>outputMode</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>linkedData</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>showSourceText</name>
+        <type>Integer</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>maxRetrieve</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>url</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>apikey</name>
+        <value>
+          <string/>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>outputMode</name>
+        <value>
+          <string>xml</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>linkedData</name>
+        <value>
+          <string>1</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>showSourceText</name>
+        <value>
+          <integer>0</integer>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>maxRetrieve</name>
+        <value>
+          <string>8</string>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.concept.ConceptFS</name>
+          <description>a concept tag</description>
+          <supertypeName>uima.cas.TOP</supertypeName>
+          <features>
+            <featureDescription>
+              <name>text</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>relevance</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>website</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>geo</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>dbpedia</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>yago</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>opencyc</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>freebase</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>ciaFactbook</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>census</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>geonames</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>musicBrainz</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>crunchbase</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>semanticCrunchbase</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+          </features>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <typePriorities/>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextKeywordExtractionAEDescriptor.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextKeywordExtractionAEDescriptor.xml
new file mode 100644
index 0000000..af6a512
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextKeywordExtractionAEDescriptor.xml
@@ -0,0 +1,107 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.alchemy.annotator.TextKeywordExtractionAnnotator</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>TextKeywordExtractionAEDescriptor</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters>
+      <configurationParameter>
+        <name>apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>outputMode</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>baseUrl</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>url</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>maxRetrieve</name>
+        <type>Integer</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>showSourceText</name>
+        <type>Integer</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>outputMode</name>
+        <value>
+          <string>xml</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>apikey</name>
+        <value>
+          <string>04490000a72fe7ec5cb3497f14e77f338c86f2fe</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>maxRetrieve</name>
+        <value>
+          <integer>10</integer>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>showSourceText</name>
+        <value>
+          <integer>0</integer>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.keywords.KeywordFS</name>
+          <description/>
+          <supertypeName>uima.cas.TOP</supertypeName>
+          <features>
+            <featureDescription>
+              <name>text</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+          </features>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <typePriorities/>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextLanguageDetectionAEDescriptor.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextLanguageDetectionAEDescriptor.xml
new file mode 100644
index 0000000..6f9fb98
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextLanguageDetectionAEDescriptor.xml
@@ -0,0 +1,107 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.alchemy.annotator.TextLanguageDetectionAnnotator</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>TextLanguageDetectionAEDescriptor</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters>
+      <configurationParameter>
+        <name>apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>outputMode</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>url</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>outputMode</name>
+        <value>
+          <string>xml</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>apikey</name>
+        <value>
+          <string>AA_API_KEY</string>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.language.LanguageFS</name>
+          <description/>
+          <supertypeName>uima.cas.TOP</supertypeName>
+          <features>
+            <featureDescription>
+              <name>language</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>iso6391</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>iso6392</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>iso6393</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>ethnologue</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>nativeSpeakers</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>wikipedia</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+          </features>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <typePriorities/>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextRankedEntityExtractionAEDescriptor.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextRankedEntityExtractionAEDescriptor.xml
new file mode 100644
index 0000000..410d6c9
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/TextRankedEntityExtractionAEDescriptor.xml
@@ -0,0 +1,403 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+
+      Licensed to the Apache Software Foundation (ASF) under one
+      or more contributor license agreements.  See the NOTICE file
+      distributed with this work for additional information
+      regarding copyright ownership.  The ASF licenses this file
+      to you under the Apache License, Version 2.0 (the
+      "License"); you may not use this file except in compliance
+      with the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+      Unless required by applicable law or agreed to in writing,
+      software distributed under the License is distributed on an
+      "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+      KIND, either express or implied.  See the License for the
+      specific language governing permissions and limitations
+      under the License.
+
+-->
+<analysisEngineDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <frameworkImplementation>org.apache.uima.java</frameworkImplementation>
+  <primitive>true</primitive>
+  <annotatorImplementationName>org.apache.uima.alchemy.annotator.TextRankedNamedEntityExtractionAnnotator</annotatorImplementationName>
+  <analysisEngineMetaData>
+    <name>TextRankedEntityExtractionAEDescriptor</name>
+    <description/>
+    <version>1.0</version>
+    <vendor/>
+    <configurationParameters>
+      <configurationParameter>
+        <name>apikey</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>outputMode</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>disambiguate</name>
+        <type>Integer</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>linkedData</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>showSourceText</name>
+        <type>Integer</type>
+        <multiValued>false</multiValued>
+        <mandatory>true</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>baseUrl</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>url</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>coreference</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+      <configurationParameter>
+        <name>quotations</name>
+        <type>String</type>
+        <multiValued>false</multiValued>
+        <mandatory>false</mandatory>
+      </configurationParameter>
+    </configurationParameters>
+    <configurationParameterSettings>
+      <nameValuePair>
+        <name>apikey</name>
+        <value>
+          <string/>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>outputMode</name>
+        <value>
+          <string>xml</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>disambiguate</name>
+        <value>
+          <integer>1</integer>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>linkedData</name>
+        <value>
+          <string>1</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>coreference</name>
+        <value>
+          <string>1</string>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>showSourceText</name>
+        <value>
+          <integer>0</integer>
+        </value>
+      </nameValuePair>
+      <nameValuePair>
+        <name>quotations</name>
+        <value>
+          <string>1</string>
+        </value>
+      </nameValuePair>
+    </configurationParameterSettings>
+    <typeSystemDescription>
+      <imports>
+        <import location="baseAlchemyTypeSystemDescriptor.xml"/>
+      </imports>
+      <types>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Anniversary</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Automobile</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.City</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Company</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Continent</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Country</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.EntertainmentAward</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Facility</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.FieldTerminology</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.FinancialMarketIndex</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.GeographicFeature</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.HealthCondition</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Holiday</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Movie</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.MusicGroup</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.NaturalDisaster</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Organization</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Person</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.PrintMedia</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.RadioProgram</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.RadioStation</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Region</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Sport</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.StateOrCounty</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Technology</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.TelevisionShow</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.TelevisionStation</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.OperatingSystem</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.SportingEvent</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.Drug</name>
+          <description/>
+          <supertypeName>org.apache.uima.alchemy.ts.entity.BaseEntity</supertypeName>
+        </typeDescription>
+        <typeDescription>
+          <name>org.apache.uima.alchemy.ts.entity.BaseEntity</name>
+          <description/>
+          <supertypeName>uima.cas.TOP</supertypeName>
+          <features>
+            <featureDescription>
+              <name>text</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>count</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>relevance</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>disambiguation</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>subType</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>website</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>geo</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>dbpedia</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>yago</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>opencyc</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>umbel</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>freebase</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>ciaFactbook</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>census</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>geonames</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>musicBrainz</name>
+              <description/>
+              <rangeTypeName>uima.cas.String</rangeTypeName>
+            </featureDescription>
+            <featureDescription>
+              <name>quotations</name>
+              <description/>
+              <rangeTypeName>uima.cas.StringArray</rangeTypeName>
+              <multipleReferencesAllowed>true</multipleReferencesAllowed>
+            </featureDescription>
+            <featureDescription>
+              <name>occurrences</name>
+              <description>A list of annotations annotating this entity</description>
+              <rangeTypeName>uima.cas.FSList</rangeTypeName>
+              <elementType>uima.tcas.Annotation</elementType>
+            </featureDescription>
+          </features>
+        </typeDescription>
+      </types>
+    </typeSystemDescription>
+    <typePriorities/>
+    <fsIndexCollection/>
+    <capabilities>
+      <capability>
+        <inputs/>
+        <outputs/>
+        <languagesSupported/>
+      </capability>
+    </capabilities>
+    <operationalProperties>
+      <modifiesCas>true</modifiesCas>
+      <multipleDeploymentAllowed>true</multipleDeploymentAllowed>
+      <outputsNewCASes>false</outputsNewCASes>
+    </operationalProperties>
+  </analysisEngineMetaData>
+  <resourceManagerConfiguration/>
+</analysisEngineDescription>
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/WhitespaceTokenizer.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/WhitespaceTokenizer.xml
new file mode 100644
index 0000000..686dbef
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/WhitespaceTokenizer.xml
@@ -0,0 +1,115 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+
+<!--
+	***************************************************************
+	* Licensed to the Apache Software Foundation (ASF) under one
+	* or more contributor license agreements.  See the NOTICE file
+	* distributed with this work for additional information
+	* regarding copyright ownership.  The ASF licenses this file
+	* to you under the Apache License, Version 2.0 (the
+	* "License"); you may not use this file except in compliance
+	* with the License.  You may obtain a copy of the License at
+	*
+	*   http://www.apache.org/licenses/LICENSE-2.0
+	* 
+	* Unless required by applicable law or agreed to in writing,
+	* software distributed under the License is distributed on an
+	* "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+	* KIND, either express or implied.  See the License for the
+	* specific language governing permissions and limitations
+	* under the License.
+	***************************************************************
+-->
+
+<analysisEngineDescription
+	xmlns="http://uima.apache.org/resourceSpecifier">
+	<frameworkImplementation>
+		org.apache.uima.java
+	</frameworkImplementation>
+	<primitive>true</primitive>
+	<annotatorImplementationName>
+		org.apache.uima.annotator.WhitespaceTokenizer
+	</annotatorImplementationName>
+
+	<analysisEngineMetaData>
+		<name>WhitespaceTokenizer</name>
+		<description>
+			creates token and sentence annotations for whitespace
+			separated languages
+		</description>
+		<version>1.0</version>
+		<vendor>The Apache Software Foundation</vendor>
+
+		<configurationParameters>
+			<configurationParameter>
+				<name>SofaNames</name>
+				<description>
+					The Sofa names the annotator should work on. If no
+					names are specified, the annotator works on the
+					default sofa.
+				</description>
+				<type>String</type>
+				<multiValued>true</multiValued>
+				<mandatory>false</mandatory>
+			</configurationParameter>
+
+		</configurationParameters>
+
+		<configurationParameterSettings>
+		<!-- 
+			<nameValuePair>
+				<name>SofaNames</name>
+				<value>
+					<array>
+						<string>sofaName</string>
+					</array>
+				</value>
+			</nameValuePair>
+		-->
+		</configurationParameterSettings>
+
+		<typeSystemDescription>
+			<typeDescription>
+				<name>org.apache.uima.TokenAnnotation</name>
+				<description>Single token annotation</description>
+				<supertypeName>uima.tcas.Annotation</supertypeName>
+				<features>
+					<featureDescription>
+						<name>tokenType</name>
+						<description>token type</description>
+						<rangeTypeName>uima.cas.String</rangeTypeName>
+					</featureDescription>
+				</features>
+			</typeDescription>
+
+			<typeDescription>
+				<name>org.apache.uima.SentenceAnnotation</name>
+				<description>sentence annotation</description>
+				<supertypeName>uima.tcas.Annotation</supertypeName>
+				<features>
+
+				</features>
+			</typeDescription>
+		</typeSystemDescription>
+
+		<fsIndexes />
+
+		<capabilities>
+			<capability>
+				<inputs />
+				<outputs>
+					<type>org.apache.uima.TokenAnnotation</type>
+					<feature>
+						org.apache.uima.TokenAnnotation:tokentype
+					</feature>
+					<type>org.apache.uima.SentenceAnnotation</type>
+				</outputs>
+				<languagesSupported>
+					<language>x-unspecified</language>
+				</languagesSupported>
+			</capability>
+		</capabilities>
+
+	</analysisEngineMetaData>
+</analysisEngineDescription>
+
diff --git a/solr/contrib/uima/src/main/resources/org/apache/uima/desc/baseAlchemyTypeSystemDescriptor.xml b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/baseAlchemyTypeSystemDescriptor.xml
new file mode 100644
index 0000000..32d5d84
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/org/apache/uima/desc/baseAlchemyTypeSystemDescriptor.xml
@@ -0,0 +1,41 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+
+      Licensed to the Apache Software Foundation (ASF) under one
+      or more contributor license agreements.  See the NOTICE file
+      distributed with this work for additional information
+      regarding copyright ownership.  The ASF licenses this file
+      to you under the Apache License, Version 2.0 (the
+      "License"); you may not use this file except in compliance
+      with the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+      Unless required by applicable law or agreed to in writing,
+      software distributed under the License is distributed on an
+      "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+      KIND, either express or implied.  See the License for the
+      specific language governing permissions and limitations
+      under the License.
+
+-->
+<typeSystemDescription xmlns="http://uima.apache.org/resourceSpecifier">
+  <name>baseAlchemyTypeSystemDescriptor</name>
+  <description/>
+  <version>1.0</version>
+  <vendor/>
+  <types>
+    <typeDescription>
+      <name>org.apache.uima.alchemy.ts.entity.AlchemyAnnotation</name>
+      <description/>
+      <supertypeName>uima.tcas.Annotation</supertypeName>
+      <features>
+        <featureDescription>
+          <name>alchemyType</name>
+          <description>alchemyAPI type</description>
+          <rangeTypeName>uima.cas.String</rangeTypeName>
+        </featureDescription>
+      </features>
+    </typeDescription>
+  </types>
+</typeSystemDescription>
diff --git a/solr/contrib/uima/src/main/resources/solr/conf/aggregate-uima-config.xml b/solr/contrib/uima/src/main/resources/solr/conf/aggregate-uima-config.xml
new file mode 100644
index 0000000..0e66585
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/solr/conf/aggregate-uima-config.xml
@@ -0,0 +1,33 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+  <!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements. See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version
+    2.0 (the "License"); you may not use this file except in compliance
+    with the License. You may obtain a copy of the License at
+
+    http://www.apache.org/licenses/LICENSE-2.0 Unless required by
+    applicable law or agreed to in writing, software distributed under
+    the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
+    OR CONDITIONS OF ANY KIND, either express or implied. See the
+    License for the specific language governing permissions and
+    limitations under the License.
+  -->
+
+<uimaConfig>
+  <runtimeParameters>
+    <keyword_apikey>VALID_ALCHEMYAPI_KEY</keyword_apikey>
+    <concept_apikey>VALID_ALCHEMYAPI_KEY</concept_apikey>
+    <lang_apikey>VALID_ALCHEMYAPI_KEY</lang_apikey>
+    <cat_apikey>VALID_ALCHEMYAPI_KEY</cat_apikey>
+    <oc_licenseID>VALID_OPENCALAIS_KEY</oc_licenseID>
+  </runtimeParameters>
+  <analysisEngine>/org/apache/uima/desc/OverridingParamsExtServicesAE.xml</analysisEngine>
+  <analyzeFields merge="false">text,title</analyzeFields>
+  <fieldMapping>
+    <type name="org.apache.uima.jcas.tcas.Annotation">
+      <map feature="coveredText" field="tag"/>
+    </type>
+  </fieldMapping>
+</uimaConfig>
\ No newline at end of file
diff --git a/solr/contrib/uima/src/main/resources/solr/conf/uima-fields.xml b/solr/contrib/uima/src/main/resources/solr/conf/uima-fields.xml
new file mode 100644
index 0000000..270aaa6
--- /dev/null
+++ b/solr/contrib/uima/src/main/resources/solr/conf/uima-fields.xml
@@ -0,0 +1,9 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+<fields>
+  <field name="language" type="string" indexed="true" stored="true" required="false"/>
+  <field name="concept" type="string" indexed="true" stored="true" multiValued="true" required="false"/>
+  <field name="keyword" type="string" indexed="true" stored="true" multiValued="true" required="false"/>
+  <field name="suggested_category" type="string" indexed="true" stored="true" multiValued="false" required="false"/>
+  <field name="sentence" type="text" indexed="true" stored="true" multiValued="true" required="false" />
+  <dynamicField name="entity*" type="text" indexed="true" stored="true" multiValued="true"/>
+</fields>
\ No newline at end of file
diff --git a/solr/contrib/uima/src/test/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessorTest.java b/solr/contrib/uima/src/test/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessorTest.java
new file mode 100644
index 0000000..3d2058b
--- /dev/null
+++ b/solr/contrib/uima/src/test/java/org/apache/solr/uima/processor/UIMAUpdateRequestProcessorTest.java
@@ -0,0 +1,137 @@
+package org.apache.solr.uima.processor;
+
+/**
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+import java.net.URL;
+import java.net.URLConnection;
+import java.util.ArrayList;
+import java.util.HashMap;
+import java.util.Map;
+
+import org.apache.solr.SolrTestCaseJ4;
+import org.apache.solr.common.params.MultiMapSolrParams;
+import org.apache.solr.common.params.SolrParams;
+import org.apache.solr.common.params.UpdateParams;
+import org.apache.solr.common.util.ContentStream;
+import org.apache.solr.common.util.ContentStreamBase;
+import org.apache.solr.core.SolrCore;
+import org.apache.solr.handler.XmlUpdateRequestHandler;
+import org.apache.solr.request.SolrQueryRequestBase;
+import org.apache.solr.response.SolrQueryResponse;
+import org.apache.solr.update.processor.UpdateRequestProcessorChain;
+import org.junit.Before;
+import org.junit.BeforeClass;
+import org.junit.Test;
+
+/**
+ * TestCase for {@link UIMAUpdateRequestProcessor}
+ * 
+ * @version $Id$
+ */
+public class UIMAUpdateRequestProcessorTest extends SolrTestCaseJ4 {
+
+  @BeforeClass
+  public static void beforeClass() throws Exception {
+    initCore("solrconfig.xml", "schema.xml", "solr-uima");
+  }
+
+  @Before
+  public void setUp() throws Exception {
+    super.setUp();
+    clearIndex();
+    assertU(commit());
+  }
+
+  @Test
+  public void testProcessorConfiguration() {
+    SolrCore core = h.getCore();
+    UpdateRequestProcessorChain chained = core.getUpdateProcessingChain("uima");
+    assertNotNull(chained);
+    UIMAUpdateRequestProcessorFactory factory = (UIMAUpdateRequestProcessorFactory) chained
+            .getFactories()[0];
+    assertNotNull(factory);
+  }
+
+  @Test
+  public void testProcessing() throws Exception {
+    // this test requires an internet connection (e.g. opencalais api)
+    checkInternetConnection();
+
+    addDoc(adoc(
+            "id",
+            "2312312321312",
+            "text",
+            "SpellCheckComponent got improvement related to recent Lucene changes. \n  "
+                    + "Add support for specifying Spelling SuggestWord Comparator to Lucene spell "
+                    + "checkers for SpellCheckComponent. Issue SOLR-2053 is already fixed, patch is"
+                    + " attached if you need it, but it is also committed to trunk and 3_x branch."
+                    + " Last Lucene European Conference has been held in Prague."));
+    assertU(commit());
+    assertQ(req("language:english"), "//*[@numFound='1']");
+  }
+
+  @Test
+  public void testTwoUpdates() {
+    // this test requires an internet connection (e.g. opencalais api)
+    checkInternetConnection();
+
+    try {
+      addDoc(adoc("id", "1", "text", "The Apache Software Foundation is happy to announce "
+              + "BarCampApache Sydney, Australia, the first ASF-backed event in the Southern "
+              + "Hemisphere!"));
+      assertU(commit());
+      assertQ(req("language:english"), "//*[@numFound='1']");
+
+      addDoc(adoc("id", "2", "text", "Taking place 11th December 2010 at the University "
+              + "of Sydney's Darlington Centre, the BarCampApache \"unconference\" will be"
+              + " attendee-driven, facilitated by members of the Apache community and will "
+              + "focus on the Apache..."));
+      assertU(commit());
+      assertQ(req("language:english"), "//*[@numFound='2']");
+
+    } catch (Exception e) {
+      assumeNoException("Multiple updates on same instance didn't work", e);
+    }
+  }
+
+  private void addDoc(String doc) throws Exception {
+    Map<String, String[]> params = new HashMap<String, String[]>();
+    params.put(UpdateParams.UPDATE_PROCESSOR, new String[] { "uima" });
+    MultiMapSolrParams mmparams = new MultiMapSolrParams(params);
+    SolrQueryRequestBase req = new SolrQueryRequestBase(h.getCore(), (SolrParams) mmparams) {
+    };
+
+    XmlUpdateRequestHandler handler = new XmlUpdateRequestHandler();
+    handler.init(null);
+    ArrayList<ContentStream> streams = new ArrayList<ContentStream>(2);
+    streams.add(new ContentStreamBase.StringStream(doc));
+    req.setContentStreams(streams);
+    handler.handleRequestBody(req, new SolrQueryResponse());
+  }
+
+  private void checkInternetConnection() {
+    try {
+      URLConnection conn = new URL("http://www.apache.org/").openConnection();
+      conn.setConnectTimeout(5000);
+      conn.setReadTimeout(5000);
+      conn.connect();
+    } catch (Exception ex) {
+      assumeNoException("This test requires an internet connection", ex);
+    }
+  }
+}
diff --git a/solr/contrib/uima/src/test/resources/solr-uima/conf/protwords.txt b/solr/contrib/uima/src/test/resources/solr-uima/conf/protwords.txt
new file mode 100644
index 0000000..1dfc0ab
--- /dev/null
+++ b/solr/contrib/uima/src/test/resources/solr-uima/conf/protwords.txt
@@ -0,0 +1,21 @@
+# The ASF licenses this file to You under the Apache License, Version 2.0
+# (the "License"); you may not use this file except in compliance with
+# the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+#-----------------------------------------------------------------------
+# Use a protected word file to protect against the stemmer reducing two
+# unrelated words to the same base word.
+
+# Some non-words that normally won't be encountered,
+# just to test that they won't be stemmed.
+dontstems
+zwhacky
+
diff --git a/solr/contrib/uima/src/test/resources/solr-uima/conf/schema.xml b/solr/contrib/uima/src/test/resources/solr-uima/conf/schema.xml
new file mode 100644
index 0000000..ff447a9
--- /dev/null
+++ b/solr/contrib/uima/src/test/resources/solr-uima/conf/schema.xml
@@ -0,0 +1,679 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+  <!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements. See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version
+    2.0 (the "License"); you may not use this file except in compliance
+    with the License. You may obtain a copy of the License at
+
+    http://www.apache.org/licenses/LICENSE-2.0 Unless required by
+    applicable law or agreed to in writing, software distributed under
+    the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
+    OR CONDITIONS OF ANY KIND, either express or implied. See the
+    License for the specific language governing permissions and
+    limitations under the License.
+  -->
+
+  <!--
+    This is the Solr schema file. This file should be named "schema.xml"
+    and should be in the conf directory under the solr home (i.e.
+    ./solr/conf/schema.xml by default) or located where the classloader
+    for the Solr webapp can find it. This example schema is the
+    recommended starting point for users. It should be kept correct and
+    concise, usable out-of-the-box. For more information, on how to
+    customize this file, please see
+    http://wiki.apache.org/solr/SchemaXml PERFORMANCE NOTE: this schema
+    includes many optional features and should not be used for
+    benchmarking. To improve performance one could - set stored="false"
+    for all fields possible (esp large fields) when you only need to
+    search on the field but don't need to return the original value. -
+    set indexed="false" if you don't need to search on the field, but
+    only return the field as a result of searching on other indexed
+    fields. - remove all unneeded copyField statements - for best index
+    size and searching performance, set "index" to false for all general
+    text fields, use copyField to copy them to the catchall "text"
+    field, and use that for searching. - For maximum indexing
+    performance, use the StreamingUpdateSolrServer java client. -
+    Remember to run the JVM in server mode, and use a higher logging
+    level that avoids logging every request
+  -->
+
+<schema name="sample" version="1.2">
+  <!--
+    attribute "name" is the name of this schema and is only used for
+    display purposes. Applications should change this to reflect the
+    nature of the search collection. version="1.2" is Solr's version
+    number for the schema syntax and semantics. It should not normally
+    be changed by applications. 1.0: multiValued attribute did not
+    exist, all fields are multiValued by nature 1.1: multiValued
+    attribute introduced, false by default 1.2: omitTermFreqAndPositions
+    attribute introduced, true by default except for text fields.
+  -->
+
+  <types>
+    <!--
+      field type definitions. The "name" attribute is just a label to be
+      used by field definitions. The "class" attribute and any other
+      attributes determine the real behavior of the fieldType. Class
+      names starting with "solr" refer to java classes in the
+      org.apache.solr.analysis package.
+    -->
+
+    <!--
+      The StrField type is not analyzed, but indexed/stored verbatim. -
+      StrField and TextField support an optional compressThreshold which
+      limits compression (if enabled in the derived fields) to values
+      which exceed a certain size (in characters).
+    -->
+    <fieldType name="string" class="solr.StrField"
+      sortMissingLast="true" omitNorms="true" />
+
+    <!-- boolean type: "true" or "false" -->
+    <fieldType name="boolean" class="solr.BoolField"
+      sortMissingLast="true" omitNorms="true" />
+    <!--
+      Binary data type. The data should be sent/retrieved in as Base64
+      encoded Strings
+    -->
+    <fieldtype name="binary" class="solr.BinaryField" />
+
+    <!--
+      The optional sortMissingLast and sortMissingFirst attributes are
+      currently supported on types that are sorted internally as
+      strings. This includes
+      "string","boolean","sint","slong","sfloat","sdouble","pdate" - If
+      sortMissingLast="true", then a sort on this field will cause
+      documents without the field to come after documents with the
+      field, regardless of the requested sort order (asc or desc). - If
+      sortMissingFirst="true", then a sort on this field will cause
+      documents without the field to come before documents with the
+      field, regardless of the requested sort order. - If
+      sortMissingLast="false" and sortMissingFirst="false" (the
+      default), then default lucene sorting will be used which places
+      docs without the field first in an ascending sort and last in a
+      descending sort.
+    -->
+
+    <!--
+      Default numeric field types. For faster range queries, consider
+      the tint/tfloat/tlong/tdouble types.
+    -->
+    <fieldType name="int" class="solr.TrieIntField"
+      precisionStep="0" omitNorms="true" positionIncrementGap="0" />
+    <fieldType name="float" class="solr.TrieFloatField"
+      precisionStep="0" omitNorms="true" positionIncrementGap="0" />
+    <fieldType name="long" class="solr.TrieLongField"
+      precisionStep="0" omitNorms="true" positionIncrementGap="0" />
+    <fieldType name="double" class="solr.TrieDoubleField"
+      precisionStep="0" omitNorms="true" positionIncrementGap="0" />
+
+    <!--
+      Numeric field types that index each value at various levels of
+      precision to accelerate range queries when the number of values
+      between the range endpoints is large. See the javadoc for
+      NumericRangeQuery for internal implementation details. Smaller
+      precisionStep values (specified in bits) will lead to more tokens
+      indexed per value, slightly larger index size, and faster range
+      queries. A precisionStep of 0 disables indexing at different
+      precision levels.
+    -->
+    <fieldType name="tint" class="solr.TrieIntField"
+      precisionStep="8" omitNorms="true" positionIncrementGap="0" />
+    <fieldType name="tfloat" class="solr.TrieFloatField"
+      precisionStep="8" omitNorms="true" positionIncrementGap="0" />
+    <fieldType name="tlong" class="solr.TrieLongField"
+      precisionStep="8" omitNorms="true" positionIncrementGap="0" />
+    <fieldType name="tdouble" class="solr.TrieDoubleField"
+      precisionStep="8" omitNorms="true" positionIncrementGap="0" />
+
+    <!--
+      The format for this date field is of the form
+      1995-12-31T23:59:59Z, and is a more restricted form of the
+      canonical representation of dateTime
+      http://www.w3.org/TR/xmlschema-2/#dateTime The trailing "Z"
+      designates UTC time and is mandatory. Optional fractional seconds
+      are allowed: 1995-12-31T23:59:59.999Z All other components are
+      mandatory. Expressions can also be used to denote calculations
+      that should be performed relative to "NOW" to determine the value,
+      ie... NOW/HOUR ... Round to the start of the current hour NOW-1DAY
+      ... Exactly 1 day prior to now NOW/DAY+6MONTHS+3DAYS ... 6 months
+      and 3 days in the future from the start of the current day Consult
+      the DateField javadocs for more information. Note: For faster
+      range queries, consider the tdate type
+    -->
+    <fieldType name="date" class="solr.TrieDateField"
+      omitNorms="true" precisionStep="0" positionIncrementGap="0" />
+
+    <!--
+      A Trie based date field for faster date range queries and date
+      faceting.
+    -->
+    <fieldType name="tdate" class="solr.TrieDateField"
+      omitNorms="true" precisionStep="6" positionIncrementGap="0" />
+
+
+    <!--
+      Note: These should only be used for compatibility with existing
+      indexes (created with older Solr versions) or if
+      "sortMissingFirst" or "sortMissingLast" functionality is needed.
+      Use Trie based fields instead. Plain numeric field types that
+      store and index the text value verbatim (and hence don't support
+      range queries, since the lexicographic ordering isn't equal to the
+      numeric ordering)
+    -->
+    <fieldType name="pint" class="solr.IntField" omitNorms="true" />
+    <fieldType name="plong" class="solr.LongField" omitNorms="true" />
+    <fieldType name="pfloat" class="solr.FloatField"
+      omitNorms="true" />
+    <fieldType name="pdouble" class="solr.DoubleField"
+      omitNorms="true" />
+    <fieldType name="pdate" class="solr.DateField"
+      sortMissingLast="true" omitNorms="true" />
+
+
+    <!--
+      Note: These should only be used for compatibility with existing
+      indexes (created with older Solr versions) or if
+      "sortMissingFirst" or "sortMissingLast" functionality is needed.
+      Use Trie based fields instead. Numeric field types that manipulate
+      the value into a string value that isn't human-readable in its
+      internal form, but with a lexicographic ordering the same as the
+      numeric ordering, so that range queries work correctly.
+    -->
+    <fieldType name="sint" class="solr.SortableIntField"
+      sortMissingLast="true" omitNorms="true" />
+    <fieldType name="slong" class="solr.SortableLongField"
+      sortMissingLast="true" omitNorms="true" />
+    <fieldType name="sfloat" class="solr.SortableFloatField"
+      sortMissingLast="true" omitNorms="true" />
+    <fieldType name="sdouble" class="solr.SortableDoubleField"
+      sortMissingLast="true" omitNorms="true" />
+
+
+    <!--
+      The "RandomSortField" is not used to store or search any data. You
+      can declare fields of this type it in your schema to generate
+      pseudo-random orderings of your docs for sorting purposes. The
+      ordering is generated based on the field name and the version of
+      the index, As long as the index version remains unchanged, and the
+      same field name is reused, the ordering of the docs will be
+      consistent. If you want different psuedo-random orderings of
+      documents, for the same version of the index, use a dynamicField
+      and change the name
+    -->
+    <fieldType name="random" class="solr.RandomSortField"
+      indexed="true" />
+
+    <!--
+      solr.TextField allows the specification of custom text analyzers
+      specified as a tokenizer and a list of token filters. Different
+      analyzers may be specified for indexing and querying. The optional
+      positionIncrementGap puts space between multiple fields of this
+      type on the same document, with the purpose of preventing false
+      phrase matching across fields. For more info on customizing your
+      analyzer chain, please see
+      http://wiki.apache.org/solr/AnalyzersTokenizersTokenFilters
+    -->
+
+    <!--
+      One can also specify an existing Analyzer class that has a default
+      constructor via the class attribute on the analyzer element
+      <fieldType name="text_greek" class="solr.TextField"> <analyzer
+      class="org.apache.lucene.analysis.el.GreekAnalyzer"/> </fieldType>
+    -->
+
+    <!--
+      A text field that only splits on whitespace for exact matching of
+      words
+    -->
+    <fieldType name="text_ws" class="solr.TextField"
+      positionIncrementGap="100">
+      <analyzer>
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+      </analyzer>
+    </fieldType>
+
+    <!--
+      A text field that uses WordDelimiterFilter to enable splitting and
+      matching of words on case-change, alpha numeric boundaries, and
+      non-alphanumeric chars, so that a query of "wifi" or "wi fi" could
+      match a document containing "Wi-Fi". Synonyms and stopwords are
+      customized by external files, and stemming is enabled.
+    -->
+    <fieldType name="text" class="solr.TextField"
+      positionIncrementGap="100">
+      <analyzer type="index">
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <!--
+          in this example, we will only use synonyms at query time
+          <filter class="solr.SynonymFilterFactory"
+          synonyms="index_synonyms.txt" ignoreCase="true"
+          expand="false"/>
+        -->
+        <!--
+          Case insensitive stop word removal. add
+          enablePositionIncrements=true in both the index and query
+          analyzers to leave a 'gap' for more accurate phrase queries.
+        -->
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" enablePositionIncrements="true" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="1" generateNumberParts="1" catenateWords="1"
+          catenateNumbers="1" catenateAll="0" splitOnCaseChange="1" />
+        <filter class="solr.LowerCaseFilterFactory" />
+        
+      </analyzer>
+      <analyzer type="query">
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt"
+          ignoreCase="true" expand="true" />
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" enablePositionIncrements="true" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="1" generateNumberParts="1" catenateWords="0"
+          catenateNumbers="0" catenateAll="0" splitOnCaseChange="1" />
+        <filter class="solr.LowerCaseFilterFactory" />
+        
+      </analyzer>
+    </fieldType>
+
+
+    <!--
+      Less flexible matching, but less false matches. Probably not ideal
+      for product names, but may be good for SKUs. Can insert dashes in
+      the wrong place and still match.
+    -->
+    <fieldType name="textTight" class="solr.TextField"
+      positionIncrementGap="100">
+      <analyzer>
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt"
+          ignoreCase="true" expand="false" />
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="0" generateNumberParts="0" catenateWords="1"
+          catenateNumbers="1" catenateAll="0" />
+        <filter class="solr.LowerCaseFilterFactory" />
+        
+        <!--
+          this filter can remove any duplicate tokens that appear at the
+          same position - sometimes possible with WordDelimiterFilter in
+          conjuncton with stemming.
+        -->
+        <filter class="solr.RemoveDuplicatesTokenFilterFactory" />
+      </analyzer>
+    </fieldType>
+
+
+    <!--
+      A general unstemmed text field - good if one does not know the
+      language of the field
+    -->
+    <fieldType name="textgen" class="solr.TextField"
+      positionIncrementGap="100">
+      <analyzer type="index">
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" enablePositionIncrements="true" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="1" generateNumberParts="1" catenateWords="1"
+          catenateNumbers="1" catenateAll="0" splitOnCaseChange="0" />
+        <filter class="solr.LowerCaseFilterFactory" />
+      </analyzer>
+      <analyzer type="query">
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt"
+          ignoreCase="true" expand="true" />
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" enablePositionIncrements="true" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="1" generateNumberParts="1" catenateWords="0"
+          catenateNumbers="0" catenateAll="0" splitOnCaseChange="0" />
+        <filter class="solr.LowerCaseFilterFactory" />
+      </analyzer>
+    </fieldType>
+
+
+    <!--
+      A general unstemmed text field that indexes tokens normally and
+      also reversed (via ReversedWildcardFilterFactory), to enable more
+      efficient leading wildcard queries.
+    -->
+    <fieldType name="text_rev" class="solr.TextField"
+      positionIncrementGap="100">
+      <analyzer type="index">
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" enablePositionIncrements="true" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="1" generateNumberParts="1" catenateWords="1"
+          catenateNumbers="1" catenateAll="0" splitOnCaseChange="0" />
+        <filter class="solr.LowerCaseFilterFactory" />
+        <filter class="solr.ReversedWildcardFilterFactory"
+          withOriginal="true" maxPosAsterisk="3" maxPosQuestion="2"
+          maxFractionAsterisk="0.33" />
+      </analyzer>
+      <analyzer type="query">
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <filter class="solr.SynonymFilterFactory" synonyms="synonyms.txt"
+          ignoreCase="true" expand="true" />
+        <filter class="solr.StopFilterFactory" ignoreCase="true"
+          words="stopwords.txt" enablePositionIncrements="true" />
+        <filter class="solr.WordDelimiterFilterFactory"
+          generateWordParts="1" generateNumberParts="1" catenateWords="0"
+          catenateNumbers="0" catenateAll="0" splitOnCaseChange="0" />
+        <filter class="solr.LowerCaseFilterFactory" />
+      </analyzer>
+    </fieldType>
+
+    <!-- charFilter + WhitespaceTokenizer  -->
+    <!--
+      <fieldType name="textCharNorm" class="solr.TextField"
+      positionIncrementGap="100" > <analyzer> <charFilter
+      class="solr.MappingCharFilterFactory"
+      mapping="mapping-ISOLatin1Accent.txt"/> <tokenizer
+      class="solr.WhitespaceTokenizerFactory"/> </analyzer> </fieldType>
+    -->
+
+    <!--
+      This is an example of using the KeywordTokenizer along With
+      various TokenFilterFactories to produce a sortable field that does
+      not include some properties of the source text
+    -->
+    <fieldType name="alphaOnlySort" class="solr.TextField"
+      sortMissingLast="true" omitNorms="true">
+      <analyzer>
+        <!--
+          KeywordTokenizer does no actual tokenizing, so the entire
+          input string is preserved as a single token
+        -->
+        <tokenizer class="solr.KeywordTokenizerFactory" />
+        <!--
+          The LowerCase TokenFilter does what you expect, which can be
+          when you want your sorting to be case insensitive
+        -->
+        <filter class="solr.LowerCaseFilterFactory" />
+        <!-- The TrimFilter removes any leading or trailing whitespace -->
+        <filter class="solr.TrimFilterFactory" />
+        <!--
+          The PatternReplaceFilter gives you the flexibility to use Java
+          Regular expression to replace any sequence of characters
+          matching a pattern with an arbitrary replacement string, which
+          may include back references to portions of the original string
+          matched by the pattern. See the Java Regular Expression
+          documentation for more information on pattern and replacement
+          string syntax.
+
+          http://java.sun.com/j2se/1.5.0/docs/api/java/util/regex/package-summary.html
+        -->
+        <filter class="solr.PatternReplaceFilterFactory" pattern="([^a-z])"
+          replacement="" replace="all" />
+      </analyzer>
+    </fieldType>
+
+    <fieldtype name="phonetic" stored="false" indexed="true"
+      class="solr.TextField">
+      <analyzer>
+        <tokenizer class="solr.StandardTokenizerFactory" />
+        <filter class="solr.DoubleMetaphoneFilterFactory" inject="false" />
+      </analyzer>
+    </fieldtype>
+
+    <fieldtype name="payloads" stored="false" indexed="true"
+      class="solr.TextField">
+      <analyzer>
+        <tokenizer class="solr.WhitespaceTokenizerFactory" />
+        <!--
+          The DelimitedPayloadTokenFilter can put payloads on tokens...
+          for example, a token of "foo|1.4" would be indexed as "foo"
+          with a payload of 1.4f Attributes of the
+          DelimitedPayloadTokenFilterFactory : "delimiter" - a one
+          character delimiter. Default is | (pipe) "encoder" - how to
+          encode the following value into a playload float ->
+          org.apache.lucene.analysis.payloads.FloatEncoder, integer ->
+          o.a.l.a.p.IntegerEncoder identity -> o.a.l.a.p.IdentityEncoder
+          Fully Qualified class name implementing PayloadEncoder,
+          Encoder must have a no arg constructor.
+        -->
+        <filter class="solr.DelimitedPayloadTokenFilterFactory"
+          encoder="float" />
+      </analyzer>
+    </fieldtype>
+
+    <!--
+      lowercases the entire field value, keeping it as a single token.
+    -->
+    <fieldType name="lowercase" class="solr.TextField"
+      positionIncrementGap="100">
+      <analyzer>
+        <tokenizer class="solr.KeywordTokenizerFactory" />
+        <filter class="solr.LowerCaseFilterFactory" />
+      </analyzer>
+    </fieldType>
+
+
+    <!--
+      since fields of this type are by default not stored or indexed,
+      any data added to them will be ignored outright.
+    -->
+    <fieldtype name="ignored" stored="false" indexed="false"
+      multiValued="true" class="solr.StrField" />
+
+  </types>
+
+
+  <fields>
+    <!--
+      Valid attributes for fields: name: mandatory - the name for the
+      field type: mandatory - the name of a previously defined type from
+      the <types> section indexed: true if this field should be indexed
+      (searchable or sortable) stored: true if this field should be
+      retrievable compressed: [false] if this field should be stored
+      using gzip compression (this will only apply if the field type is
+      compressable; among the standard field types, only TextField and
+      StrField are) multiValued: true if this field may contain multiple
+      values per document omitNorms: (expert) set to true to omit the
+      norms associated with this field (this disables length
+      normalization and index-time boosting for the field, and saves
+      some memory). Only full-text fields or fields that need an
+      index-time boost need norms. termVectors: [false] set to true to
+      store the term vector for a given field. When using MoreLikeThis,
+      fields used for similarity should be stored for best performance.
+      termPositions: Store position information with the term vector.
+      This will increase storage costs. termOffsets: Store offset
+      information with the term vector. This will increase storage
+      costs. default: a value that should be used if no value is
+      specified when adding a document.
+    -->
+    <field name="id" type="string" indexed="true" stored="true"
+      required="true" />
+    <field name="sku" type="textTight" indexed="true" stored="true"
+      omitNorms="true" />
+    <field name="name" type="textgen" indexed="true" stored="true" />
+    <field name="alphaNameSort" type="alphaOnlySort" indexed="true"
+      stored="false" />
+    <field name="manu" type="textgen" indexed="true" stored="true"
+      omitNorms="true" />
+    <field name="cat" type="text_ws" indexed="true" stored="true"
+      multiValued="true" omitNorms="true" />
+    <field name="features" type="text" indexed="true" stored="true"
+      multiValued="true" />
+    <field name="includes" type="text" indexed="true" stored="true"
+      termVectors="true" termPositions="true" termOffsets="true" />
+
+    <field name="weight" type="float" indexed="true" stored="true" />
+    <field name="price" type="float" indexed="true" stored="true" />
+    <field name="popularity" type="int" indexed="true" stored="true" />
+    <field name="inStock" type="boolean" indexed="true" stored="true" />
+
+
+    <!--
+      Common metadata fields, named specifically to match up with
+      SolrCell metadata when parsing rich documents such as Word, PDF.
+      Some fields are multiValued only because Tika currently may return
+      multiple values for them.
+    -->
+    <field name="title" type="text" indexed="true" stored="true"
+      multiValued="true" />
+    <field name="subject" type="text" indexed="true" stored="true" />
+    <field name="description" type="text" indexed="true" stored="true" />
+    <field name="comments" type="text" indexed="true" stored="true" />
+    <field name="author" type="textgen" indexed="true" stored="true" />
+    <field name="keywords" type="textgen" indexed="true" stored="true" />
+    <field name="category" type="textgen" indexed="true" stored="true" />
+    <field name="content_type" type="string" indexed="true"
+      stored="true" multiValued="true" />
+    <field name="last_modified" type="date" indexed="true" stored="true" />
+    <field name="links" type="string" indexed="true" stored="true"
+      multiValued="true" />
+
+
+    <!--
+      catchall field, containing all other searchable text fields
+      (implemented via copyField further on in this schema
+    -->
+    <field name="text" type="text" indexed="true" stored="false"
+      multiValued="true" />
+
+    <!--
+      catchall text field that indexes tokens both normally and in
+      reverse for efficient leading wildcard queries.
+    -->
+    <field name="text_rev" type="text_rev" indexed="true" stored="false"
+      multiValued="true" />
+
+    <!--
+      non-tokenized version of manufacturer to make it easier to sort or
+      group results by manufacturer. copied from "manu" via copyField
+    -->
+    <field name="manu_exact" type="string" indexed="true" stored="false" />
+
+    <field name="payloads" type="payloads" indexed="true" stored="true" />
+
+    <!--
+      Uncommenting the following will create a "timestamp" field using a
+      default value of "NOW" to indicate when each document was indexed.
+    -->
+    <!--
+      <field name="timestamp" type="date" indexed="true" stored="true"
+      default="NOW" multiValued="false"/>
+    -->
+
+  <field name="language" type="string" indexed="true" stored="true" required="false"/>
+  <field name="concept" type="string" indexed="true" stored="true" multiValued="true" required="false"/>
+  <field name="keyword" type="string" indexed="true" stored="true" multiValued="true" required="false"/>
+  <field name="suggested_category" type="string" indexed="true" stored="true" multiValued="false" required="false"/>
+  <field name="sentence" type="text" indexed="true" stored="true" multiValued="true" required="false" />
+  <dynamicField name="entity*" type="text" indexed="true" stored="true" multiValued="true"/>
+
+    <!--
+      Dynamic field definitions. If a field name is not found,
+      dynamicFields will be used if the name matches any of the
+      patterns. RESTRICTION: the glob-like pattern in the name attribute
+      must have a "*" only at the start or the end. EXAMPLE: name="*_i"
+      will match any field ending in _i (like myid_i, z_i) Longer
+      patterns will be matched first. if equal size patterns both match,
+      the first appearing in the schema will be used. <dynamicField
+      name="*_i" type="int" indexed="true" stored="true"/> <dynamicField
+      name="*_s" type="string" indexed="true" stored="true"/>
+      <dynamicField name="*_l" type="long" indexed="true"
+      stored="true"/> <dynamicField name="*_t" type="text"
+      indexed="true" stored="true"/> <dynamicField name="*_b"
+      type="boolean" indexed="true" stored="true"/> <dynamicField
+      name="*_f" type="float" indexed="true" stored="true"/>
+      <dynamicField name="*_d" type="double" indexed="true"
+      stored="true"/> <dynamicField name="*_dt" type="date"
+      indexed="true" stored="true"/> <dynamicField name="*_ti"
+      type="tint" indexed="true" stored="true"/> <dynamicField
+      name="*_tl" type="tlong" indexed="true" stored="true"/>
+      <dynamicField name="*_tf" type="tfloat" indexed="true"
+      stored="true"/> <dynamicField name="*_td" type="tdouble"
+      indexed="true" stored="true"/> <dynamicField name="*_tdt"
+      type="tdate" indexed="true" stored="true"/> <dynamicField
+      name="*_pi" type="pint" indexed="true" stored="true"/>
+
+      <dynamicField name="ignored_*" type="ignored" multiValued="true"/>
+      <dynamicField name="attr_*" type="textgen" indexed="true"
+      stored="true" multiValued="true"/> <dynamicField name="random_*"
+      type="random" />
+    -->
+    <!--
+      uncomment the following to ignore any fields that don't already
+      match an existing field name or dynamic field, rather than
+      reporting them as an error. alternately, change the type="ignored"
+      to some other type e.g. "text" if you want unknown fields indexed
+      and/or stored by default
+    -->
+    <!--dynamicField name="*" type="ignored" multiValued="true" /-->
+
+  </fields>
+
+  <!--
+    Field to use to determine and enforce document uniqueness. Unless
+    this field is marked with required="false", it will be a required
+    field
+  -->
+  <uniqueKey>id</uniqueKey>
+
+  <!--
+    field for the QueryParser to use when an explicit fieldname is
+    absent
+  -->
+  <defaultSearchField>text</defaultSearchField>
+
+  <!-- SolrQueryParser configuration: defaultOperator="AND|OR" -->
+  <solrQueryParser defaultOperator="OR" />
+
+  <!--
+    copyField commands copy one field to another at the time a document
+    is added to the index. It's used either to index the same field
+    differently, or to add multiple fields to the same field for
+    easier/faster searching.
+  -->
+
+  <copyField source="cat" dest="text" />
+  <copyField source="name" dest="text" />
+  <copyField source="manu" dest="text" />
+  <copyField source="features" dest="text" />
+  <copyField source="includes" dest="text" />
+  <copyField source="manu" dest="manu_exact" />
+
+
+  <!--copyField source="Titolo" dest="text"/-->
+
+  <!--
+    Above, multiple source fields are copied to the [text] field.
+    Another way to map multiple source fields to the same destination
+    field is to use the dynamic field syntax. copyField also supports a
+    maxChars to copy setting.
+  -->
+
+  <!-- <copyField source="*_t" dest="text" maxChars="3000"/> -->
+
+  <!--
+    copy name to alphaNameSort, a field designed for sorting by name
+  -->
+  <!-- <copyField source="name" dest="alphaNameSort"/> -->
+
+
+  <!--
+    Similarity is the scoring routine for each document vs. a query. A
+    custom similarity may be specified here, but the default is fine for
+    most applications.
+  -->
+  <!--
+    <similarity class="org.apache.lucene.search.DefaultSimilarity"/>
+  -->
+  <!--
+    ... OR ... Specify a SimilarityFactory class name implementation
+    allowing parameters to be used.
+  -->
+  <!--
+    <similarity class="com.example.solr.CustomSimilarityFactory"> <str
+    name="paramkey">param value</str> </similarity>
+  -->
+
+
+</schema>
diff --git a/solr/contrib/uima/src/test/resources/solr-uima/conf/solrconfig.xml b/solr/contrib/uima/src/test/resources/solr-uima/conf/solrconfig.xml
new file mode 100644
index 0000000..173505f
--- /dev/null
+++ b/solr/contrib/uima/src/test/resources/solr-uima/conf/solrconfig.xml
@@ -0,0 +1,1108 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+
+  <!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements. See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version
+    2.0 (the "License"); you may not use this file except in compliance
+    with the License. You may obtain a copy of the License at
+
+    http://www.apache.org/licenses/LICENSE-2.0 Unless required by
+    applicable law or agreed to in writing, software distributed under
+    the License is distributed on an "AS IS" BASIS, WITHOUT WARRANTIES
+    OR CONDITIONS OF ANY KIND, either express or implied. See the
+    License for the specific language governing permissions and
+    limitations under the License.
+  -->
+  <!--
+    For more details about configurations options that may appear in
+    this file, see http://wiki.apache.org/solr/SolrConfigXml.
+
+    Specifically, the Solr Config can support XInclude, which may make
+    it easier to manage the configuration. See
+    https://issues.apache.org/jira/browse/SOLR-1167
+  -->
+<config xmlns:xi="http://www.w3.org/2001/XInclude">
+  <!--
+    Set this to 'false' if you want solr to continue working after it
+    has encountered an severe configuration error. In a production
+    environment, you may want solr to keep working even if one handler
+    is mis-configured. You may also set this to false using by setting
+    the system property: -Dsolr.abortOnConfigurationError=false
+  -->
+  <luceneMatchVersion>LUCENE_40</luceneMatchVersion>
+  <abortOnConfigurationError>${solr.abortOnConfigurationError:true}</abortOnConfigurationError>
+
+  <!--
+    lib directives can be used to instruct Solr to load an Jars
+    identified and use them to resolve any "plugins" specified in your
+    solrconfig.xml or schema.xml (ie: Analyzers, Request Handlers,
+    etc...). All directories and paths are resolved relative the
+    instanceDir. If a "./lib" directory exists in your instanceDir, all
+    files found in it are included as if you had used the following
+    syntax... <lib dir="./lib" />
+  -->
+  <!--
+    A dir option by itself adds any files found in the directory to the
+    classpath, this is useful for including all jars in a directory.
+  -->
+  <lib dir="../../contrib/extraction/lib" />
+  <!--
+    When a regex is specified in addition to a directory, only the files
+    in that directory which completely match the regex (anchored on both
+    ends) will be included.
+  -->
+  <lib dir="../../dist/" regex="apache-solr-cell-\d.*\.jar" />
+  <lib dir="../../dist/" regex="apache-solr-clustering-\d.*\.jar" />
+  <!--
+    If a dir option (with or without a regex) is used and nothing is
+    found that matches, it will be ignored
+  -->
+  <lib dir="../../contrib/clustering/lib/downloads/" />
+  <lib dir="../../contrib/clustering/lib/" />
+  <lib dir="/total/crap/dir/ignored" />
+  <!--
+    an exact path can be used to specify a specific file. This will
+    cause a serious error to be logged if it can't be loaded. <lib
+    path="../a-jar-that-does-not-exist.jar" />
+  -->
+
+
+  <!--
+    Used to specify an alternate directory to hold all index data other
+    than the default ./data under the Solr home. If replication is in
+    use, this should match the replication configuration.
+  -->
+  <dataDir>${solr.data.dir:./solr/data}</dataDir>
+
+
+  <!--
+    WARNING: this <indexDefaults> section only provides defaults for
+    index writers in general. See also the <mainIndex> section after
+    that when changing parameters for Solr's main Lucene index.
+  -->
+  <indexDefaults>
+    <!--
+      Values here affect all index writers and act as a default unless
+      overridden.
+    -->
+    <useCompoundFile>false</useCompoundFile>
+
+    <mergeFactor>10</mergeFactor>
+    <!--
+      If both ramBufferSizeMB and maxBufferedDocs is set, then Lucene
+      will flush based on whichever limit is hit first.
+    -->
+    <!--<maxBufferedDocs>1000</maxBufferedDocs>-->
+
+    <!--
+      Sets the amount of RAM that may be used by Lucene indexing for
+      buffering added documents and deletions before they are flushed to
+      the Directory.
+    -->
+    <ramBufferSizeMB>32</ramBufferSizeMB>
+    <!-- <maxMergeDocs>2147483647</maxMergeDocs> -->
+    <maxFieldLength>10000</maxFieldLength>
+    <writeLockTimeout>1000</writeLockTimeout>
+    <commitLockTimeout>10000</commitLockTimeout>
+
+    <!--
+      Expert: Turn on Lucene's auto commit capability. This causes
+      intermediate segment flushes to write a new lucene index
+      descriptor, enabling it to be opened by an external IndexReader.
+      This can greatly slow down indexing speed. NOTE: Despite the name,
+      this value does not have any relation to Solr's autoCommit
+      functionality
+    -->
+    <!--<luceneAutoCommit>false</luceneAutoCommit>-->
+
+    <!--
+      Expert: The Merge Policy in Lucene controls how merging is handled
+      by Lucene. The default in 2.3 is the LogByteSizeMergePolicy,
+      previous versions used LogDocMergePolicy. LogByteSizeMergePolicy
+      chooses segments to merge based on their size. The Lucene 2.2
+      default, LogDocMergePolicy chose when to merge based on number of
+      documents Other implementations of MergePolicy must have a
+      no-argument constructor
+    -->
+    <!--
+      <mergePolicy
+      class="org.apache.lucene.index.LogByteSizeMergePolicy"/>
+    -->
+
+    <!--
+      Expert: The Merge Scheduler in Lucene controls how merges are
+      performed. The ConcurrentMergeScheduler (Lucene 2.3 default) can
+      perform merges in the background using separate threads. The
+      SerialMergeScheduler (Lucene 2.2 default) does not.
+    -->
+    <!--
+      <mergeScheduler
+      class="org.apache.lucene.index.ConcurrentMergeScheduler"/>
+    -->
+
+
+    <!--
+      This option specifies which Lucene LockFactory implementation to
+      use. single = SingleInstanceLockFactory - suggested for a
+      read-only index or when there is no possibility of another process
+      trying to modify the index. native = NativeFSLockFactory - uses OS
+      native file locking simple = SimpleFSLockFactory - uses a plain
+      file for locking (For backwards compatibility with Solr 1.2,
+      'simple' is the default if not specified.)
+    -->
+    <lockType>native</lockType>
+    <!--
+      Expert: Controls how often Lucene loads terms into memory
+    -->
+    <!--<termIndexInterval>256</termIndexInterval>-->
+  </indexDefaults>
+
+  <mainIndex>
+    <!-- options specific to the main on-disk lucene index -->
+    <useCompoundFile>false</useCompoundFile>
+    <ramBufferSizeMB>32</ramBufferSizeMB>
+    <mergeFactor>10</mergeFactor>
+    <!-- Deprecated -->
+    <!--<maxBufferedDocs>1000</maxBufferedDocs>-->
+    <!--<maxMergeDocs>2147483647</maxMergeDocs>-->
+
+    <!--
+      inherit from indexDefaults <maxFieldLength>10000</maxFieldLength>
+    -->
+
+    <!--
+      If true, unlock any held write or commit locks on startup. This
+      defeats the locking mechanism that allows multiple processes to
+      safely access a lucene index, and should be used with care. This
+      is not needed if lock type is 'none' or 'single'
+    -->
+    <unlockOnStartup>false</unlockOnStartup>
+
+    <!--
+      If true, IndexReaders will be reopened (often more efficient)
+      instead of closed and then opened.
+    -->
+    <reopenReaders>true</reopenReaders>
+
+    <!--
+      Expert: Controls how often Lucene loads terms into memory. Default
+      is 128 and is likely good for most everyone.
+    -->
+    <!--<termIndexInterval>256</termIndexInterval>-->
+
+    <!--
+      Custom deletion policies can specified here. The class must
+      implement org.apache.lucene.index.IndexDeletionPolicy.
+
+      http://lucene.apache.org/java/2_3_2/api/org/apache/lucene/index/IndexDeletionPolicy.html
+
+      The standard Solr IndexDeletionPolicy implementation supports
+      deleting index commit points on number of commits, age of commit
+      point and optimized status. The latest commit point should always
+      be preserved regardless of the criteria.
+    -->
+    <deletionPolicy class="solr.SolrDeletionPolicy">
+      <!-- The number of commit points to be kept -->
+      <str name="maxCommitsToKeep">1</str>
+      <!-- The number of optimized commit points to be kept -->
+      <str name="maxOptimizedCommitsToKeep">0</str>
+      <!--
+        Delete all commit points once they have reached the given age.
+        Supports DateMathParser syntax e.g. <str
+        name="maxCommitAge">30MINUTES</str> <str
+        name="maxCommitAge">1DAY</str>
+      -->
+    </deletionPolicy>
+
+    <!--
+      To aid in advanced debugging, you may turn on IndexWriter debug
+      logging. Setting to true will set the file that the underlying
+      Lucene IndexWriter will write its debug infostream to.
+    -->
+    <infoStream file="INFOSTREAM.txt">false</infoStream>
+
+  </mainIndex>
+
+  <!--
+    Enables JMX if and only if an existing MBeanServer is found, use
+    this if you want to configure JMX through JVM parameters. Remove
+    this to disable exposing Solr configuration and statistics to JMX.
+
+    If you want to connect to a particular server, specify the agentId
+    e.g. <jmx agentId="myAgent" /> If you want to start a new
+    MBeanServer, specify the serviceUrl e.g <jmx
+    serviceUrl="service:jmx:rmi:///jndi/rmi://localhost:9999/solr"/> For
+    more details see http://wiki.apache.org/solr/SolrJmx
+  -->
+  <jmx />
+
+  <!-- the default high-performance update handler -->
+  <updateHandler class="solr.DirectUpdateHandler2">
+    <!--
+      A prefix of "solr." for class names is an alias that causes solr
+      to search appropriate packages, including
+      org.apache.solr.(search|update|request|core|analysis)
+    -->
+
+    <!--
+      Perform a <commit/> automatically under certain conditions:
+      maxDocs - number of updates since last commit is greater than this
+      maxTime - oldest uncommited update (in ms) is this long ago
+      Instead of enabling autoCommit, consider using "commitWithin" when
+      adding documents. http://wiki.apache.org/solr/UpdateXmlMessages
+      <autoCommit> <maxDocs>10000</maxDocs> <maxTime>1000</maxTime>
+      </autoCommit>
+    -->
+
+
+    <!--
+      The RunExecutableListener executes an external command from a hook
+      such as postCommit or postOptimize. exe - the name of the
+      executable to run dir - dir to use as the current working
+      directory. default="." wait - the calling thread waits until the
+      executable returns. default="true" args - the arguments to pass to
+      the program. default=nothing env - environment variables to set.
+      default=nothing
+    -->
+    <!--
+      A postCommit event is fired after every commit or optimize command
+      <listener event="postCommit" class="solr.RunExecutableListener">
+      <str name="exe">solr/bin/snapshooter</str> <str name="dir">.</str>
+      <bool name="wait">true</bool> <arr name="args"> <str>arg1</str>
+      <str>arg2</str> </arr> <arr name="env"> <str>MYVAR=val1</str>
+      </arr> </listener>
+    -->
+    <!--
+      A postOptimize event is fired only after every optimize command
+      <listener event="postOptimize" class="solr.RunExecutableListener">
+      <str name="exe">snapshooter</str> <str name="dir">solr/bin</str>
+      <bool name="wait">true</bool> </listener>
+    -->
+
+  </updateHandler>
+
+  <!--
+    Use the following format to specify a custom IndexReaderFactory -
+    allows for alternate IndexReader implementations. ** Experimental
+    Feature ** Please note - Using a custom IndexReaderFactory may
+    prevent certain other features from working. The API to
+    IndexReaderFactory may change without warning or may even be removed
+    from future releases if the problems cannot be resolved. ** Features
+    that may not work with custom IndexReaderFactory ** The
+    ReplicationHandler assumes a disk-resident index. Using a custom
+    IndexReader implementation may cause incompatibility with
+    ReplicationHandler and may cause replication to not work correctly.
+    See SOLR-1366 for details. <indexReaderFactory
+    name="IndexReaderFactory" class="package.class"> Parameters as
+    required by the implementation </indexReaderFactory >
+  -->
+  <!-- To set the termInfosIndexDivisor, do this: -->
+  <!--
+    <indexReaderFactory name="IndexReaderFactory"
+    class="org.apache.solr.core.StandardIndexReaderFactory"> <int
+    name="termInfosIndexDivisor">12</int> </indexReaderFactory >
+  -->
+
+
+  <query>
+    <!--
+      Maximum number of clauses in a boolean query... in the past, this
+      affected range or prefix queries that expanded to big boolean
+      queries - built in Solr query parsers no longer create queries
+      with this limitation. An exception is thrown if exceeded.
+    -->
+    <maxBooleanClauses>1024</maxBooleanClauses>
+
+
+    <!--
+      There are two implementations of cache available for Solr,
+      LRUCache, based on a synchronized LinkedHashMap, and FastLRUCache,
+      based on a ConcurrentHashMap. FastLRUCache has faster gets and
+      slower puts in single threaded operation and thus is generally
+      faster than LRUCache when the hit ratio of the cache is high (>
+      75%), and may be faster under other scenarios on multi-cpu
+      systems.
+    -->
+    <!--
+      Cache used by SolrIndexSearcher for filters (DocSets), unordered
+      sets of *all* documents that match a query. When a new searcher is
+      opened, its caches may be prepopulated or "autowarmed" using data
+      from caches in the old searcher. autowarmCount is the number of
+      items to prepopulate. For LRUCache, the autowarmed items will be
+      the most recently accessed items. Parameters: class - the
+      SolrCache implementation LRUCache or FastLRUCache size - the
+      maximum number of entries in the cache initialSize - the initial
+      capacity (number of entries) of the cache. (seel
+      java.util.HashMap) autowarmCount - the number of entries to
+      prepopulate from and old cache.
+    -->
+    <filterCache class="solr.FastLRUCache" size="512"
+      initialSize="512" autowarmCount="0" />
+
+    <!--
+      Cache used to hold field values that are quickly accessible by
+      document id. The fieldValueCache is created by default even if not
+      configured here. <fieldValueCache class="solr.FastLRUCache"
+      size="512" autowarmCount="128" showItems="32" />
+    -->
+
+    <!--
+      queryResultCache caches results of searches - ordered lists of
+      document ids (DocList) based on a query, a sort, and the range of
+      documents requested.
+    -->
+    <queryResultCache class="solr.LRUCache" size="512"
+      initialSize="512" autowarmCount="0" />
+
+    <!--
+      documentCache caches Lucene Document objects (the stored fields
+      for each document). Since Lucene internal document ids are
+      transient, this cache will not be autowarmed.
+    -->
+    <documentCache class="solr.LRUCache" size="512"
+      initialSize="512" autowarmCount="0" />
+
+    <!--
+      If true, stored fields that are not requested will be loaded
+      lazily. This can result in a significant speed improvement if the
+      usual case is to not load all stored fields, especially if the
+      skipped fields are large compressed text fields.
+    -->
+    <enableLazyFieldLoading>true</enableLazyFieldLoading>
+
+    <!--
+      Example of a generic cache. These caches may be accessed by name
+      through SolrIndexSearcher.getCache(),cacheLookup(), and
+      cacheInsert(). The purpose is to enable easy caching of
+      user/application level data. The regenerator argument should be
+      specified as an implementation of solr.search.CacheRegenerator if
+      autowarming is desired.
+    -->
+    <!--
+      <cache name="myUserCache" class="solr.LRUCache" size="4096"
+      initialSize="1024" autowarmCount="1024"
+      regenerator="org.mycompany.mypackage.MyRegenerator" />
+    -->
+
+    <!--
+      An optimization that attempts to use a filter to satisfy a search.
+      If the requested sort does not include score, then the filterCache
+      will be checked for a filter matching the query. If found, the
+      filter will be used as the source of document ids, and then the
+      sort will be applied to that.
+      <useFilterForSortedQuery>true</useFilterForSortedQuery>
+    -->
+
+    <!--
+      An optimization for use with the queryResultCache. When a search
+      is requested, a superset of the requested number of document ids
+      are collected. For example, if a search for a particular query
+      requests matching documents 10 through 19, and queryWindowSize is
+      50, then documents 0 through 49 will be collected and cached. Any
+      further requests in that range can be satisfied via the cache.
+    -->
+    <queryResultWindowSize>20</queryResultWindowSize>
+
+    <!--
+      Maximum number of documents to cache for any entry in the
+      queryResultCache.
+    -->
+    <queryResultMaxDocsCached>200</queryResultMaxDocsCached>
+
+    <!--
+      a newSearcher event is fired whenever a new searcher is being
+      prepared and there is a current searcher handling requests (aka
+      registered). It can be used to prime certain caches to prevent
+      long request times for certain requests.
+    -->
+    <!--
+      QuerySenderListener takes an array of NamedList and executes a
+      local query request for each NamedList in sequence.
+    -->
+    <listener event="newSearcher" class="solr.QuerySenderListener">
+      <arr name="queries">
+        <!--
+          <lst> <str name="q">solr</str> <str name="start">0</str> <str
+          name="rows">10</str> </lst> <lst> <str name="q">rocks</str>
+          <str name="start">0</str> <str name="rows">10</str> </lst>
+          <lst><str name="q">static newSearcher warming query from
+          solrconfig.xml</str></lst>
+        -->
+      </arr>
+    </listener>
+
+    <!--
+      a firstSearcher event is fired whenever a new searcher is being
+      prepared but there is no current registered searcher to handle
+      requests or to gain autowarming data from.
+    -->
+    <listener event="firstSearcher" class="solr.QuerySenderListener">
+      <arr name="queries">
+        <lst>
+          <str name="q">solr rocks</str>
+          <str name="start">0</str>
+          <str name="rows">10</str>
+        </lst>
+        <lst>
+          <str name="q">static firstSearcher warming query from
+            solrconfig.xml</str>
+        </lst>
+      </arr>
+    </listener>
+
+    <!--
+      If a search request comes in and there is no current registered
+      searcher, then immediately register the still warming searcher and
+      use it. If "false" then all requests will block until the first
+      searcher is done warming.
+    -->
+    <useColdSearcher>false</useColdSearcher>
+
+    <!--
+      Maximum number of searchers that may be warming in the background
+      concurrently. An error is returned if this limit is exceeded.
+      Recommend 1-2 for read-only slaves, higher for masters w/o cache
+      warming.
+    -->
+    <maxWarmingSearchers>2</maxWarmingSearchers>
+
+  </query>
+
+  <!--
+    Let the dispatch filter handler /select?qt=XXX handleSelect=true
+    will use consistent error handling for /select and /update
+    handleSelect=false will use solr1.1 style error formatting
+  -->
+  <requestDispatcher handleSelect="true">
+    <!--
+      Make sure your system has some authentication before enabling
+      remote streaming!
+    -->
+    <requestParsers enableRemoteStreaming="true"
+      multipartUploadLimitInKB="2048000" />
+
+    <!--
+      Set HTTP caching related parameters (for proxy caches and
+      clients). To get the behaviour of Solr 1.2 (ie: no caching related
+      headers) use the never304="true" option and do not specify a value
+      for <cacheControl>
+    -->
+    <!-- <httpCaching never304="true"> -->
+    <httpCaching lastModifiedFrom="openTime" etagSeed="Solr">
+      <!--
+        lastModFrom="openTime" is the default, the Last-Modified value
+        (and validation against If-Modified-Since requests) will all be
+        relative to when the current Searcher was opened. You can change
+        it to lastModFrom="dirLastMod" if you want the value to exactly
+        corrispond to when the physical index was last modified.
+
+        etagSeed="..." is an option you can change to force the ETag
+        header (and validation against If-None-Match requests) to be
+        differnet even if the index has not changed (ie: when making
+        significant changes to your config file) lastModifiedFrom and
+        etagSeed are both ignored if you use the never304="true" option.
+      -->
+      <!--
+        If you include a <cacheControl> directive, it will be used to
+        generate a Cache-Control header, as well as an Expires header if
+        the value contains "max-age=" By default, no Cache-Control
+        header is generated. You can use the <cacheControl> option even
+        if you have set never304="true"
+      -->
+      <!-- <cacheControl>max-age=30, public</cacheControl> -->
+    </httpCaching>
+  </requestDispatcher>
+
+
+  <!--
+    requestHandler plugins... incoming queries will be dispatched to the
+    correct handler based on the path or the qt (query type) param.
+    Names starting with a '/' are accessed with the a path equal to the
+    registered name. Names without a leading '/' are accessed with:
+    http://host/app/select?qt=name If no qt is defined, the
+    requestHandler that declares default="true" will be used.
+  -->
+  <requestHandler name="standard" class="solr.SearchHandler"
+    default="true">
+    <!-- default values for query parameters -->
+    <lst name="defaults">
+      <str name="echoParams">explicit</str>
+      <!--
+        <int name="rows">10</int> <str name="fl">*</str> <str
+        name="version">2.1</str>
+      -->
+    </lst>
+  </requestHandler>
+
+  <!--
+    Please refer to http://wiki.apache.org/solr/SolrReplication for
+    details on configuring replication
+  -->
+  <!-- remove the <lst name="master"> section if this is just a slave -->
+  <!-- remove  the <lst name="slave"> section if this is just a master -->
+  <!--
+    <requestHandler name="/replication" class="solr.ReplicationHandler"
+    > <lst name="master"> <str name="replicateAfter">commit</str> <str
+    name="replicateAfter">startup</str> <str
+    name="confFiles">schema.xml,stopwords.txt</str> </lst> <lst
+    name="slave"> <str
+    name="masterUrl">http://localhost:8983/solr/replication</str> <str
+    name="pollInterval">00:00:60</str> </lst> </requestHandler>
+  -->
+
+  <!--
+    DisMaxRequestHandler allows easy searching across multiple fields
+    for simple user-entered phrases. It's implementation is now just the
+    standard SearchHandler with a default query type of "dismax". see
+    http://wiki.apache.org/solr/DisMaxRequestHandler
+  -->
+  <requestHandler name="dismax" class="solr.SearchHandler">
+    <lst name="defaults">
+      <str name="defType">dismax</str>
+      <str name="echoParams">explicit</str>
+      <float name="tie">0.01</float>
+      <str name="qf">
+        text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0
+        manu^1.1 cat^1.4
+     </str>
+      <str name="pf">
+        text^0.2 features^1.1 name^1.5 manu^1.4
+        manu_exact^1.9
+     </str>
+      <str name="bf">
+        popularity^0.5 recip(price,1,1000,1000)^0.3
+     </str>
+      <str name="fl">
+        id,name,price,score
+     </str>
+      <str name="mm">
+        2&lt;-1 5&lt;-2 6&lt;90% </str>
+      <int name="ps">100</int>
+      <str name="q.alt">*:*</str>
+      <!-- example highlighter config, enable per-query with hl=true -->
+      <str name="hl.fl">text features name</str>
+      <!-- for this field, we want no fragmenting, just highlighting -->
+      <str name="f.name.hl.fragsize">0</str>
+      <!--
+        instructs Solr to return the field itself if no query terms are
+        found
+      -->
+      <str name="f.name.hl.alternateField">name</str>
+      <str name="f.text.hl.fragmenter">regex</str> <!-- defined below -->
+    </lst>
+  </requestHandler>
+
+  <!--
+    Note how you can register the same handler multiple times with
+    different names (and different init parameters)
+  -->
+  <requestHandler name="partitioned" class="solr.SearchHandler">
+    <lst name="defaults">
+      <str name="defType">dismax</str>
+      <str name="echoParams">explicit</str>
+      <str name="qf">text^0.5 features^1.0 name^1.2 sku^1.5 id^10.0</str>
+      <str name="mm">2&lt;-1 5&lt;-2 6&lt;90%</str>
+      <!--
+        This is an example of using Date Math to specify a constantly
+        moving date range in a config...
+      -->
+      <str name="bq">incubationdate_dt:[* TO NOW/DAY-1MONTH]^2.2</str>
+    </lst>
+    <!--
+      In addition to defaults, "appends" params can be specified to
+      identify values which should be appended to the list of multi-val
+      params from the query (or the existing "defaults"). In this
+      example, the param "fq=instock:true" will be appended to any query
+      time fq params the user may specify, as a mechanism for
+      partitioning the index, independent of any user selected filtering
+      that may also be desired (perhaps as a result of faceted
+      searching). NOTE: there is *absolutely* nothing a client can do to
+      prevent these "appends" values from being used, so don't use this
+      mechanism unless you are sure you always want it.
+    -->
+    <lst name="appends">
+      <str name="fq">inStock:true</str>
+    </lst>
+    <!--
+      "invariants" are a way of letting the Solr maintainer lock down
+      the options available to Solr clients. Any params values specified
+      here are used regardless of what values may be specified in either
+      the query, the "defaults", or the "appends" params. In this
+      example, the facet.field and facet.query params are fixed,
+      limiting the facets clients can use. Faceting is not turned on by
+      default - but if the client does specify facet=true in the
+      request, these are the only facets they will be able to see counts
+      for; regardless of what other facet.field or facet.query params
+      they may specify. NOTE: there is *absolutely* nothing a client can
+      do to prevent these "invariants" values from being used, so don't
+      use this mechanism unless you are sure you always want it.
+    -->
+    <lst name="invariants">
+      <str name="facet.field">cat</str>
+      <str name="facet.field">manu_exact</str>
+      <str name="facet.query">price:[* TO 500]</str>
+      <str name="facet.query">price:[500 TO *]</str>
+    </lst>
+  </requestHandler>
+
+
+  <!--
+    Search components are registered to SolrCore and used by Search
+    Handlers By default, the following components are avaliable:
+
+    <searchComponent name="query"
+    class="org.apache.solr.handler.component.QueryComponent" />
+    <searchComponent name="facet"
+    class="org.apache.solr.handler.component.FacetComponent" />
+    <searchComponent name="mlt"
+    class="org.apache.solr.handler.component.MoreLikeThisComponent" />
+    <searchComponent name="highlight"
+    class="org.apache.solr.handler.component.HighlightComponent" />
+    <searchComponent name="stats"
+    class="org.apache.solr.handler.component.StatsComponent" />
+    <searchComponent name="debug"
+    class="org.apache.solr.handler.component.DebugComponent" /> Default
+    configuration in a requestHandler would look like: <arr
+    name="components"> <str>query</str> <str>facet</str> <str>mlt</str>
+    <str>highlight</str> <str>stats</str> <str>debug</str> </arr> If you
+    register a searchComponent to one of the standard names, that will
+    be used instead. To insert components before or after the 'standard'
+    components, use: <arr name="first-components">
+    <str>myFirstComponentName</str> </arr> <arr name="last-components">
+    <str>myLastComponentName</str> </arr>
+  -->
+
+  <!--
+    The spell check component can return a list of alternative spelling
+    suggestions.
+  -->
+  <searchComponent name="spellcheck" class="solr.SpellCheckComponent">
+
+    <str name="queryAnalyzerFieldType">textSpell</str>
+
+    <lst name="spellchecker">
+      <str name="name">default</str>
+      <str name="field">name</str>
+      <str name="spellcheckIndexDir">./spellchecker</str>
+    </lst>
+
+    <!--
+      a spellchecker that uses a different distance measure <lst
+      name="spellchecker"> <str name="name">jarowinkler</str> <str
+      name="field">spell</str> <str
+      name="distanceMeasure">org.apache.lucene.search.spell.JaroWinklerDistance</str>
+      <str name="spellcheckIndexDir">./spellchecker2</str> </lst>
+    -->
+
+    <!--
+      a file based spell checker <lst name="spellchecker"> <str
+      name="classname">solr.FileBasedSpellChecker</str> <str
+      name="name">file</str> <str
+      name="sourceLocation">spellings.txt</str> <str
+      name="characterEncoding">UTF-8</str> <str
+      name="spellcheckIndexDir">./spellcheckerFile</str> </lst>
+    -->
+  </searchComponent>
+
+  <!--
+    A request handler utilizing the spellcheck component.
+    #############################################################################
+    NOTE: This is purely as an example. The whole purpose of the
+    SpellCheckComponent is to hook it into the request handler that
+    handles (i.e. the standard or dismax SearchHandler) queries such
+    that a separate request is not needed to get suggestions. IN OTHER
+    WORDS, THERE IS REALLY GOOD CHANCE THE SETUP BELOW IS NOT WHAT YOU
+    WANT FOR YOUR PRODUCTION SYSTEM!
+    #############################################################################
+  -->
+  <requestHandler name="/spell" class="solr.SearchHandler"
+    lazy="true">
+    <lst name="defaults">
+      <!-- omp = Only More Popular -->
+      <str name="spellcheck.onlyMorePopular">false</str>
+      <!-- exr = Extended Results -->
+      <str name="spellcheck.extendedResults">false</str>
+      <!--  The number of suggestions to return -->
+      <str name="spellcheck.count">1</str>
+    </lst>
+    <arr name="last-components">
+      <str>spellcheck</str>
+    </arr>
+  </requestHandler>
+
+  <searchComponent name="tvComponent"
+    class="org.apache.solr.handler.component.TermVectorComponent" />
+  <!--
+    A Req Handler for working with the tvComponent. This is purely as an
+    example. You will likely want to add the component to your already
+    specified request handlers.
+  -->
+  <requestHandler name="tvrh"
+    class="org.apache.solr.handler.component.SearchHandler">
+    <lst name="defaults">
+      <bool name="tv">true</bool>
+    </lst>
+    <arr name="last-components">
+      <str>tvComponent</str>
+    </arr>
+  </requestHandler>
+
+  <!--
+    Clustering Component http://wiki.apache.org/solr/ClusteringComponent
+    This relies on third party jars which are not included in the
+    release. To use this component (and the "/clustering" handler) Those
+    jars will need to be downloaded, and you'll need to set the
+    solr.cluster.enabled system property when running solr... java
+    -Dsolr.clustering.enabled=true -jar start.jar
+  -->
+  <searchComponent name="clusteringComponent"
+    enable="${solr.clustering.enabled:false}" class="org.apache.solr.handler.clustering.ClusteringComponent">
+    <!-- Declare an engine -->
+    <lst name="engine">
+      <!-- The name, only one can be named "default" -->
+      <str name="name">default</str>
+      <!--
+        Class name of Carrot2 clustering algorithm. Currently available
+        algorithms are: *
+        org.carrot2.clustering.lingo.LingoClusteringAlgorithm *
+        org.carrot2.clustering.stc.STCClusteringAlgorithm See
+        http://project.carrot2.org/algorithms.html for the algorithm's
+        characteristics.
+      -->
+      <str name="carrot.algorithm">org.carrot2.clustering.lingo.LingoClusteringAlgorithm</str>
+      <!--
+        Overriding values for Carrot2 default algorithm attributes. For
+        a description of all available attributes, see:
+        http://download.carrot2.org/stable/manual/#chapter.components.
+        Use attribute key as name attribute of str elements below. These
+        can be further overridden for individual requests by specifying
+        attribute key as request parameter name and attribute value as
+        parameter value.
+      -->
+      <str name="LingoClusteringAlgorithm.desiredClusterCountBase">20</str>
+    </lst>
+    <lst name="engine">
+      <str name="name">stc</str>
+      <str name="carrot.algorithm">org.carrot2.clustering.stc.STCClusteringAlgorithm</str>
+    </lst>
+  </searchComponent>
+  <requestHandler name="/clustering" enable="${solr.clustering.enabled:false}"
+    class="solr.SearchHandler">
+    <lst name="defaults">
+      <bool name="clustering">true</bool>
+      <str name="clustering.engine">default</str>
+      <bool name="clustering.results">true</bool>
+      <!-- The title field -->
+      <str name="carrot.title">name</str>
+      <str name="carrot.url">id</str>
+      <!-- The field to cluster on -->
+      <str name="carrot.snippet">features</str>
+      <!-- produce summaries -->
+      <bool name="carrot.produceSummary">true</bool>
+      <!-- the maximum number of labels per cluster -->
+      <!--<int name="carrot.numDescriptions">5</int>-->
+      <!-- produce sub clusters -->
+      <bool name="carrot.outputSubClusters">false</bool>
+    </lst>
+    <arr name="last-components">
+      <str>clusteringComponent</str>
+    </arr>
+  </requestHandler>
+
+  <!-- Solr Cell: http://wiki.apache.org/solr/ExtractingRequestHandler -->
+  <requestHandler name="/update/extract"
+    class="org.apache.solr.handler.extraction.ExtractingRequestHandler"
+    startup="lazy">
+    <lst name="defaults">
+      <!--
+        All the main content goes into "text"... if you need to return
+        the extracted text or do highlighting, use a stored field.
+      -->
+      <str name="fmap.content">text</str>
+      <str name="lowernames">true</str>
+      <str name="uprefix">ignored_</str>
+
+      <!-- capture link hrefs but ignore div attributes -->
+      <str name="captureAttr">true</str>
+      <str name="fmap.a">links</str>
+      <str name="fmap.div">ignored_</str>
+    </lst>
+  </requestHandler>
+
+
+  <!--
+    A component to return terms and document frequency of those terms.
+    This component does not yet support distributed search.
+  -->
+  <searchComponent name="termsComponent"
+    class="org.apache.solr.handler.component.TermsComponent" />
+
+  <requestHandler name="/terms"
+    class="org.apache.solr.handler.component.SearchHandler">
+    <lst name="defaults">
+      <bool name="terms">true</bool>
+    </lst>
+    <arr name="components">
+      <str>termsComponent</str>
+    </arr>
+  </requestHandler>
+
+
+
+
+  <!--
+    Update request handler. Note: Since solr1.1 requestHandlers requires
+    a valid content type header if posted in the body. For example, curl
+    now requires: -H 'Content-type:text/xml; charset=utf-8' The response
+    format differs from solr1.1 formatting and returns a standard error
+    code. To enable solr1.1 behavior, remove the /update handler or
+    change its path
+  -->
+  <requestHandler name="/update" class="solr.XmlUpdateRequestHandler">
+    <lst name="defaults">
+      <str name="update.processor">uima</str>
+    </lst>
+  </requestHandler>
+
+
+  <requestHandler name="/update/javabin" class="solr.BinaryUpdateRequestHandler" />
+
+  <!--
+    Analysis request handler. Since Solr 1.3. Use to return how a
+    document is analyzed. Useful for debugging and as a token server for
+    other types of applications. This is deprecated in favor of the
+    improved DocumentAnalysisRequestHandler and
+    FieldAnalysisRequestHandler <requestHandler name="/analysis"
+    class="solr.AnalysisRequestHandler" />
+  -->
+
+  <!--
+    An analysis handler that provides a breakdown of the analysis
+    process of provided docuemnts. This handler expects a (single)
+    content stream with the following format: <docs> <doc> <field
+    name="id">1</field> <field name="name">The Name</field> <field
+    name="text">The Text Value</field> <doc> <doc>...</doc>
+    <doc>...</doc> ... </docs> Note: Each document must contain a field
+    which serves as the unique key. This key is used in the returned
+    response to assoicate an analysis breakdown to the analyzed
+    document. Like the FieldAnalysisRequestHandler, this handler also
+    supports query analysis by sending either an "analysis.query" or "q"
+    request paraemter that holds the query text to be analyized. It also
+    supports the "analysis.showmatch" parameter which when set to true,
+    all field tokens that match the query tokens will be marked as a
+    "match".
+  -->
+  <requestHandler name="/analysis/document"
+    class="solr.DocumentAnalysisRequestHandler" />
+
+  <!--
+    RequestHandler that provides much the same functionality as
+    analysis.jsp. Provides the ability to specify multiple field types
+    and field names in the same request and outputs index-time and
+    query-time analysis for each of them. Request parameters are:
+    analysis.fieldname - The field name whose analyzers are to be used
+    analysis.fieldtype - The field type whose analyzers are to be used
+    analysis.fieldvalue - The text for index-time analysis q (or
+    analysis.q) - The text for query time analysis analysis.showmatch
+    (true|false) - When set to true and when query analysis is
+    performed, the produced tokens of the field value analysis will be
+    marked as "matched" for every token that is produces by the query
+    analysis
+  -->
+  <requestHandler name="/analysis/field" class="solr.FieldAnalysisRequestHandler" />
+
+
+  <!-- CSV update handler, loaded on demand -->
+  <requestHandler name="/update/csv" class="solr.CSVRequestHandler"
+    startup="lazy" />
+
+
+  <!--
+    Admin Handlers - This will register all the standard admin
+    RequestHandlers. Adding this single handler is equivalent to
+    registering: <requestHandler name="/admin/luke"
+    class="org.apache.solr.handler.admin.LukeRequestHandler" />
+    <requestHandler name="/admin/system"
+    class="org.apache.solr.handler.admin.SystemInfoHandler" />
+    <requestHandler name="/admin/plugins"
+    class="org.apache.solr.handler.admin.PluginInfoHandler" />
+    <requestHandler name="/admin/threads"
+    class="org.apache.solr.handler.admin.ThreadDumpHandler" />
+    <requestHandler name="/admin/properties"
+    class="org.apache.solr.handler.admin.PropertiesRequestHandler" />
+    <requestHandler name="/admin/file"
+    class="org.apache.solr.handler.admin.ShowFileRequestHandler" > If
+    you wish to hide files under ${solr.home}/conf, explicitly register
+    the ShowFileRequestHandler using: <requestHandler name="/admin/file"
+    class="org.apache.solr.handler.admin.ShowFileRequestHandler" > <lst
+    name="invariants"> <str name="hidden">synonyms.txt</str> <str
+    name="hidden">anotherfile.txt</str> </lst> </requestHandler>
+  -->
+  <requestHandler name="/admin/"
+    class="org.apache.solr.handler.admin.AdminHandlers" />
+
+  <!-- ping/healthcheck -->
+  <requestHandler name="/admin/ping" class="PingRequestHandler">
+    <lst name="defaults">
+      <str name="qt">standard</str>
+      <str name="q">solrpingquery</str>
+      <str name="echoParams">all</str>
+    </lst>
+  </requestHandler>
+
+  <!-- Echo the request contents back to the client -->
+  <requestHandler name="/debug/dump" class="solr.DumpRequestHandler">
+    <lst name="defaults">
+      <str name="echoParams">explicit</str> <!-- for all params (including the default etc) use: 'all' -->
+      <str name="echoHandler">true</str>
+    </lst>
+  </requestHandler>
+
+  <highlighting>
+    <!-- Configure the standard fragmenter -->
+    <!-- This could most likely be commented out in the "default" case -->
+    <fragmenter name="gap"
+      class="org.apache.solr.highlight.GapFragmenter" default="true">
+      <lst name="defaults">
+        <int name="hl.fragsize">100</int>
+      </lst>
+    </fragmenter>
+
+    <!--
+      A regular-expression-based fragmenter (f.i., for sentence
+      extraction)
+    -->
+    <fragmenter name="regex"
+      class="org.apache.solr.highlight.RegexFragmenter">
+      <lst name="defaults">
+        <!-- slightly smaller fragsizes work better because of slop -->
+        <int name="hl.fragsize">70</int>
+        <!-- allow 50% slop on fragment sizes -->
+        <float name="hl.regex.slop">0.5</float>
+        <!-- a basic sentence pattern -->
+        <str name="hl.regex.pattern">[-\w ,/\n\"']{20,200}</str>
+      </lst>
+    </fragmenter>
+
+    <!-- Configure the standard formatter -->
+    <formatter name="html" class="org.apache.solr.highlight.HtmlFormatter"
+      default="true">
+      <lst name="defaults">
+        <str name="hl.simple.pre"><![CDATA[<em>]]></str>
+        <str name="hl.simple.post"><![CDATA[</em>]]></str>
+      </lst>
+    </formatter>
+  </highlighting>
+
+  <!--
+    An example dedup update processor that creates the "id" field on the
+    fly based on the hash code of some other fields. This example has
+    overwriteDupes set to false since we are using the id field as the
+    signatureField and Solr will maintain uniqueness based on that
+    anyway. You have to link the chain to an update handler above to use
+    it ie: <requestHandler name="/update
+    "class="solr.XmlUpdateRequestHandler"> <lst name="defaults"> <str
+    name="update.processor">dedupe</str> </lst> </requestHandler>
+  -->
+
+  <updateRequestProcessorChain name="uima">
+    <processor class="org.apache.solr.uima.processor.UIMAUpdateRequestProcessorFactory"/>
+    <processor class="solr.LogUpdateProcessorFactory" />
+    <processor class="solr.RunUpdateProcessorFactory" />
+  </updateRequestProcessorChain>
+
+
+
+  <!--
+    queryResponseWriter plugins... query responses will be written using
+    the writer specified by the 'wt' request parameter matching the name
+    of a registered writer. The "default" writer is the default and will
+    be used if 'wt' is not specified in the request. XMLResponseWriter
+    will be used if nothing is specified here. The json, python, and
+    ruby writers are also available by default. <queryResponseWriter
+    name="xml" class="org.apache.solr.request.XMLResponseWriter"
+    default="true"/> <queryResponseWriter name="json"
+    class="org.apache.solr.request.JSONResponseWriter"/>
+    <queryResponseWriter name="python"
+    class="org.apache.solr.request.PythonResponseWriter"/>
+    <queryResponseWriter name="ruby"
+    class="org.apache.solr.request.RubyResponseWriter"/>
+    <queryResponseWriter name="php"
+    class="org.apache.solr.request.PHPResponseWriter"/>
+    <queryResponseWriter name="phps"
+    class="org.apache.solr.request.PHPSerializedResponseWriter"/>
+
+    <queryResponseWriter name="custom"
+    class="com.example.MyResponseWriter"/>
+  -->
+
+  <!--
+    XSLT response writer transforms the XML output by any xslt file
+    found in Solr's conf/xslt directory. Changes to xslt files are
+    checked for every xsltCacheLifetimeSeconds.
+  -->
+  <queryResponseWriter name="xslt"
+    class="org.apache.solr.response.XSLTResponseWriter">
+    <int name="xsltCacheLifetimeSeconds">5</int>
+  </queryResponseWriter>
+
+
+  <!--
+    example of registering a query parser <queryParser name="lucene"
+    class="org.apache.solr.search.LuceneQParserPlugin"/>
+  -->
+
+  <!--
+    example of registering a custom function parser <valueSourceParser
+    name="myfunc" class="com.mycompany.MyValueSourceParser" />
+  -->
+
+  <!-- config for the admin interface -->
+  <admin>
+    <defaultQuery>*</defaultQuery>
+
+    <!--
+      configure a healthcheck file for servers behind a loadbalancer
+      <healthcheck type="file">server-enabled</healthcheck>
+    -->
+  </admin>
+
+<uimaConfig>
+   <runtimeParameters>
+      <keyword_apikey>04490000a72fe7ec5cb3497f14e77f338c86f2fe</keyword_apikey>
+      <concept_apikey>04490000a72fe7ec5cb3497f14e77f338c86f2fe</concept_apikey>
+      <lang_apikey>04490000a72fe7ec5cb3497f14e77f338c86f2fe</lang_apikey>
+      <cat_apikey>04490000a72fe7ec5cb3497f14e77f338c86f2fe</cat_apikey>
+      <entities_apikey>04490000a72fe7ec5cb3497f14e77f338c86f2fe</entities_apikey>
+      <oc_licenseID>g6h9zamsdtwhb93nc247ecrs</oc_licenseID>
+  </runtimeParameters>
+  <analysisEngine>/org/apache/uima/desc/OverridingParamsExtServicesAE.xml</analysisEngine>
+  <analyzeFields merge="false">text</analyzeFields>
+  <fieldMapping>
+    <type name="org.apache.uima.alchemy.ts.categorization.Category">
+      <map feature="text" field="suggested_category"/>
+    </type>
+    <type name="org.apache.uima.alchemy.ts.concept.ConceptFS">
+      <map feature="text" field="concept"/>
+    </type>
+    <type name="org.apache.uima.alchemy.ts.entity.BaseEntity">
+      <map feature="text" field="entity"/>
+    </type>
+    <type name="org.apache.uima.calais.BaseType">
+      <map feature="coveredText" field="entity"/>
+    </type>
+    <type name="org.apache.uima.alchemy.ts.keywords.KeywordFS">
+      <map feature="text" field="keyword"/>
+    </type>
+    <type name="org.apache.uima.alchemy.ts.language.LanguageFS">
+      <map feature="language" field="language"/>
+    </type>
+    <type name="org.apache.uima.SentenceAnnotation">
+      <map feature="coveredText" field="sentence"/>
+    </type>
+  </fieldMapping>
+</uimaConfig>
+  
+</config>
diff --git a/solr/contrib/uima/src/test/resources/solr-uima/conf/spellings.txt b/solr/contrib/uima/src/test/resources/solr-uima/conf/spellings.txt
new file mode 100644
index 0000000..162a044
--- /dev/null
+++ b/solr/contrib/uima/src/test/resources/solr-uima/conf/spellings.txt
@@ -0,0 +1,2 @@
+pizza
+history
diff --git a/solr/contrib/uima/src/test/resources/solr-uima/conf/stopwords.txt b/solr/contrib/uima/src/test/resources/solr-uima/conf/stopwords.txt
new file mode 100644
index 0000000..b5824da
--- /dev/null
+++ b/solr/contrib/uima/src/test/resources/solr-uima/conf/stopwords.txt
@@ -0,0 +1,58 @@
+# Licensed to the Apache Software Foundation (ASF) under one or more
+# contributor license agreements.  See the NOTICE file distributed with
+# this work for additional information regarding copyright ownership.
+# The ASF licenses this file to You under the Apache License, Version 2.0
+# (the "License"); you may not use this file except in compliance with
+# the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+#-----------------------------------------------------------------------
+# a couple of test stopwords to test that the words are really being
+# configured from this file:
+stopworda
+stopwordb
+
+#Standard english stop words taken from Lucene's StopAnalyzer
+a
+an
+and
+are
+as
+at
+be
+but
+by
+for
+if
+in
+into
+is
+it
+no
+not
+of
+on
+or
+s
+such
+t
+that
+the
+their
+then
+there
+these
+they
+this
+to
+was
+will
+with
+
diff --git a/solr/contrib/uima/src/test/resources/solr-uima/conf/synonyms.txt b/solr/contrib/uima/src/test/resources/solr-uima/conf/synonyms.txt
new file mode 100644
index 0000000..b0e31cb
--- /dev/null
+++ b/solr/contrib/uima/src/test/resources/solr-uima/conf/synonyms.txt
@@ -0,0 +1,31 @@
+# The ASF licenses this file to You under the Apache License, Version 2.0
+# (the "License"); you may not use this file except in compliance with
+# the License.  You may obtain a copy of the License at
+#
+#     http://www.apache.org/licenses/LICENSE-2.0
+#
+# Unless required by applicable law or agreed to in writing, software
+# distributed under the License is distributed on an "AS IS" BASIS,
+# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+# See the License for the specific language governing permissions and
+# limitations under the License.
+
+#-----------------------------------------------------------------------
+#some test synonym mappings unlikely to appear in real input text
+aaa => aaaa
+bbb => bbbb1 bbbb2
+ccc => cccc1,cccc2
+a\=>a => b\=>b
+a\,a => b\,b
+fooaaa,baraaa,bazaaa
+
+# Some synonym groups specific to this example
+GB,gib,gigabyte,gigabytes
+MB,mib,megabyte,megabytes
+Television, Televisions, TV, TVs
+#notice we use "gib" instead of "GiB" so any WordDelimiterFilter coming
+#after us won't split it into two words.
+
+# Synonym mappings can be used for spelling correction too
+pixima => pixma
+

